(function(){var e={95:function(){},137:function(e,a,t){"use strict";var o=t(751),n=t(641);const l={id:"app"};function i(e,a,t,o,i,s){const r=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.bF)(r)])}var s=t(349),r={name:"App",mounted(){console.log("🎬 Pochtecayotl Signance System - Frontend iniciado"),this.checkBackendConnection(),this.initializeIconFixes()},methods:{async checkBackendConnection(){try{const e=await s.A.detectBackend();console.log(`✅ Conexión con backend establecida en ${e.baseUrl}`)}catch(e){console.error("❌ No se puede conectar con el backend:",e),this.$q.notify({type:"warning",message:"No se puede conectar con el servidor",caption:"Verifica que el backend esté ejecutándose en el rango de puertos 8000-8010"})}},initializeIconFixes(){console.log("🎨 Inicializando correcciones de iconos..."),this.checkMaterialIconsAvailability(),this.applyIconCSS(),this.applyIconSizeCorrections(),setTimeout((()=>{this.verifyIconsAfterLoad()}),2e3)},checkMaterialIconsAvailability(){if(document.fonts){const e=document.fonts.check('1rem "Material Icons"');console.log("🔍 Material Icons disponible:",e),e||(console.log("⚠️ Material Icons no cargado, intentando forzar carga..."),this.forceLoadMaterialIcons())}},forceLoadMaterialIcons(){const e=document.querySelector('link[href*="material-icons"]');if(!e){const e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/icon?family=Material+Icons&display=swap",e.onload=()=>{console.log("✅ Material Icons cargado desde Google Fonts")},document.head.appendChild(e)}},applyIconCSS(){const e="\n        /* Corrección global para Material Icons */\n        .material-icons, .q-icon {\n          font-family: 'Material Icons' !important;\n          font-weight: normal !important;\n          font-style: normal !important;\n          font-size: inherit !important;\n          line-height: 1 !important;\n          letter-spacing: normal !important;\n          text-transform: none !important;\n          display: inline-block !important;\n          white-space: nowrap !important;\n          word-wrap: normal !important;\n          direction: ltr !important;\n          font-feature-settings: 'liga' !important;\n          -webkit-font-feature-settings: 'liga' !important;\n          -webkit-font-smoothing: antialiased !important;\n          -moz-osx-font-smoothing: grayscale !important;\n        }\n      ",a=document.createElement("style");a.textContent=e,document.head.appendChild(a)},applyIconSizeCorrections(){const e="\n        /* Corrección específica para mantener los tamaños de Quasar */\n        .q-icon {\n          font-family: 'Material Icons' !important;\n          /* Mantener tamaños dinámicos de Quasar */\n          font-size: inherit !important;\n          width: auto !important;\n          height: auto !important;\n        }\n        \n        /* Asegurar que las clases de tamaño de Quasar funcionen */\n        .q-icon.text-xs { font-size: 0.75rem !important; }\n        .q-icon.text-sm { font-size: 0.875rem !important; }\n        .q-icon.text-base { font-size: 1rem !important; }\n        .q-icon.text-lg { font-size: 1.125rem !important; }\n        .q-icon.text-xl { font-size: 1.25rem !important; }\n        .q-icon.text-2xl { font-size: 1.5rem !important; }\n        .q-icon.text-3xl { font-size: 1.875rem !important; }\n        .q-icon.text-4xl { font-size: 2.25rem !important; }\n        .q-icon.text-5xl { font-size: 3rem !important; }\n        .q-icon.text-6xl { font-size: 4rem !important; }\n      ",a=document.createElement("style");a.id="icon-size-corrections",a.textContent=e,document.head.appendChild(a)},verifyIconsAfterLoad(){const e=document.querySelectorAll(".q-icon");console.log(`🔍 Verificando ${e.length} elementos de iconos...`),e.forEach(((e,a)=>{const t=window.getComputedStyle(e),o=t.fontFamily;o.includes("Material Icons")||(console.warn(`⚠️ Icono ${a} no usa Material Icons:`,o),e.style.fontFamily='"Material Icons" !important')}))}}},c=t(262);const d=(0,c.A)(r,[["render",i]]);var u=d,m=t(220);const p={class:"login-container"},g={class:"theme-toggle-container"},v={class:"login-content"},h={class:"login-header"},f={class:"logo-container"},k={class:"input-group"},y={class:"input-group"},b={class:"login-actions"};function L(e,a,t,o,l,i){const s=(0,n.g2)("ThemeToggle"),r=(0,n.g2)("q-icon"),c=(0,n.g2)("q-card-section"),d=(0,n.g2)("q-input"),u=(0,n.g2)("q-btn"),m=(0,n.g2)("q-form"),L=(0,n.g2)("q-card"),_=(0,n.g2)("q-card-actions"),C=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",g,[(0,n.bF)(s)]),(0,n.Lk)("div",v,[(0,n.bF)(L,{class:"login-card"},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"text-center login-header-section"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",h,[(0,n.Lk)("div",f,[(0,n.bF)(r,{name:"video_library",class:"main-logo"}),a[5]||(a[5]=(0,n.Lk)("div",{class:"logo-glow"},null,-1))]),a[6]||(a[6]=(0,n.Lk)("h2",{class:"app-title"},"Pochtecayotl",-1)),a[7]||(a[7]=(0,n.Lk)("h3",{class:"app-subtitle-main"},"Signance System",-1)),a[8]||(a[8]=(0,n.Lk)("p",{class:"app-subtitle"},"Sistema de Gestión de Anuncios Digitales",-1)),a[9]||(a[9]=(0,n.Lk)("div",{class:"pride-divider"},null,-1))])])),_:1}),(0,n.bF)(c,{class:"login-form-section"},{default:(0,n.k6)((()=>[(0,n.bF)(m,{onSubmit:o.handleLogin,class:"login-form"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",k,[(0,n.bF)(d,{modelValue:o.credentials.username,"onUpdate:modelValue":a[0]||(a[0]=e=>o.credentials.username=e),label:"Usuario",outlined:"",dense:"",rules:[e=>!!e||"El usuario es requerido"],ref:"usernameRef",class:"modern-input"},{prepend:(0,n.k6)((()=>[(0,n.bF)(r,{name:"person",class:"input-icon"})])),_:1},8,["modelValue","rules"])]),(0,n.Lk)("div",y,[(0,n.bF)(d,{modelValue:o.credentials.password,"onUpdate:modelValue":a[1]||(a[1]=e=>o.credentials.password=e),label:"Contraseña",type:"password",outlined:"",dense:"",rules:[e=>!!e||"La contraseña es requerida"],ref:"passwordRef",class:"modern-input"},{prepend:(0,n.k6)((()=>[(0,n.bF)(r,{name:"lock",class:"input-icon"})])),_:1},8,["modelValue","rules"])]),(0,n.Lk)("div",b,[(0,n.bF)(u,{type:"submit",label:"Iniciar Sesión",class:"login-btn",size:"md",unelevated:"",loading:o.isLoading,disable:!o.credentials.username||!o.credentials.password},null,8,["loading","disable"])])])),_:1},8,["onSubmit"])])),_:1}),(0,n.bF)(c,{class:"text-center footer-section"},{default:(0,n.k6)((()=>[(0,n.bF)(u,{flat:"",label:"Probar Conexión",onClick:o.testBackendConnection,size:"sm",class:"test-btn"},null,8,["onClick"])])),_:1})])),_:1})]),(0,n.bF)(C,{modelValue:o.showSetupDialog,"onUpdate:modelValue":a[4]||(a[4]=e=>o.showSetupDialog=e),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(L,{class:"setup-dialog-card",style:{"min-width":"400px"}},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"setup-header row items-center"},{default:(0,n.k6)((()=>[(0,n.bF)(r,{name:"admin_panel_settings",size:"2rem",color:"orange"}),a[10]||(a[10]=(0,n.Lk)("span",{class:"q-ml-sm text-h6 setup-title"},"Configuración Inicial",-1))])),_:1,__:[10]}),(0,n.bF)(c,{class:"setup-content"},{default:(0,n.k6)((()=>[a[11]||(a[11]=(0,n.Lk)("p",{class:"setup-description"},"El sistema necesita configuración inicial. Crea el usuario administrador:",-1)),(0,n.bF)(m,{onSubmit:o.handleSetupAdmin,class:"q-gutter-md"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{modelValue:o.setupData.username,"onUpdate:modelValue":a[2]||(a[2]=e=>o.setupData.username=e),label:"Usuario Administrador",outlined:"",class:"setup-input",rules:[e=>!!e||"Requerido"]},null,8,["modelValue","rules"]),(0,n.bF)(d,{modelValue:o.setupData.password,"onUpdate:modelValue":a[3]||(a[3]=e=>o.setupData.password=e),label:"Contraseña",type:"password",outlined:"",class:"setup-input",rules:[e=>!!e||"Requerido"]},null,8,["modelValue","rules"])])),_:1},8,["onSubmit"])])),_:1,__:[11]}),(0,n.bF)(_,{align:"right",class:"setup-actions"},{default:(0,n.k6)((()=>[(0,n.bF)(u,{label:"Configurar",color:"primary",class:"setup-btn",onClick:o.handleSetupAdmin,loading:o.isSetupLoading},null,8,["onClick","loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var _=t(953),C=t(840),F=t(246),w=t(889),E=t(725),S=t(697),P={name:"LoginView",components:{ThemeToggle:S.A},setup(){const e=(0,m.rd)(),a=(0,C.Jud)(),t=(0,F.dj)(),{loadTheme:o}=(0,E.D)(),l=(0,_.KR)(!1),i=(0,_.KR)(!1),s=(0,_.KR)(!1),r=(0,_.Kh)({username:"",password:""}),c=(0,_.Kh)({username:"admin",password:""}),d=async()=>{try{const e=await w.R2.checkSetup();e.data.setup_required&&(s.value=!0,t.info("Se requiere configuración inicial del sistema"))}catch(e){console.error("Error verificando setup:",e),t.error("Error conectando con el servidor")}},u=async()=>{if(c.username&&c.password){i.value=!0;try{await w.R2.setupAdmin(c),t.success("Administrador configurado exitosamente"),s.value=!1,r.username=c.username,r.password=c.password,await p()}catch(e){console.error("Error en setup:",e),t.error("Error configurando administrador")}finally{i.value=!1}}else t.warning("Completa todos los campos")},p=async()=>{l.value=!0;try{const a=await w.R2.login(r),{access_token:o}=a.data;localStorage.setItem("signance_token",o),t.success(`¡Bienvenido, ${r.username}!`),e.push("/admin")}catch(a){console.error("Error en login:",a),401===a.response?.status?t.error("Credenciales incorrectas"):t.error("Error iniciando sesión"),r.password=""}finally{l.value=!1}},g=async()=>{a.loading.show({message:"Probando conexión..."});try{const e=await fetch("http://127.0.0.1:8000/health");if(e.ok){const a=await e.json();t.success(`Conexión exitosa: ${a.status}`)}else t.warning("El servidor responde pero con errores")}catch(e){console.error("Error de conexión:",e),t.error("No se puede conectar con el servidor")}finally{a.loading.hide()}},v=()=>{const a=localStorage.getItem("signance_token");a&&e.push("/test-ok")};return(0,n.sV)((()=>{o(),v(),d()})),{credentials:r,setupData:c,isLoading:l,isSetupLoading:i,showSetupDialog:s,handleLogin:p,handleSetupAdmin:u,testBackendConnection:g}}};const M=(0,c.A)(P,[["render",L],["__scopeId","data-v-ff55de2c"]]);var A=M,I=t(33);const $={class:"test-ok-container"},T={class:"signance-container"},x={class:"success-header"},D={class:"success-icon"},q={class:"info-card user-info"},z={class:"card-header"},B={class:"header-text"},R={class:"info-card tests-card"},U={class:"tests-grid"},V={class:"test-icon"},N={class:"test-info"},X={class:"test-action"},W={class:"info-card actions-card"},K={class:"actions-grid"},O={class:"logout-section"},Q={class:"info-card system-info"},j={class:"system-details"},G={class:"detail-item"},H={class:"detail-value"},J={class:"detail-item"},Z={class:"detail-value"},Y={class:"detail-item"},ee={class:"detail-value"},ae={class:"detail-item"},te={class:"detail-value"};function oe(e,a,t,o,l,i){const s=(0,n.g2)("ThemeToggle"),r=(0,n.g2)("q-icon"),c=(0,n.g2)("q-btn"),d=(0,n.g2)("q-chip");return(0,n.uX)(),(0,n.CE)("div",$,[(0,n.bF)(s,{class:"theme-toggle"}),(0,n.Lk)("div",T,[(0,n.Lk)("div",x,[(0,n.Lk)("div",D,[(0,n.bF)(r,{name:"check_circle",size:"4rem"})]),a[4]||(a[4]=(0,n.Lk)("h2",null,"¡Sistema Funcionando Correctamente!",-1)),a[5]||(a[5]=(0,n.Lk)("p",null,"Pochtecayotl Signance System - Autenticación Exitosa",-1))]),(0,n.Lk)("div",q,[(0,n.Lk)("div",z,[(0,n.bF)(r,{name:"person",size:"2rem"}),(0,n.Lk)("div",B,[a[6]||(a[6]=(0,n.Lk)("h3",null,"Usuario Autenticado",-1)),(0,n.Lk)("p",null,(0,I.v_)(o.userInfo.username||"Cargando..."),1)])])]),(0,n.Lk)("div",R,[a[7]||(a[7]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Pruebas del Sistema")],-1)),(0,n.Lk)("div",U,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.systemTests,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.name,class:(0,I.C4)(["test-item",{"test-success":"success"===e.status,"test-error":"error"===e.status,"test-testing":"testing"===e.status}])},[(0,n.Lk)("div",V,[(0,n.bF)(r,{name:"success"===e.status?"check_circle":"error"===e.status?"error":"hourglass_empty",size:"1.5rem"},null,8,["name"])]),(0,n.Lk)("div",N,[(0,n.Lk)("h4",null,(0,I.v_)(e.name),1),(0,n.Lk)("p",null,(0,I.v_)(e.description),1)]),(0,n.Lk)("div",X,[(0,n.bF)(c,{flat:"",round:"",icon:"testing"===e.status?"refresh":"play_arrow",onClick:a=>o.runTest(e),loading:"testing"===e.status,size:"sm",color:"success"===e.status?"positive":"primary"},null,8,["icon","onClick","loading","color"])])],2)))),128))])]),(0,n.Lk)("div",W,[a[12]||(a[12]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Acciones Disponibles")],-1)),(0,n.Lk)("div",K,[(0,n.Lk)("div",{class:"action-button primary-action",onClick:a[0]||(a[0]=(...e)=>o.goToDashboard&&o.goToDashboard(...e))},[(0,n.bF)(r,{name:"dashboard",size:"2rem"}),a[8]||(a[8]=(0,n.Lk)("span",null,"Dashboard",-1))]),(0,n.Lk)("div",{class:"action-button secondary-action",onClick:a[1]||(a[1]=(...e)=>o.goToMediaManager&&o.goToMediaManager(...e))},[(0,n.bF)(r,{name:"cloud_upload",size:"2rem"}),a[9]||(a[9]=(0,n.Lk)("span",null,"Gestión de Media",-1))]),(0,n.Lk)("div",{class:"action-button accent-action",onClick:a[2]||(a[2]=(...e)=>o.goToConfig&&o.goToConfig(...e))},[(0,n.bF)(r,{name:"settings",size:"2rem"}),a[10]||(a[10]=(0,n.Lk)("span",null,"Configuración",-1))]),(0,n.Lk)("div",{class:"action-button warning-action",onClick:a[3]||(a[3]=(...e)=>o.goToErrorPage&&o.goToErrorPage(...e))},[(0,n.bF)(r,{name:"bug_report",size:"2rem"}),a[11]||(a[11]=(0,n.Lk)("span",null,"Ver Página de Error",-1))])]),(0,n.Lk)("div",O,[(0,n.bF)(c,{color:"negative",icon:"logout",label:"Cerrar Sesión",onClick:o.logout,outline:"",rounded:"",size:"md"},null,8,["onClick"])])]),(0,n.Lk)("div",Q,[a[17]||(a[17]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Información del Sistema")],-1)),(0,n.Lk)("div",j,[(0,n.Lk)("div",G,[a[13]||(a[13]=(0,n.Lk)("span",{class:"detail-label"},"Estado del Backend",-1)),(0,n.Lk)("div",H,[(0,n.bF)(d,{color:o.backendStatus.connected?"positive":"negative","text-color":"white",icon:o.backendStatus.connected?"check":"close",size:"sm"},{default:(0,n.k6)((()=>[(0,n.eW)((0,I.v_)(o.backendStatus.connected?"Conectado":"Desconectado"),1)])),_:1},8,["color","icon"])])]),(0,n.Lk)("div",J,[a[14]||(a[14]=(0,n.Lk)("span",{class:"detail-label"},"URL del Backend",-1)),(0,n.Lk)("span",Z,(0,I.v_)(o.backendStatus.url),1)]),(0,n.Lk)("div",Y,[a[15]||(a[15]=(0,n.Lk)("span",{class:"detail-label"},"Fecha de Acceso",-1)),(0,n.Lk)("span",ee,(0,I.v_)((new Date).toLocaleString("es-ES")),1)]),(0,n.Lk)("div",ae,[a[16]||(a[16]=(0,n.Lk)("span",{class:"detail-label"},"Token JWT",-1)),(0,n.Lk)("div",te,[(0,n.bF)(d,{color:"info","text-color":"white",size:"sm"},{default:(0,n.k6)((()=>[(0,n.eW)((0,I.v_)(o.tokenInfo),1)])),_:1})])])])])])])}var ne={name:"Ok_TestView",components:{ThemeToggle:S.A},setup(){const e=(0,m.rd)(),a=(0,F.dj)(),{isDarkMode:t}=(0,E.D)(),o=(0,_.KR)({}),l=(0,_.Kh)({connected:!1,lastCheck:null,url:"Detectando...",port:null}),i=(0,n.EW)((()=>{const e=localStorage.getItem("signance_token");return e?`${e.substring(0,20)}...`:"No disponible"})),r=(0,_.KR)([{name:"Autenticación",description:"Verificar ruta protegida",status:"pending",test:()=>w.R2.testProtected()},{name:"Gestión de Media",description:"Listar archivos multimedia",status:"pending",test:()=>w.DX.list(0,5)},{name:"Información de Negocio",description:"Obtener configuración empresarial",status:"pending",test:()=>w.ZK.get()},{name:"Programación",description:"Listar horarios programados",status:"pending",test:()=>w.gr.list(0,5)}]),c=async e=>{e.status="testing";try{const t=await e.test();e.status="success",e.result=t.data,a.success(`✅ ${e.name}: Prueba exitosa`)}catch(t){e.status="error",e.error=t.message,a.error(`❌ ${e.name}: ${t.message}`)}},d=async()=>{for(const e of r.value)await c(e),await new Promise((e=>setTimeout(e,500)))},u=async()=>{try{const e=await w.R2.getCurrentUser();o.value=e.data}catch(e){console.error("Error obteniendo información del usuario:",e),a.error("Error obteniendo información del usuario")}},p=async()=>{try{console.log("🔍 Verificando estado del backend...");const e=s.A.getCachedBackend();if(e){console.log("📦 Usando información cached del backend:",e),l.url=e.baseUrl,l.port=e.port;const a=await s.A.testPort(e.port);if(l.connected=a,l.lastCheck=new Date,a)return void console.log("✅ Backend confirmado desde caché");console.log("❌ Backend cached no responde, detectando nuevamente...")}const a=await s.A.detectBackend();l.connected=!0,l.url=a.baseUrl,l.port=a.port,l.lastCheck=new Date,console.log("✅ Backend detectado exitosamente:",a)}catch(e){console.error("❌ Error detectando backend:",e),l.connected=!1,l.url="No disponible",l.port=null,l.lastCheck=new Date}},g=()=>{e.push("/admin")},v=()=>{e.push("/media")},h=()=>{e.push("/config")},f=()=>{e.push("/error")},k=async()=>{try{await w.R2.logout()}catch(t){console.error("Error en logout:",t)}finally{localStorage.removeItem("signance_token"),a.success("Sesión cerrada exitosamente"),e.push("/login")}};return(0,n.sV)((()=>{u(),p(),setTimeout(d,2e3)})),{userInfo:o,backendStatus:l,tokenInfo:i,systemTests:r,runTest:c,runAllTests:d,goToDashboard:g,goToMediaManager:v,goToConfig:h,goToErrorPage:f,logout:k,isDarkMode:t}}};const le=(0,c.A)(ne,[["render",oe],["__scopeId","data-v-0aaf4706"]]);var ie=le;const se={class:"error-container"},re={class:"signance-container"},ce={class:"error-header"},de={class:"error-icon"},ue={class:"info-card error-info"},me={class:"card-header"},pe={class:"error-details"},ge={class:"error-badge"},ve={class:"detail-item"},he={class:"detail-value"},fe={class:"detail-item"},ke={class:"detail-value"},ye={class:"detail-item"},be={class:"detail-value"},Le={class:"info-card diagnostic-card"},_e={class:"diagnostic-grid"},Ce={class:"diagnostic-icon"},Fe={class:"diagnostic-info"},we={key:0,class:"diagnostic-details"},Ee={class:"diagnostic-action"},Se={class:"info-card solutions-card"},Pe={class:"solutions-timeline"},Me={class:"solution-step"},Ae={class:"step-content"},Ie={class:"solution-step"},$e={class:"step-content"},Te={class:"solution-step"},xe={class:"step-content"},De={class:"solution-step"},qe={class:"step-content"},ze={class:"info-card navigation-card"},Be={class:"navigation-actions"},Re={class:"technical-section"},Ue={class:"technical-content"},Ve={class:"technical-info"};function Ne(e,a,t,o,l,i){const s=(0,n.g2)("ThemeToggle"),r=(0,n.g2)("q-icon"),c=(0,n.g2)("q-chip"),d=(0,n.g2)("q-btn"),u=(0,n.g2)("q-expansion-item");return(0,n.uX)(),(0,n.CE)("div",se,[(0,n.bF)(s,{class:"theme-toggle"}),(0,n.Lk)("div",re,[(0,n.Lk)("div",ce,[(0,n.Lk)("div",de,[(0,n.bF)(r,{name:"error",size:"5rem"})]),a[3]||(a[3]=(0,n.Lk)("h2",null,"¡Oops! Algo salió mal",-1)),a[4]||(a[4]=(0,n.Lk)("p",null,"Pochtecayotl Signance System - Página de Error",-1))]),(0,n.Lk)("div",ue,[(0,n.Lk)("div",me,[(0,n.bF)(r,{name:"bug_report",size:"2rem"}),a[5]||(a[5]=(0,n.Lk)("div",{class:"header-text"},[(0,n.Lk)("h3",null,"Error del Sistema"),(0,n.Lk)("p",null,"Detalles técnicos del problema")],-1))]),(0,n.Lk)("div",pe,[(0,n.Lk)("div",ge,[(0,n.bF)(c,{color:"negative","text-color":"white",icon:"error"},{default:(0,n.k6)((()=>[(0,n.eW)(" Código: "+(0,I.v_)(o.errorCode),1)])),_:1})]),(0,n.Lk)("div",ve,[a[6]||(a[6]=(0,n.Lk)("span",{class:"detail-label"},"Mensaje:",-1)),(0,n.Lk)("span",he,(0,I.v_)(o.errorMessage),1)]),(0,n.Lk)("div",fe,[a[7]||(a[7]=(0,n.Lk)("span",{class:"detail-label"},"Timestamp:",-1)),(0,n.Lk)("span",ke,(0,I.v_)((new Date).toLocaleString("es-ES")),1)]),(0,n.Lk)("div",ye,[a[8]||(a[8]=(0,n.Lk)("span",{class:"detail-label"},"URL:",-1)),(0,n.Lk)("span",be,(0,I.v_)(o.currentUrl),1)])])]),(0,n.Lk)("div",Le,[a[9]||(a[9]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Diagnóstico del Sistema")],-1)),(0,n.Lk)("div",_e,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.diagnosticChecks,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.name,class:(0,I.C4)(["diagnostic-item",{"diagnostic-ok":"ok"===e.status,"diagnostic-error":"error"===e.status,"diagnostic-checking":e.checking}])},[(0,n.Lk)("div",Ce,[(0,n.bF)(r,{name:"ok"===e.status?"check_circle":"error"===e.status?"error":"help",size:"1.5rem"},null,8,["name"])]),(0,n.Lk)("div",Fe,[(0,n.Lk)("h4",null,(0,I.v_)(e.name),1),(0,n.Lk)("p",null,(0,I.v_)(e.description),1),e.details?((0,n.uX)(),(0,n.CE)("p",we,(0,I.v_)(e.details),1)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",Ee,[(0,n.bF)(d,{flat:"",round:"",icon:"refresh",onClick:a=>o.runDiagnostic(e),loading:e.checking,size:"sm",color:"primary"},null,8,["onClick","loading"])])],2)))),128))])]),(0,n.Lk)("div",Se,[a[22]||(a[22]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Posibles Soluciones")],-1)),(0,n.Lk)("div",Pe,[(0,n.Lk)("div",Me,[a[12]||(a[12]=(0,n.Lk)("div",{class:"step-number"},"1",-1)),(0,n.Lk)("div",Ae,[a[10]||(a[10]=(0,n.Lk)("h4",null,"Verificar Conexión",-1)),a[11]||(a[11]=(0,n.Lk)("p",null,[(0,n.eW)("Verifica que el servidor backend esté ejecutándose en "),(0,n.Lk)("code",null,"http://127.0.0.1:8002")],-1)),(0,n.bF)(d,{flat:"",color:"primary",label:"Probar Conexión",onClick:o.testConnection,size:"sm",icon:"wifi",rounded:""},null,8,["onClick"])])]),(0,n.Lk)("div",Ie,[a[15]||(a[15]=(0,n.Lk)("div",{class:"step-number"},"2",-1)),(0,n.Lk)("div",$e,[a[13]||(a[13]=(0,n.Lk)("h4",null,"Revisar Autenticación",-1)),a[14]||(a[14]=(0,n.Lk)("p",null,"Verifica que tu sesión no haya expirado",-1)),(0,n.bF)(d,{flat:"",color:"primary",label:"Ir a Login",onClick:o.goToLogin,size:"sm",icon:"key",rounded:""},null,8,["onClick"])])]),(0,n.Lk)("div",Te,[a[18]||(a[18]=(0,n.Lk)("div",{class:"step-number"},"3",-1)),(0,n.Lk)("div",xe,[a[16]||(a[16]=(0,n.Lk)("h4",null,"Recargar Página",-1)),a[17]||(a[17]=(0,n.Lk)("p",null,"A veces un simple recargo puede solucionar el problema",-1)),(0,n.bF)(d,{flat:"",color:"primary",label:"Recargar",onClick:o.reloadPage,size:"sm",icon:"refresh",rounded:""},null,8,["onClick"])])]),(0,n.Lk)("div",De,[a[21]||(a[21]=(0,n.Lk)("div",{class:"step-number"},"4",-1)),(0,n.Lk)("div",qe,[a[19]||(a[19]=(0,n.Lk)("h4",null,"Contactar Soporte",-1)),a[20]||(a[20]=(0,n.Lk)("p",null,"Si el problema persiste, contacta al equipo de soporte",-1)),(0,n.bF)(d,{flat:"",color:"primary",label:"Reportar Error",onClick:o.reportError,size:"sm",icon:"support",rounded:""},null,8,["onClick"])])])])]),(0,n.Lk)("div",ze,[a[26]||(a[26]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Navegación")],-1)),(0,n.Lk)("div",Be,[(0,n.Lk)("div",{class:"nav-button primary-nav",onClick:a[0]||(a[0]=(...e)=>o.goToHome&&o.goToHome(...e))},[(0,n.bF)(r,{name:"home",size:"2rem"}),a[23]||(a[23]=(0,n.Lk)("span",null,"Ir al Inicio",-1))]),(0,n.Lk)("div",{class:"nav-button secondary-nav",onClick:a[1]||(a[1]=(...e)=>o.goToLogin&&o.goToLogin(...e))},[(0,n.bF)(r,{name:"login",size:"2rem"}),a[24]||(a[24]=(0,n.Lk)("span",null,"Iniciar Sesión",-1))]),(0,n.Lk)("div",{class:"nav-button success-nav",onClick:a[2]||(a[2]=(...e)=>o.goToTestPage&&o.goToTestPage(...e))},[(0,n.bF)(r,{name:"check",size:"2rem"}),a[25]||(a[25]=(0,n.Lk)("span",null,"Página de Prueba",-1))])])]),(0,n.Lk)("div",Re,[(0,n.bF)(u,{icon:"code",label:"Información Técnica",caption:"Detalles para desarrolladores",class:"technical-expansion"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",Ue,[(0,n.Lk)("pre",Ve,(0,I.v_)(o.technicalInfo),1)])])),_:1})])])])}var Xe={name:"Error_View",components:{ThemeToggle:S.A},setup(){const e=(0,m.rd)(),a=(0,m.lq)(),t=(0,C.Jud)(),o=(0,F.dj)(),{isDarkMode:l}=(0,E.D)(),i=(0,_.KR)(a.query.code||"500"),s=(0,_.KR)(a.query.message||"Error interno del sistema"),r=(0,_.KR)(window.location.href),c=(0,_.KR)([{name:"Conexión Backend",description:"Verificar si el servidor está disponible",status:"unknown",checking:!1,test:async()=>{const e=await fetch("http://127.0.0.1:8002/health");return e.ok}},{name:"Token de Autenticación",description:"Verificar validez del token JWT",status:"unknown",checking:!1,test:()=>{const e=localStorage.getItem("signance_token");return!!e}},{name:"Almacenamiento Local",description:"Verificar disponibilidad de localStorage",status:"unknown",checking:!1,test:()=>{try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch{return!1}}},{name:"Conectividad de Red",description:"Verificar conexión a internet",status:"unknown",checking:!1,test:()=>navigator.onLine}]),d=(0,n.EW)((()=>JSON.stringify({errorCode:i.value,errorMessage:s.value,url:r.value,userAgent:navigator.userAgent,timestamp:(new Date).toISOString(),localStorage:{hasToken:!!localStorage.getItem("signance_token"),tokenLength:localStorage.getItem("signance_token")?.length||0},route:{path:a.path,query:a.query,params:a.params}},null,2))),u=async e=>{e.checking=!0;try{const a=await e.test();e.status=a?"ok":"error",e.details=a?"Funcionando correctamente":"Problema detectado"}catch(a){e.status="error",e.details=`Error: ${a.message}`}finally{e.checking=!1}},p=async()=>{for(const e of c.value)await u(e),await new Promise((e=>setTimeout(e,300)))},g=async()=>{t.loading.show({message:"Probando conexión..."});try{const e=await fetch("http://127.0.0.1:8002/health");e.ok?o.success("✅ Conexión exitosa con el backend"):o.warning("⚠️ El servidor responde pero con errores")}catch(e){o.error("❌ No se puede conectar con el servidor")}finally{t.loading.hide()}},v=()=>{e.push("/")},h=()=>{e.push("/login")},f=()=>{e.push("/test-ok")},k=()=>{window.location.reload()},y=()=>{o.info("Función de reporte de errores en desarrollo"),console.log("Error Report:",d.value)};return(0,n.sV)((()=>{setTimeout(p,1e3)})),{errorCode:i,errorMessage:s,currentUrl:r,diagnosticChecks:c,technicalInfo:d,runDiagnostic:u,runAllDiagnostics:p,testConnection:g,goToHome:v,goToLogin:h,goToTestPage:f,reloadPage:k,reportError:y,isDarkMode:l}}};const We=(0,c.A)(Xe,[["render",Ne],["__scopeId","data-v-2aecc947"]]);var Ke=We;const Oe={class:"selection-container"},Qe={class:"selection-card"},je={class:"card-header"},Ge={class:"logo-section"},He={class:"options-section"},Je={class:"option-icon"},Ze={class:"option-icon"};function Ye(e,a,t,o,l,i){const s=(0,n.g2)("ThemeToggle"),r=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.CE)("div",Oe,[(0,n.bF)(s,{class:"theme-toggle"}),(0,n.Lk)("div",Qe,[(0,n.Lk)("div",je,[(0,n.Lk)("div",Ge,[(0,n.bF)(r,{name:"campaign",size:"4rem",class:"ads-icon"}),a[2]||(a[2]=(0,n.Lk)("h2",{class:"welcome-title"},"Bienvenido",-1)),a[3]||(a[3]=(0,n.Lk)("h3",{class:"system-title"},"Pochtecayotl Signance System",-1))]),a[4]||(a[4]=(0,n.Lk)("p",{class:"subtitle"},"Seleccione una opción para continuar",-1))]),(0,n.Lk)("div",He,[(0,n.Lk)("div",{class:"option-card player-option",onClick:a[0]||(a[0]=(...e)=>o.goPlayer&&o.goPlayer(...e))},[(0,n.Lk)("div",Je,[(0,n.bF)(r,{name:"play_circle_filled",size:"3rem"})]),a[5]||(a[5]=(0,n.Lk)("div",{class:"option-content"},[(0,n.Lk)("h4",null,"Reproductor"),(0,n.Lk)("p",null,"Acceder al reproductor de contenido multimedia")],-1)),(0,n.bF)(r,{name:"arrow_forward",size:"1.5rem",class:"arrow-icon"})]),(0,n.Lk)("div",{class:"option-card admin-option",onClick:a[1]||(a[1]=(...e)=>o.goAdmin&&o.goAdmin(...e))},[(0,n.Lk)("div",Ze,[(0,n.bF)(r,{name:"dashboard",size:"3rem"})]),a[6]||(a[6]=(0,n.Lk)("div",{class:"option-content"},[(0,n.Lk)("h4",null,"Admin Dashboard"),(0,n.Lk)("p",null,"Gestionar contenido y configuración del sistema")],-1)),(0,n.bF)(r,{name:"arrow_forward",size:"1.5rem",class:"arrow-icon"})])]),a[7]||(a[7]=(0,n.Lk)("div",{class:"footer-section"},[(0,n.Lk)("p",{class:"footer-text"},"Sistema diseñado por un gei 🏳️‍🌈")],-1))])])}var ea={name:"SelectionView",components:{ThemeToggle:S.A},setup(){const e=(0,m.rd)(),{isDarkMode:a}=(0,E.D)(),t=()=>e.push("/player"),o=()=>e.push("/admin");return{goPlayer:t,goAdmin:o,isDarkMode:a}}};const aa=(0,c.A)(ea,[["render",Ye],["__scopeId","data-v-8e67c9e0"]]);var ta=aa,oa=t(642),na=t(600);const la={class:"admin-dashboard-container"},ia={class:"signance-container"},sa={class:"dashboard-header"},ra={class:"header-icon"},ca={class:"info-card upload-card"},da={class:"card-header"},ua={class:"upload-content"},ma={class:"text-h6"},pa={class:"row q-gutter-md"},ga={class:"col-5"},va={class:"col-6"};function ha(e,a,t,o,l,i){const s=(0,n.g2)("ThemeToggle"),r=(0,n.g2)("q-icon"),c=(0,n.g2)("StatisticsCard"),d=(0,n.g2)("PlaylistManagement"),u=(0,n.g2)("MediaUploader"),m=(0,n.g2)("MediaGallery"),p=(0,n.g2)("QuickActions"),g=(0,n.g2)("PlaylistDialog"),v=(0,n.g2)("EditMediaDialog"),h=(0,n.g2)("ScheduleDialog"),f=(0,n.g2)("q-card-section"),k=(0,n.g2)("q-item-section"),y=(0,n.g2)("q-item-label"),b=(0,n.g2)("q-btn"),L=(0,n.g2)("q-item"),_=(0,n.g2)("q-list"),C=(0,n.g2)("draggable"),F=(0,n.g2)("q-card-actions"),w=(0,n.g2)("q-card"),E=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.CE)("div",la,[(0,n.bF)(s,{class:"theme-toggle"}),(0,n.Lk)("div",ia,[(0,n.Lk)("div",sa,[(0,n.Lk)("div",ra,[(0,n.bF)(r,{name:"dashboard",size:"4rem"})]),a[5]||(a[5]=(0,n.Lk)("h2",null,"Dashboard Administrativo",-1)),a[6]||(a[6]=(0,n.Lk)("p",null,"Pochtecayotl Signance System - Panel de Control",-1))]),(0,n.bF)(c,{stats:o.stats,"business-info":o.businessInfo},null,8,["stats","business-info"]),(0,n.bF)(d,{playlists:o.playlists,onCreate:o.showCreatePlaylistDialog,onEdit:o.editPlaylist,onManage:o.managePlaylistMedia,onSchedule:o.schedulePlaylist,onDelete:o.deletePlaylist},null,8,["playlists","onCreate","onEdit","onManage","onSchedule","onDelete"]),(0,n.Lk)("div",ca,[(0,n.Lk)("div",da,[(0,n.bF)(r,{name:"cloud_upload",size:"2rem"}),a[7]||(a[7]=(0,n.Lk)("div",{class:"header-text"},[(0,n.Lk)("h3",null,"Subir Multimedia"),(0,n.Lk)("p",null,"Agregar nuevos archivos al sistema")],-1))]),(0,n.Lk)("div",ua,[(0,n.bF)(u,{onUploaded:o.onMediaUploaded,onError:o.onMediaUploadError},null,8,["onUploaded","onError"])])]),(0,n.bF)(m,{"media-files":o.mediaFiles,"backend-base-url":o.backendBaseUrl,loading:o.mediaLoading,mode:"compact",title:"Archivos Multimedia",subtitle:"Archivos recientes","max-items":8,onRefresh:o.loadMedia,onEdit:o.editMedia,onDelete:o.deleteMedia,onShowAll:e.navigateToMediaManager,class:"section-spacing"},null,8,["media-files","backend-base-url","loading","onRefresh","onEdit","onDelete","onShowAll"]),(0,n.bF)(p,{onLogout:o.logout,class:"section-spacing"},null,8,["onLogout"])]),(0,n.bF)(g,{modelValue:o.playlistDialog,"onUpdate:modelValue":a[0]||(a[0]=e=>o.playlistDialog=e),playlist:o.editingPlaylist,form:o.playlistForm,loading:o.savingPlaylist,"is-dark":o.isDarkMode,onSave:o.savePlaylist,onClose:o.closePlaylistDialog},null,8,["modelValue","playlist","form","loading","is-dark","onSave","onClose"]),(0,n.bF)(v,{modelValue:o.editMediaDialog,"onUpdate:modelValue":a[1]||(a[1]=e=>o.editMediaDialog=e),media:o.editingMedia,form:o.editMediaForm,loading:o.savingMedia,"is-dark":o.isDarkMode,onSave:o.saveMediaChanges,onClose:o.closeEditMediaDialog},null,8,["modelValue","media","form","loading","is-dark","onSave","onClose"]),(0,n.bF)(h,{modelValue:o.scheduleDialog,"onUpdate:modelValue":a[2]||(a[2]=e=>o.scheduleDialog=e),form:o.scheduleForm,loading:o.savingSchedule,"weekday-options":o.weekdayOptions,"is-dark":o.isDarkMode,onSave:o.saveSchedule,onClose:o.closeScheduleDialog},null,8,["modelValue","form","loading","weekday-options","is-dark","onSave","onClose"]),(0,n.bF)(E,{modelValue:o.playlistMediaDialog,"onUpdate:modelValue":a[4]||(a[4]=e=>o.playlistMediaDialog=e),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(w,{style:{"min-width":"700px","max-width":"900px"},class:(0,I.C4)({"bg-dark text-white":o.isDarkMode})},{default:(0,n.k6)((()=>[(0,n.bF)(f,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",ma," Gestionar Medios - "+(0,I.v_)(o.selectedPlaylist?.name),1)])),_:1}),(0,n.bF)(f,{class:"q-pt-none"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",pa,[(0,n.Lk)("div",ga,[a[9]||(a[9]=(0,n.Lk)("div",{class:"text-subtitle2 q-mb-md"},"Medios Disponibles",-1)),(0,n.bF)(_,{bordered:"",class:(0,I.C4)(["available-media-list",{"bg-grey-9":o.isDarkMode}])},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.availableMedia,(e=>((0,n.uX)(),(0,n.Wv)(L,{key:e.id,clickable:"",onClick:a=>o.addMediaToPlaylist(e)},{default:(0,n.k6)((()=>[(0,n.bF)(k,{avatar:""},{default:(0,n.k6)((()=>[(0,n.bF)(r,{name:o.getMediaIcon(e.media_type||e.file_type)},null,8,["name"])])),_:2},1024),(0,n.bF)(k,null,{default:(0,n.k6)((()=>[(0,n.bF)(y,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,I.v_)(e.filename),1)])),_:2},1024),(0,n.bF)(y,{caption:""},{default:(0,n.k6)((()=>[(0,n.eW)((0,I.v_)(e.media_type||e.file_type),1)])),_:2},1024)])),_:2},1024),(0,n.bF)(k,{side:""},{default:(0,n.k6)((()=>[(0,n.bF)(b,{flat:"",round:"",icon:"add",size:"sm"})])),_:1})])),_:2},1032,["onClick"])))),128)),0===o.availableMedia.length?((0,n.uX)(),(0,n.Wv)(L,{key:0},{default:(0,n.k6)((()=>[(0,n.bF)(k,null,{default:(0,n.k6)((()=>[(0,n.bF)(y,{class:"text-center text-grey"},{default:(0,n.k6)((()=>a[8]||(a[8]=[(0,n.eW)("No hay medios disponibles")]))),_:1,__:[8]})])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["class"])]),(0,n.Lk)("div",va,[a[11]||(a[11]=(0,n.Lk)("div",{class:"text-subtitle2 q-mb-md"},"Medios en Playlist",-1)),(0,n.bF)(_,{bordered:"",class:(0,I.C4)(["playlist-media-list",{"bg-grey-9":o.isDarkMode}])},{default:(0,n.k6)((()=>[(0,n.bF)(C,{modelValue:o.playlistMedias,"onUpdate:modelValue":a[3]||(a[3]=e=>o.playlistMedias=e),onEnd:o.reorderPlaylistMedia,"item-key":"id"},{item:(0,n.k6)((({element:e,index:a})=>[(0,n.bF)(L,null,{default:(0,n.k6)((()=>[(0,n.bF)(k,{avatar:""},{default:(0,n.k6)((()=>[(0,n.bF)(r,{name:"drag_handle"})])),_:1}),(0,n.bF)(k,{avatar:""},{default:(0,n.k6)((()=>[(0,n.bF)(r,{name:o.getMediaIcon(e.media_type||e.file_type)},null,8,["name"])])),_:2},1024),(0,n.bF)(k,null,{default:(0,n.k6)((()=>[(0,n.bF)(y,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,I.v_)(e.filename),1)])),_:2},1024),(0,n.bF)(y,{caption:""},{default:(0,n.k6)((()=>[(0,n.eW)((0,I.v_)(e.media_type||e.file_type)+" - Orden: "+(0,I.v_)(a+1),1)])),_:2},1024)])),_:2},1024),(0,n.bF)(k,{side:""},{default:(0,n.k6)((()=>[(0,n.bF)(b,{flat:"",round:"",icon:"remove",size:"sm",onClick:a=>o.removeMediaFromPlaylist(e.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue","onEnd"]),0===o.playlistMedias.length?((0,n.uX)(),(0,n.Wv)(L,{key:0},{default:(0,n.k6)((()=>[(0,n.bF)(k,null,{default:(0,n.k6)((()=>[(0,n.bF)(y,{class:"text-center text-grey"},{default:(0,n.k6)((()=>a[10]||(a[10]=[(0,n.eW)("No hay medios en esta playlist")]))),_:1,__:[10]})])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["class"])])])])),_:1}),(0,n.bF)(F,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(b,{flat:"",label:"Cerrar",onClick:o.closePlaylistMediaDialog},null,8,["onClick"])])),_:1})])),_:1},8,["class"])])),_:1},8,["modelValue"])])}var fa=t(661);const ka={class:"info-card stats-card"},ya={class:"stats-grid"},ba={class:"stat-item media-stat"},La={class:"stat-icon"},_a={class:"stat-info"},Ca={class:"stat-item playlist-stat"},Fa={class:"stat-icon"},wa={class:"stat-info"},Ea={class:"stat-item schedule-stat"},Sa={class:"stat-icon"},Pa={class:"stat-info"},Ma={class:"stat-item business-stat"},Aa={class:"stat-icon"},Ia={class:"stat-info"};var $a={__name:"StatisticsCard",props:{stats:Object,businessInfo:Object},setup(e){return(a,t)=>{const o=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.CE)("div",ka,[t[4]||(t[4]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Estadísticas del Sistema")],-1)),(0,n.Lk)("div",ya,[(0,n.Lk)("div",ba,[(0,n.Lk)("div",La,[(0,n.bF)(o,{name:"video_library",size:"2rem"})]),(0,n.Lk)("div",_a,[(0,n.Lk)("h4",null,(0,I.v_)(e.stats.totalMedia),1),t[0]||(t[0]=(0,n.Lk)("p",null,"Archivos Multimedia",-1))])]),(0,n.Lk)("div",Ca,[(0,n.Lk)("div",Fa,[(0,n.bF)(o,{name:"playlist_play",size:"2rem"})]),(0,n.Lk)("div",wa,[(0,n.Lk)("h4",null,(0,I.v_)(e.stats.totalPlaylists),1),t[1]||(t[1]=(0,n.Lk)("p",null,"Playlists Creadas",-1))])]),(0,n.Lk)("div",Ea,[(0,n.Lk)("div",Sa,[(0,n.bF)(o,{name:"schedule",size:"2rem"})]),(0,n.Lk)("div",Pa,[(0,n.Lk)("h4",null,(0,I.v_)(e.stats.totalScheduledItems),1),t[2]||(t[2]=(0,n.Lk)("p",null,"Elementos Programados",-1))])]),(0,n.Lk)("div",Ma,[(0,n.Lk)("div",Aa,[(0,n.bF)(o,{name:"business",size:"2rem"})]),(0,n.Lk)("div",Ia,[(0,n.Lk)("h4",null,(0,I.v_)(e.businessInfo.name||"N/A"),1),t[3]||(t[3]=(0,n.Lk)("p",null,"Negocio Configurado",-1))])])])])}}};const Ta=(0,c.A)($a,[["__scopeId","data-v-ed43a590"]]);var xa=Ta;const Da={class:"info-card playlists-card"},qa={class:"card-header"},za={class:"playlists-content"},Ba={key:0,class:"empty-state"},Ra={key:1,class:"playlists-grid"},Ua={class:"playlist-icon"},Va={class:"playlist-info"},Na={class:"playlist-meta"},Xa={class:"playlist-date"},Wa={class:"playlist-actions"};var Ka={__name:"PlaylistManagement",props:{playlists:Array},setup(e){const a=e=>e?new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"Fecha no disponible";return(t,o)=>{const l=(0,n.g2)("q-icon"),i=(0,n.g2)("q-btn"),s=(0,n.g2)("q-chip");return(0,n.uX)(),(0,n.CE)("div",Da,[(0,n.Lk)("div",qa,[(0,n.bF)(l,{name:"playlist_play",size:"2rem"}),o[2]||(o[2]=(0,n.Lk)("div",{class:"header-text"},[(0,n.Lk)("h3",null,"Gestión de Playlists"),(0,n.Lk)("p",null,"Crear y administrar listas de reproducción")],-1)),(0,n.bF)(i,{color:"primary",icon:"add",label:"Nueva Playlist",onClick:o[0]||(o[0]=e=>t.$emit("create")),rounded:"","no-caps":""})]),(0,n.Lk)("div",za,[0===e.playlists.length?((0,n.uX)(),(0,n.CE)("div",Ba,[(0,n.bF)(l,{name:"playlist_add",size:"3rem"}),o[3]||(o[3]=(0,n.Lk)("p",null,"No hay playlists creadas",-1)),(0,n.bF)(i,{flat:"",color:"primary",label:"Crear primera playlist",onClick:o[1]||(o[1]=e=>t.$emit("create"))})])):((0,n.uX)(),(0,n.CE)("div",Ra,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.playlists,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"playlist-item"},[(0,n.Lk)("div",Ua,[(0,n.bF)(l,{name:"queue_music",size:"1.5rem"})]),(0,n.Lk)("div",Va,[(0,n.Lk)("h4",null,(0,I.v_)(e.name),1),(0,n.Lk)("p",null,(0,I.v_)(e.description||"Sin descripción"),1),(0,n.Lk)("div",Na,[(0,n.bF)(s,{size:"sm",color:"primary","text-color":"white"},{default:(0,n.k6)((()=>[(0,n.eW)((0,I.v_)(e.media_count||0)+" medios ",1)])),_:2},1024),(0,n.Lk)("span",Xa,(0,I.v_)(a(e.created_at)),1)])]),(0,n.Lk)("div",Wa,[(0,n.bF)(i,{flat:"",round:"",icon:"video_library",size:"sm",color:"secondary",title:"Gestionar medios",onClick:a=>t.$emit("manage",e)},null,8,["onClick"]),(0,n.bF)(i,{flat:"",round:"",icon:"schedule",size:"sm",color:"orange",title:"Programar playlist",onClick:a=>t.$emit("schedule",e)},null,8,["onClick"]),(0,n.bF)(i,{flat:"",round:"",icon:"edit",size:"sm",color:"primary",title:"Editar",onClick:a=>t.$emit("edit",e)},null,8,["onClick"]),(0,n.bF)(i,{flat:"",round:"",icon:"delete",size:"sm",color:"negative",title:"Eliminar",onClick:a=>t.$emit("delete",e.id)},null,8,["onClick"])])])))),128))]))])])}}};const Oa=(0,c.A)(Ka,[["__scopeId","data-v-56cea820"]]);var Qa=Oa,ja=t(503);const Ga={class:"info-card actions-card"},Ha={class:"actions-grid"};var Ja={__name:"QuickActions",emits:["logout"],setup(e){const a=(0,m.rd)(),t=()=>{a.push("/media")},o=()=>{a.push("/test-ok")};return(e,l)=>{const i=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.CE)("div",Ga,[l[8]||(l[8]=(0,n.Lk)("div",{class:"card-title"},[(0,n.Lk)("h3",null,"Acciones Rápidas")],-1)),(0,n.Lk)("div",Ha,[(0,n.Lk)("div",{class:"action-button primary-action",onClick:l[0]||(l[0]=e=>(0,_.R1)(a).push("/config"))},[(0,n.bF)(i,{name:"settings",size:"2rem"}),l[3]||(l[3]=(0,n.Lk)("span",null,"Configuración del Negocio",-1))]),(0,n.Lk)("div",{class:"action-button secondary-action",onClick:l[1]||(l[1]=e=>(0,_.R1)(a).push("/player"))},[(0,n.bF)(i,{name:"play_circle",size:"2rem"}),l[4]||(l[4]=(0,n.Lk)("span",null,"Reproductor",-1))]),(0,n.Lk)("div",{class:"action-button accent-action",onClick:t},[(0,n.bF)(i,{name:"folder",size:"2rem"}),l[5]||(l[5]=(0,n.Lk)("span",null,"Explorar Media",-1))]),(0,n.Lk)("div",{class:"action-button info-action",onClick:o},[(0,n.bF)(i,{name:"support_agent",size:"2rem"}),l[6]||(l[6]=(0,n.Lk)("span",null,"Asistencia",-1))]),(0,n.Lk)("div",{class:"action-button warning-action",onClick:l[2]||(l[2]=a=>e.$emit("logout"))},[(0,n.bF)(i,{name:"logout",size:"2rem"}),l[7]||(l[7]=(0,n.Lk)("span",null,"Cerrar Sesión",-1))])])])}}};const Za=(0,c.A)(Ja,[["__scopeId","data-v-ac02aafe"]]);var Ya=Za;const et={class:"text-h6"};var at={__name:"PlaylistDialog",props:{modelValue:Boolean,playlist:Object,form:Object,loading:Boolean,isDark:Boolean},emits:["update:modelValue","save","close"],setup(e){return(a,t)=>{const o=(0,n.g2)("q-card-section"),l=(0,n.g2)("q-input"),i=(0,n.g2)("q-btn"),s=(0,n.g2)("q-card-actions"),r=(0,n.g2)("q-card"),c=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.Wv)(c,{"model-value":e.modelValue,"onUpdate:modelValue":t[4]||(t[4]=e=>a.$emit("update:modelValue",e)),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(r,{style:{"min-width":"400px"},class:(0,I.C4)({"bg-dark text-white":e.isDark})},{default:(0,n.k6)((()=>[(0,n.bF)(o,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",et,(0,I.v_)(e.playlist?"Editar Playlist":"Nueva Playlist"),1)])),_:1}),(0,n.bF)(o,{class:"q-pt-none"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.name=a),label:"Nombre de la playlist",outlined:"",class:"q-mb-md"},null,8,["modelValue"]),(0,n.bF)(l,{modelValue:e.form.description,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.description=a),label:"Descripción (opcional)",type:"textarea",outlined:"",rows:"3"},null,8,["modelValue"])])),_:1}),(0,n.bF)(s,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(i,{flat:"",label:"Cancelar",onClick:t[2]||(t[2]=e=>a.$emit("close"))}),(0,n.bF)(i,{color:"primary",label:"Guardar",loading:e.loading,onClick:t[3]||(t[3]=e=>a.$emit("save"))},null,8,["loading"])])),_:1})])),_:1},8,["class"])])),_:1},8,["model-value"])}}};const tt=at;var ot=tt,nt=t(714),lt={__name:"ScheduleDialog",props:{modelValue:Boolean,form:Object,loading:Boolean,isDark:Boolean,weekdayOptions:Array},emits:["update:modelValue","save","close"],setup(e){return(a,t)=>{const o=(0,n.g2)("q-card-section"),l=(0,n.g2)("q-input"),i=(0,n.g2)("q-btn"),s=(0,n.g2)("q-card-actions"),r=(0,n.g2)("q-card"),c=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.Wv)(c,{"model-value":e.modelValue,"onUpdate:modelValue":t[3]||(t[3]=e=>a.$emit("update:modelValue",e)),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(r,{style:{"min-width":"400px"},class:(0,I.C4)({"bg-dark text-white":e.isDark})},{default:(0,n.k6)((()=>[(0,n.bF)(o,null,{default:(0,n.k6)((()=>t[4]||(t[4]=[(0,n.Lk)("div",{class:"text-h6"},"Programar Contenido",-1)]))),_:1,__:[4]}),(0,n.bF)(o,{class:"q-pt-none"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{modelValue:e.form.contentName,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.contentName=a),label:"Nombre",outlined:"",class:"q-mb-md"},null,8,["modelValue"])])),_:1}),(0,n.bF)(s,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(i,{flat:"",label:"Cancelar",onClick:t[1]||(t[1]=e=>a.$emit("close"))}),(0,n.bF)(i,{color:"primary",label:"Guardar",loading:e.loading,onClick:t[2]||(t[2]=e=>a.$emit("save"))},null,8,["loading"])])),_:1})])),_:1},8,["class"])])),_:1},8,["model-value"])}}};const it=lt;var st=it;function rt(){const e=(0,_.KR)([]),a=(0,_.Kh)({totalPlaylists:0,totalScheduledItems:0,totalMedia:0}),t=(0,F.dj)(),o=async()=>{try{const{data:a}=await w.fP.list();e.value=a}catch(a){t.error("Error cargando playlists")}},n=async()=>{try{const[e,t]=await Promise.all([w.fP.getStats(),w.DX.list()]);a.totalPlaylists=e.data.total_playlists,a.totalScheduledItems=e.data.total_scheduled_items,a.totalMedia=t.data.length}catch(e){t.error("Error cargando estadísticas")}},l=async e=>{await w.fP.create(e),await o(),await n()},i=async(e,a)=>{await w.fP.update(e,a),await o(),await n()},s=async e=>{await w.fP.delete(e),await o(),await n()};return{playlists:e,stats:a,loadPlaylists:o,loadStats:n,createPlaylist:l,updatePlaylist:i,removePlaylist:s}}function ct(){const e=(0,_.KR)([]),a=(0,F.dj)(),t=async()=>{try{const{data:a}=await w.DX.list();e.value=a}catch(t){a.error("Error cargando medios")}},o=async e=>{await w.DX.delete(e),await t()};return{mediaFiles:e,loadMedia:t,removeMedia:o}}function dt(){const e=(0,_.KR)([]),a=(0,F.dj)(),t=async()=>{try{const{data:a}=await w.gr.list();e.value=a}catch(t){a.error("Error cargando programaciones")}},o=async e=>{await w.gr.create(e),await t()};return{schedules:e,loadSchedules:t,createSchedule:o}}var ut=t(891),mt=t(432),pt=t.n(mt),gt={name:"AdminView",components:{MediaUploader:fa.A,ThemeToggle:S.A,StatisticsCard:xa,PlaylistManagement:Qa,MediaGallery:ja.A,QuickActions:Ya,PlaylistDialog:ot,EditMediaDialog:nt.A,ScheduleDialog:st,draggable:pt()},setup(){const e=(0,m.rd)(),a=(0,C.Jud)(),t=(0,F.dj)(),{isDarkMode:o}=(0,E.D)(),{backendBaseUrl:l}=(0,ut.f)(),i=(0,_.KR)(!1),s=(0,_.KR)(!1),r=(0,_.KR)(!1),c=(0,_.KR)(!1),d=(0,_.Kh)({name:"",description:""}),u=(0,_.Kh)({filename:"",description:""}),p=(0,_.Kh)({contentName:""}),g=(0,_.KR)(!1),v=(0,_.KR)(!1),h=(0,_.KR)(!1),f=(0,_.KR)(!1),{playlists:k,stats:y,loadPlaylists:b,loadStats:L,createPlaylist:S,updatePlaylist:P,removePlaylist:M}=rt(),{mediaFiles:A,loadMedia:I,removeMedia:$}=ct(),{loadSchedules:T}=dt(),x=(0,_.Kh)({name:"",logo:null}),D=(0,_.KR)(null),q=(0,_.KR)(null),z=(0,_.KR)(null),B=(0,_.KR)([]),R=(0,_.KR)([]),U=[{label:"Lun",value:0},{label:"Mar",value:1},{label:"Mié",value:2},{label:"Jue",value:3},{label:"Vie",value:4},{label:"Sáb",value:5},{label:"Dom",value:6}],V=async()=>{await Promise.all([b(),I(),L(),T(),N()])},N=async()=>{try{const e=await w.ZK.get();Object.assign(x,e.data)}catch(e){console.error("Error loading business info:",e),x.name="Signance System",x.logo=null}},X=()=>{D.value=null,d.name="",d.description="",i.value=!0},W=e=>{D.value=e,d.name=e.name,d.description=e.description||"",i.value=!0},K=async()=>{g.value=!0;try{D.value?await P(D.value.id,d):await S(d),i.value=!1}finally{g.value=!1}},O=async e=>{await M(e)},Q=()=>{I(),L()},j=()=>{t.error("Error subiendo archivo")},G=e=>{q.value=e,u.filename=e.filename,u.description=e.description,s.value=!0},H=async()=>{s.value=!1},J=async e=>{await $(e),L()},Z=e=>{p.contentName=e.name,r.value=!0},Y=async e=>{z.value=e;try{const a=await fetch(`${l.value}/api/playlists/${e.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("signance_token")}`}}),t=await a.json();R.value=t.medias||[];const o=new Set(R.value.map((e=>e.id)));B.value=A.value.filter((e=>!o.has(e.id))),c.value=!0}catch(a){t.error("Error cargando datos de playlist"),console.error("Error loading playlist media:",a)}},ee=()=>{c.value=!1,z.value=null,B.value=[],R.value=[]},ae=()=>{i.value=!1},te=()=>{s.value=!1},oe=()=>{r.value=!1},ne=async()=>{h.value=!1,r.value=!1},le=()=>{localStorage.removeItem("signance_token"),e.push("/login")},ie=async e=>{try{const a=await fetch(`${l.value}/api/playlists/${z.value.id}/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("signance_token")}`},body:JSON.stringify({media_id:e.id})});if(!a.ok)throw new Error("Error en la respuesta del servidor");B.value=B.value.filter((a=>a.id!==e.id)),R.value.push({...e,order_index:R.value.length}),t.success(`"${e.filename}" añadido a la playlist`)}catch(a){t.error("Error añadiendo medio a la playlist"),console.error("Error adding media to playlist:",a)}},se=async e=>{try{const a=await fetch(`${l.value}/api/playlists/${z.value.id}/media/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("signance_token")}`}});if(!a.ok)throw new Error("Error en la respuesta del servidor");{const a=R.value.find((a=>a.id===e));a&&(R.value=R.value.filter((a=>a.id!==e)),B.value.push(a),t.success(`"${a.filename}" removido de la playlist`))}}catch(a){t.error("Error removiendo medio de la playlist"),console.error("Error removing media from playlist:",a)}},re=async()=>{try{const e=R.value.map(((e,a)=>({media_id:e.id,order_index:a}))),a=await fetch(`${l.value}/api/playlists/${z.value.id}/reorder`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("signance_token")}`},body:JSON.stringify({media_order:e})});if(!a.ok)throw new Error("Error en la respuesta del servidor");t.success("Orden actualizado")}catch(e){t.error("Error reordenando medios"),console.error("Error reordering media:",e)}},ce=e=>{if(!e)return"description";const a=e.toLowerCase();return a.includes("image")?"image":a.includes("video")?"videocam":a.includes("audio")?"audiotrack":a.includes("pdf")?"picture_as_pdf":"description"};return(0,n.sV)((async()=>{V(),a.dark.set(o.value)})),(0,n.wB)(o,(e=>{a.dark.set(e)})),{backendBaseUrl:l,playlistDialog:i,editMediaDialog:s,scheduleDialog:r,playlistMediaDialog:c,playlistForm:d,editMediaForm:u,scheduleForm:p,savingPlaylist:g,savingMedia:v,savingSchedule:h,mediaLoading:f,playlists:k,stats:y,mediaFiles:A,businessInfo:x,editingPlaylist:D,editingMedia:q,selectedPlaylist:z,availableMedia:B,playlistMedias:R,weekdayOptions:U,isDarkMode:o,loadMedia:I,showCreatePlaylistDialog:X,editPlaylist:W,savePlaylist:K,deletePlaylist:O,managePlaylistMedia:Y,closePlaylistMediaDialog:ee,schedulePlaylist:Z,onMediaUploaded:Q,onMediaUploadError:j,editMedia:G,saveMediaChanges:H,deleteMedia:J,saveSchedule:ne,closePlaylistDialog:ae,closeEditMediaDialog:te,closeScheduleDialog:oe,logout:le,addMediaToPlaylist:ie,removeMediaFromPlaylist:se,reorderPlaylistMedia:re,getMediaIcon:ce}}};const vt=(0,c.A)(gt,[["render",ha],["__scopeId","data-v-2388a27e"]]);var ht=vt;const ft=[{path:"/",name:"Selection",component:ta,meta:{requiresAuth:!1,title:"Pochtecayotl Signance System"}},{path:"/login",name:"Login",component:A,meta:{requiresAuth:!1,title:"Iniciar Sesión - Pochtecayotl Signance System"}},{path:"/config",name:"Config",component:na["default"],meta:{requiresAuth:!1,title:"Configuración - Pochtecayotl Signance System"}},{path:"/test-ok",name:"TestOk",component:ie,meta:{requiresAuth:!0,title:"Prueba Exitosa - Pochtecayotl Signance System"}},{path:"/error",name:"Error",component:Ke,meta:{requiresAuth:!1,title:"Error - Pochtecayotl Signance System"}},{path:"/player",name:"Player",component:oa["default"],meta:{requiresAuth:!1,title:"Reproductor - Pochtecayotl Signance System"}},{path:"/admin",name:"Admin",component:ht,meta:{requiresAuth:!0,role:"admin",title:"Dashboard Admin - Pochtecayotl Signance System"}},{path:"/config-admin",name:"ConfigAdmin",component:()=>Promise.resolve().then(t.bind(t,600)),meta:{requiresAuth:!0,role:"admin"}},{path:"/media",name:"MediaManager",component:()=>t.e(403).then(t.bind(t,403)),meta:{requiresAuth:!0,role:"admin"}},{path:"/player-admin",name:"PlayerAdmin",component:()=>Promise.resolve().then(t.bind(t,642)),meta:{requiresAuth:!0}},{path:"/icon-test",name:"IconTest",component:()=>t.e(935).then(t.bind(t,935)),meta:{requiresAuth:!1,title:"Prueba de Iconos - Pochtecayotl Signance System"}},{path:"/diagnostic",name:"Diagnostic",component:()=>t.e(941).then(t.bind(t,941)),meta:{requiresAuth:!1,title:"Diagnóstico de Iconos - Pochtecayotl Signance System"}},{path:"/simple-test",name:"SimpleTest",component:()=>t.e(650).then(t.bind(t,650)),meta:{requiresAuth:!1,title:"Prueba Simple de Iconos - Pochtecayotl Signance System"}},{path:"/final-test",name:"FinalTest",component:()=>t.e(289).then(t.bind(t,289)),meta:{requiresAuth:!1,title:"Prueba Final de Iconos - Pochtecayotl Signance System"}},{path:"/icon-size-test",name:"IconSizeTest",component:()=>t.e(990).then(t.bind(t,990)),meta:{requiresAuth:!1,title:"Prueba de Tamaños de Iconos - Pochtecayotl Signance System"}}],kt=(0,m.aE)({history:(0,m.LA)("/"),routes:ft});kt.beforeEach(((e,a,t)=>{document.title=e.meta.title||"Pochtecayotl Signance System";const o=localStorage.getItem("signance_token"),n=!!o;e.matched.some((e=>e.meta.requiresAuth))?n?t():t({path:"/login",query:{redirect:e.fullPath}}):t()}));var yt=kt,bt=t(388),Lt=t(86),_t=(t(917),t(880)),Ct=t(95);const Ft=(0,o.Ef)(u);console.log("🎬 Pochtecayotl Signance System - Frontend iniciado"),console.log("🎨 Icon set cargado:",Lt.A),(0,_t.Yp)(),setTimeout((()=>{(0,Ct.applyIconSizeFixes)()}),1e3),Ft.use(C.y87,{plugins:{Notify:C.M9W,Dialog:C.lGe,Loading:C.Rhj},components:{QCard:C.C$d,QCardSection:C.XH8,QCardActions:C.zZw,QBtn:C.IlC,QInput:C.ieb,QForm:C.iXO,QPage:C.Tuf,QPageContainer:C.kci,QLayout:C.QQm,QHeader:C.rpC,QToolbar:C.ZVc,QToolbarTitle:C.r_C,QDrawer:C.psX,QList:C.Mbi,QItem:C.H0$,QItemSection:C.ypq,QItemLabel:C.TwD,QSeparator:C.N7v,QIcon:C.bP4,QSpinner:C.$fs,QLinearProgress:C.GFm,QFile:C.mt8,QUploader:C.IuS,QTable:C.kH6,QTh:C.EJt,QTr:C.qhW,QTd:C.Efd,QSelect:C.Sic,QDate:C.wZt,QTime:C.TpF,QToggle:C.c5C,QDialog:C.OQI,QExpansionItem:C.AIx,QTooltip:C.nCc,QBanner:C.GrT,QBtnToggle:C.QL$,QSkeleton:C.Rf8},lang:bt.A,iconSet:Lt.A,config:{notify:{position:"top-right",timeout:3e3}}});const wt={position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1};Ft.use(F.Ay,wt),Ft.use(yt),(0,w.X3)().catch((e=>{console.warn("⚠️ No se pudo conectar al backend al iniciar:",e.message),console.log("🔄 La detección se reintentará automáticamente en las próximas peticiones")})),Ft.mount("#app")},349:function(e,a,t){"use strict";t.d(a,{A:function(){return s}});const o={BACKEND_PREFERRED_PORT:8e3,PORT_RANGE:{start:8e3,end:8010},HEALTH_ENDPOINT:"/health",CONNECTION_TIMEOUT:3e3};function n(){const e=window.location.hostname,a=[];if(console.log(`🔍 Detectando IPs candidatas desde: ${e}`),"localhost"!==e&&"127.0.0.1"!==e&&(a.push(e),console.log(`✅ Agregando IP actual del frontend: ${e}`)),a.push("127.0.0.1","localhost"),"localhost"!==e&&"127.0.0.1"!==e){const t=e.split(".");if(4===t.length&&t.every((e=>!isNaN(e)))){const e=`${t[0]}.${t[1]}.${t[2]}`;console.log(`🌐 Generando IPs de la red: ${e}.x`);const o=[1,10,50,100,150,200,254];for(const t of o)a.push(`${e}.${t}`)}}const t=["192.168.1","192.168.0","192.168.100","192.168.10","10.0.0","10.0.1","10.1.1","172.16.0","172.16.1"];for(const n of t)e.startsWith(n)||a.push(`${n}.1`,`${n}.100`,`${n}.10`);const o=[...new Set(a)];return console.log(`🎯 ${o.length} IPs candidatas generadas:`,o),o}class l{constructor(){this.detectedPort=null,this.detectedBaseUrl=null,this.portRange=o.PORT_RANGE,this.testEndpoint=o.HEALTH_ENDPOINT,this.preferredPort=o.BACKEND_PREFERRED_PORT,this.connectionTimeout=o.CONNECTION_TIMEOUT}getCurrentHost(){const e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"127.0.0.1":e}getCandidateHosts(){return n()}async detectBackend(){if(console.log("🔍 Iniciando detección automática del backend..."),console.log(`🎯 Puerto preferido: ${this.preferredPort}`),console.log(`📊 Rango de puertos: ${this.portRange.start}-${this.portRange.end}`),this.detectedPort&&this.detectedBaseUrl){console.log(`⚡ Probando configuración previa: ${this.detectedBaseUrl}`);const e=new URL(this.detectedBaseUrl).hostname;if(await this.testSpecificHostPort(e,this.detectedPort))return console.log(`✅ Backend confirmado en configuración previa: ${this.detectedBaseUrl}`),{port:this.detectedPort,baseUrl:this.detectedBaseUrl};console.log("❌ Configuración previa no responde, buscando nuevamente..."),this.detectedPort=null,this.detectedBaseUrl=null}const e=this.getCandidateHosts();console.log(`🎯 ${e.length} hosts candidatos detectados`),console.log(`🚀 FASE 1: Probando puerto preferido ${this.preferredPort} en todas las IPs...`);for(const a of e)if(console.log(`🔍 Probando ${a}:${this.preferredPort}`),await this.testSpecificHostPort(a,this.preferredPort))return this.detectedPort=this.preferredPort,this.detectedBaseUrl=`http://${a}:${this.preferredPort}`,console.log(`✅ ¡Backend encontrado en puerto preferido! ${this.detectedBaseUrl}`),this.saveToLocalStorage(a,this.preferredPort),{port:this.detectedPort,baseUrl:this.detectedBaseUrl};console.log(`🔍 FASE 2: Buscando en rango completo ${this.portRange.start}-${this.portRange.end}...`);for(const a of e){console.log(`🔍 Probando host: ${a}`);for(let e=this.portRange.start;e<=this.portRange.end;e++)if(e!==this.preferredPort&&(console.log(`🔍 Probando puerto ${e} en ${a}...`),await this.testSpecificHostPort(a,e)))return this.detectedPort=e,this.detectedBaseUrl=`http://${a}:${e}`,console.log(`✅ ¡Backend encontrado en ${this.detectedBaseUrl}!`),this.saveToLocalStorage(a,e),{port:this.detectedPort,baseUrl:this.detectedBaseUrl}}throw new Error(`❌ No se pudo encontrar el backend en ningún host candidato (${e.join(", ")}) en puertos ${this.portRange.start}-${this.portRange.end}`)}async testPort(e){if(this.detectedBaseUrl){const a=new URL(this.detectedBaseUrl).hostname;return await this.testSpecificHostPort(a,e)}const a=window.location.hostname;return await this.testSpecificHostPort(a,e)}async testSpecificHostPort(e,a){const t=`http://${e}:${a}`;try{const o=new AbortController,n=setTimeout((()=>o.abort()),3e3),l=await fetch(`${t}${this.testEndpoint}`,{method:"GET",signal:o.signal,mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(n),l.ok){const t=await l.json();if("healthy"===t.status||"auth"===t.module||200===l.status)return console.log(`✅ Puerto ${a} en ${e}: Backend FastAPI confirmado - ${JSON.stringify(t)}`),!0}}catch(o){"AbortError"===o.name?console.log(`⏱️ Puerto ${a} en ${e}: Timeout (3s)`):console.log(`❌ Puerto ${a} en ${e}: ${o.message}`)}return!1}getCachedBackend(){const e=localStorage.getItem("signance_backend_port"),a=localStorage.getItem("signance_backend_url"),t=localStorage.getItem("signance_backend_host"),o=window.location.hostname;return t&&t!==o?(console.log(`🔄 Host cambió de ${t} a ${o}, limpiando caché...`),this.clearCache(),null):e&&a?{port:parseInt(e),baseUrl:a}:null}clearCache(){localStorage.removeItem("signance_backend_port"),localStorage.removeItem("signance_backend_url"),localStorage.removeItem("signance_backend_host"),this.detectedPort=null,this.detectedBaseUrl=null}startHealthCheck(e){this.healthCheckInterval&&clearInterval(this.healthCheckInterval),this.healthCheckInterval=setInterval((async()=>{if(this.detectedPort){const a=await this.testPort(this.detectedPort);!a&&e&&(console.log("❌ Conexión con backend perdida"),e())}}),3e4)}stopHealthCheck(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}saveToLocalStorage(e,a){const t=`http://${e}:${a}`;localStorage.setItem("signance_backend_port",a.toString()),localStorage.setItem("signance_backend_url",t),localStorage.setItem("signance_backend_host",e),console.log(`💾 Configuración guardada: ${t}`)}}const i=new l;var s=i},503:function(e,a,t){"use strict";t.d(a,{A:function(){return ae}});var o=t(641),n=t(33),l=t(953);const i={class:"media-preview"},s={key:0,class:"image-preview"},r=["src","alt"],c={key:1,class:"video-preview"},d=["src"],u={class:"video-overlay"},m={key:0,class:"video-duration"},p={key:2,class:"file-preview"},g={class:"media-info"},v=["title"],h={class:"media-meta"},f={class:"file-size"},k={key:0,class:"upload-date"},y={class:"media-actions"};var b={__name:"MediaCard",props:{media:{type:Object,required:!0},backendBaseUrl:{type:String,default:""},compact:{type:Boolean,default:!1}},emits:["edit","delete"],setup(e){const a=e,t=(0,o.EW)((()=>{const e=a.backendBaseUrl||"",t=a.media.file_url||`/uploads/${a.media.served_filename||a.media.filename}`;return`${e}${t}`})),l=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"image"===e||/\.(jpg|jpeg|png|gif|webp|bmp)$/i.test(a.media.filename)})),b=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"video"===e||/\.(mp4|avi|mov|mkv|webm)$/i.test(a.media.filename)})),L=()=>{const e=a.media.filename||"",t=e.split(".").pop()?.toLowerCase();switch(t){case"pdf":return"picture_as_pdf";case"doc":case"docx":return"description";case"mp3":case"wav":case"aac":return"audiotrack";default:return"insert_drive_file"}},_=e=>{if(!e)return"N/A";const a=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+a[t]},C=e=>{if(!e)return"";const a=Math.floor(e/60),t=Math.floor(e%60);return`${a}:${t.toString().padStart(2,"0")}`},F=e=>{if(!e)return"";const a=new Date(e);return a.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})},w=e=>{const a=e.target,t=a.closest(".image-preview");t&&(t.innerHTML='\n      <div class="file-preview">\n        <q-icon name="broken_image" size="3rem" color="grey-6" />\n      </div>\n    ')},E=e=>{const a=e.target,t=a.closest(".video-preview");t&&(t.innerHTML='\n      <div class="file-preview">\n        <q-icon name="error" size="3rem" color="grey-6" />\n      </div>\n    ')};return(a,S)=>{const P=(0,o.g2)("q-icon"),M=(0,o.g2)("q-tooltip"),A=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.CE)("div",{class:(0,n.C4)(["media-card",{"compact-card":e.compact}])},[(0,o.Lk)("div",i,[l.value?((0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("img",{src:t.value,alt:e.media.filename,onError:w,class:"preview-img"},null,40,r)])):b.value?((0,o.uX)(),(0,o.CE)("div",c,[(0,o.Lk)("video",{src:t.value,class:"preview-video",muted:"",preload:"metadata",onError:E},null,40,d),(0,o.Lk)("div",u,[(0,o.bF)(P,{name:"play_circle_filled",size:"2.5rem",class:"play-icon"}),e.media.duration?((0,o.uX)(),(0,o.CE)("div",m,(0,n.v_)(C(e.media.duration)),1)):(0,o.Q3)("",!0)])])):((0,o.uX)(),(0,o.CE)("div",p,[(0,o.bF)(P,{name:L(),size:"3rem",color:"grey-6"},null,8,["name"])]))]),(0,o.Lk)("div",g,[(0,o.Lk)("h4",{class:"media-title",title:e.media.filename},(0,n.v_)(e.media.filename),9,v),(0,o.Lk)("p",h,[(0,o.Lk)("span",f,(0,n.v_)(_(e.media.file_size||e.media.size)),1),e.media.created_at?((0,o.uX)(),(0,o.CE)("span",k,(0,n.v_)(F(e.media.created_at)),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",y,[(0,o.bF)(A,{flat:"",round:"",icon:"edit",onClick:S[0]||(S[0]=e=>a.$emit("edit")),size:"sm",color:"primary"},{default:(0,o.k6)((()=>[(0,o.bF)(M,null,{default:(0,o.k6)((()=>S[2]||(S[2]=[(0,o.eW)("Editar")]))),_:1,__:[2]})])),_:1}),(0,o.bF)(A,{flat:"",round:"",icon:"delete",onClick:S[1]||(S[1]=e=>a.$emit("delete")),size:"sm",color:"negative"},{default:(0,o.k6)((()=>[(0,o.bF)(M,null,{default:(0,o.k6)((()=>S[3]||(S[3]=[(0,o.eW)("Eliminar")]))),_:1,__:[3]})])),_:1})])],2)}}},L=t(262);const _=(0,L.A)(b,[["__scopeId","data-v-0ad5556d"]]);var C=_;const F={class:"media-list-item"},w={class:"media-thumbnail"},E={key:0,class:"image-thumb"},S=["src","alt"],P={key:1,class:"video-thumb"},M=["src"],A={key:2,class:"file-thumb"},I={class:"media-details"},$={class:"media-name"},T={key:0},x={class:"media-metadata"},D={class:"meta-item"},q={class:"meta-item"},z={key:0,class:"meta-item"},B={key:1,class:"meta-item"},R={class:"media-list-actions"};var U={__name:"MediaListItem",props:{media:{type:Object,required:!0},backendBaseUrl:{type:String,default:""}},emits:["edit","delete"],setup(e){const a=e,t=(0,o.EW)((()=>{const e=a.backendBaseUrl||"",t=a.media.file_url||`/uploads/${a.media.served_filename||a.media.filename}`;return`${e}${t}`})),l=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"image"===e||/\.(jpg|jpeg|png|gif|webp|bmp)$/i.test(a.media.filename)})),i=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"video"===e||/\.(mp4|avi|mov|mkv|webm)$/i.test(a.media.filename)})),s=()=>{const e=a.media.filename||"",t=e.split(".").pop()?.toLowerCase();switch(t){case"pdf":return"picture_as_pdf";case"doc":case"docx":return"description";case"mp3":case"wav":case"aac":return"audiotrack";default:return"insert_drive_file"}},r=()=>{const e=a.media.file_type||a.media.media_type;if(e)return e.charAt(0).toUpperCase()+e.slice(1);const t=a.media.filename||"",o=t.split(".").pop()?.toLowerCase();return o?o.toUpperCase():"Archivo"},c=e=>{if(!e)return"N/A";const a=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+a[t]},d=e=>{if(!e)return"";const a=Math.floor(e/60),t=Math.floor(e%60);return`${a}:${t.toString().padStart(2,"0")}`},u=e=>{if(!e)return"";const a=new Date(e);return a.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},m=e=>{const a=e.target,t=a.closest(".image-thumb");t&&(t.innerHTML='\n      <div class="file-thumb">\n        <q-icon name="broken_image" size="2rem" color="grey-6" />\n      </div>\n    ')},p=e=>{const a=e.target,t=a.closest(".video-thumb");t&&(t.innerHTML='\n      <div class="file-thumb">\n        <q-icon name="error" size="2rem" color="grey-6" />\n      </div>\n    ')};return(a,g)=>{const v=(0,o.g2)("q-icon"),h=(0,o.g2)("q-tooltip"),f=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.CE)("div",F,[(0,o.Lk)("div",w,[l.value?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("img",{src:t.value,alt:e.media.filename,onError:m},null,40,S)])):i.value?((0,o.uX)(),(0,o.CE)("div",P,[(0,o.Lk)("video",{src:t.value,muted:"",preload:"metadata",onError:p},null,40,M),(0,o.bF)(v,{name:"play_circle_filled",class:"play-overlay"})])):((0,o.uX)(),(0,o.CE)("div",A,[(0,o.bF)(v,{name:s(),size:"2rem"},null,8,["name"])]))]),(0,o.Lk)("div",I,[(0,o.Lk)("div",$,[(0,o.Lk)("h4",null,(0,n.v_)(e.media.filename),1),e.media.description?((0,o.uX)(),(0,o.CE)("p",T,(0,n.v_)(e.media.description),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",x,[(0,o.Lk)("div",D,[(0,o.bF)(v,{name:"folder",size:"sm"}),(0,o.Lk)("span",null,(0,n.v_)(r()),1)]),(0,o.Lk)("div",q,[(0,o.bF)(v,{name:"data_usage",size:"sm"}),(0,o.Lk)("span",null,(0,n.v_)(c(e.media.file_size||e.media.size)),1)]),e.media.duration?((0,o.uX)(),(0,o.CE)("div",z,[(0,o.bF)(v,{name:"schedule",size:"sm"}),(0,o.Lk)("span",null,(0,n.v_)(d(e.media.duration)),1)])):(0,o.Q3)("",!0),e.media.created_at?((0,o.uX)(),(0,o.CE)("div",B,[(0,o.bF)(v,{name:"event",size:"sm"}),(0,o.Lk)("span",null,(0,n.v_)(u(e.media.created_at)),1)])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",R,[(0,o.bF)(f,{flat:"",round:"",icon:"edit",onClick:g[0]||(g[0]=e=>a.$emit("edit")),size:"sm",color:"primary"},{default:(0,o.k6)((()=>[(0,o.bF)(h,null,{default:(0,o.k6)((()=>g[2]||(g[2]=[(0,o.eW)("Editar")]))),_:1,__:[2]})])),_:1}),(0,o.bF)(f,{flat:"",round:"",icon:"delete",onClick:g[1]||(g[1]=e=>a.$emit("delete")),size:"sm",color:"negative"},{default:(0,o.k6)((()=>[(0,o.bF)(h,null,{default:(0,o.k6)((()=>g[3]||(g[3]=[(0,o.eW)("Eliminar")]))),_:1,__:[3]})])),_:1})])])}}};const V=(0,L.A)(U,[["__scopeId","data-v-4dde5f74"]]);var N=V;const X={class:"gallery-header"},W={class:"header-info"},K={class:"header-text"},O={class:"header-controls"},Q={key:1,class:"view-controls"},j={class:"gallery-content"},G={key:0,class:"empty-state"},H={key:1,class:"loading-state"},J={key:3,class:"media-list"},Z={key:0,class:"show-more"};var Y={__name:"MediaGallery",props:{mediaFiles:{type:Array,default:()=>[]},backendBaseUrl:{type:String,default:""},loading:{type:Boolean,default:!1},mode:{type:String,default:"compact",validator:e=>["compact","full"].includes(e)},title:{type:String,default:""},subtitle:{type:String,default:""},maxItems:{type:Number,default:6}},emits:["refresh","edit","delete","show-all"],setup(e){const a=e,t=(0,l.KR)(""),i=(0,l.KR)("grid"),s=(0,o.EW)((()=>{if(!a.mediaFiles)return[];let e=[...a.mediaFiles];if(t.value){const a=t.value.toLowerCase();e=e.filter((e=>e.filename?.toLowerCase().includes(a)||e.description?.toLowerCase().includes(a)))}return e.sort(((e,a)=>{const t=new Date(e.created_at||e.upload_date||0),o=new Date(a.created_at||a.upload_date||0);return o-t})),e})),r=(0,o.EW)((()=>"compact"===a.mode?s.value.slice(0,a.maxItems):s.value));return(a,l)=>{const c=(0,o.g2)("q-icon"),d=(0,o.g2)("q-input"),u=(0,o.g2)("q-btn-toggle"),m=(0,o.g2)("q-tooltip"),p=(0,o.g2)("q-btn"),g=(0,o.g2)("q-skeleton");return(0,o.uX)(),(0,o.CE)("div",{class:(0,n.C4)(["media-gallery",{"full-view":"full"===e.mode,"compact-view":"compact"===e.mode}])},[(0,o.Lk)("div",X,[(0,o.Lk)("div",W,[(0,o.bF)(c,{name:"video_library",size:"2rem"}),(0,o.Lk)("div",K,[(0,o.Lk)("h3",null,(0,n.v_)(e.title||"Archivos Multimedia"),1),(0,o.Lk)("p",null,(0,n.v_)(e.subtitle||("full"===e.mode?"Gestiona tu biblioteca completa":"Archivos recientes")),1)])]),(0,o.Lk)("div",O,["full"===e.mode?((0,o.uX)(),(0,o.Wv)(d,{key:0,modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value=e),placeholder:"Buscar archivos...",outlined:"",dense:"",class:"search-input"},{prepend:(0,o.k6)((()=>[(0,o.bF)(c,{name:"search"})])),append:(0,o.k6)((()=>[t.value?((0,o.uX)(),(0,o.Wv)(c,{key:0,name:"clear",onClick:l[0]||(l[0]=e=>t.value=""),class:"cursor-pointer"})):(0,o.Q3)("",!0)])),_:1},8,["modelValue"])):(0,o.Q3)("",!0),"full"===e.mode?((0,o.uX)(),(0,o.CE)("div",Q,[(0,o.bF)(u,{modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=e=>i.value=e),options:[{label:"Tarjetas",value:"grid",icon:"grid_view"},{label:"Lista",value:"list",icon:"view_list"}],flat:"",color:"primary","toggle-color":"primary","no-caps":""},null,8,["modelValue"])])):(0,o.Q3)("",!0),(0,o.bF)(p,{flat:"",icon:"refresh",onClick:l[3]||(l[3]=e=>a.$emit("refresh")),loading:e.loading,round:"",color:"primary"},{default:(0,o.k6)((()=>[(0,o.bF)(m,null,{default:(0,o.k6)((()=>l[5]||(l[5]=[(0,o.eW)("Actualizar")]))),_:1,__:[5]})])),_:1},8,["loading"])])]),(0,o.Lk)("div",j,[0!==s.value.length||e.loading?e.loading?((0,o.uX)(),(0,o.CE)("div",H,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)("compact"===e.mode?8:6,(e=>((0,o.uX)(),(0,o.Wv)(g,{height:"150px",class:"q-mb-md",key:e})))),128))])):"grid"===i.value?((0,o.uX)(),(0,o.CE)("div",{key:2,class:(0,n.C4)(["media-grid",{"compact-grid":"compact"===e.mode}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.value,(t=>((0,o.uX)(),(0,o.Wv)(C,{key:t.id,media:t,"backend-base-url":e.backendBaseUrl,compact:"compact"===e.mode,onEdit:e=>a.$emit("edit",t),onDelete:e=>a.$emit("delete",t.id)},null,8,["media","backend-base-url","compact","onEdit","onDelete"])))),128))],2)):"list"===i.value&&"full"===e.mode?((0,o.uX)(),(0,o.CE)("div",J,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.value,(t=>((0,o.uX)(),(0,o.Wv)(N,{key:t.id,media:t,"backend-base-url":e.backendBaseUrl,onEdit:e=>a.$emit("edit",t),onDelete:e=>a.$emit("delete",t.id)},null,8,["media","backend-base-url","onEdit","onDelete"])))),128))])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",G,[(0,o.bF)(c,{name:"video_library",size:"4rem",color:"grey-5"}),(0,o.Lk)("h4",null,(0,n.v_)(t.value?"No se encontraron archivos":"No hay archivos multimedia"),1),(0,o.Lk)("p",null,(0,n.v_)(t.value?"Intenta con otros términos de búsqueda":"Sube tus primeros archivos multimedia"),1)]))]),"compact"===e.mode&&e.mediaFiles.length>e.maxItems?((0,o.uX)(),(0,o.CE)("div",Z,[(0,o.bF)(p,{flat:"",color:"primary",label:`Ver todos (${e.mediaFiles.length} archivos)`,icon:"arrow_forward",onClick:l[4]||(l[4]=e=>a.$emit("show-all"))},null,8,["label"])])):(0,o.Q3)("",!0)],2)}}};const ee=(0,L.A)(Y,[["__scopeId","data-v-8cf16336"]]);var ae=ee},600:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return V}});var o=t(641),n=t(33),l=t(751);const i={class:"config-container"},s={class:"theme-toggle-container"},r={key:0,class:"loading-overlay"},c={key:1,class:"config-content"},d={class:"config-card"},u={class:"config-header"},m={class:"header-content"},p={class:"logo-container"},g={class:"page-title"},v={class:"page-subtitle"},h={key:0,class:"status-badge"},f={class:"config-form-section"},k={class:"input-group"},y={class:"input-group"},b={class:"logo-upload-section"},L={class:"logo-upload-header"},_={key:0,class:"current-logo-preview"},C={class:"logo-preview-container"},F=["src"],w={key:1,class:"new-logo-preview"},E={class:"logo-preview-container"},S=["src"],P={class:"form-actions"},M={class:"footer-section"},A={class:"diversity-message"};function I(e,a,t,I,$,T){const x=(0,o.g2)("ThemeToggle"),D=(0,o.g2)("q-spinner-dots"),q=(0,o.g2)("q-icon"),z=(0,o.g2)("q-input"),B=(0,o.g2)("q-btn"),R=(0,o.g2)("q-file"),U=(0,o.g2)("q-form");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",s,[(0,o.bF)(x)]),I.initialLoading?((0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(D,{size:"3rem"}),a[2]||(a[2]=(0,o.Lk)("p",null,"Cargando configuración...",-1))])):((0,o.uX)(),(0,o.CE)("div",c,[(0,o.Lk)("div",d,[(0,o.Lk)("div",u,[(0,o.Lk)("div",m,[(0,o.Lk)("div",p,[(0,o.bF)(q,{name:"business",class:"main-logo"}),a[3]||(a[3]=(0,o.Lk)("div",{class:"logo-glow"},null,-1))]),(0,o.Lk)("h2",g,(0,n.v_)(I.isUpdate?"Actualizar Negocio":"Configurar Negocio"),1),(0,o.Lk)("p",v,(0,n.v_)(I.isUpdate?"Modifica la información de tu negocio":"Configura tu espacio LGBT+ friendly"),1),a[5]||(a[5]=(0,o.Lk)("div",{class:"pride-divider"},null,-1)),I.isUpdate?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(q,{name:"check_circle"}),a[4]||(a[4]=(0,o.Lk)("span",null,"Negocio ya configurado",-1))])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",f,[(0,o.bF)(U,{onSubmit:(0,l.D$)(I.save,["prevent"]),class:"config-form"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",k,[(0,o.bF)(z,{modelValue:I.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>I.form.name=e),label:"Nombre del negocio",outlined:"",dense:"",required:"",class:"modern-input",rules:[e=>!!e||"El nombre es requerido"]},{prepend:(0,o.k6)((()=>[(0,o.bF)(q,{name:"store",class:"input-icon"})])),_:1},8,["modelValue","rules"])]),(0,o.Lk)("div",y,[(0,o.Lk)("div",b,[(0,o.Lk)("div",L,[(0,o.bF)(q,{name:"image",class:"input-icon"}),a[6]||(a[6]=(0,o.Lk)("span",null,"Logo del negocio",-1))]),I.currentLogoPreview?((0,o.uX)(),(0,o.CE)("div",_,[a[7]||(a[7]=(0,o.Lk)("div",{class:"preview-label"},"Logo actual:",-1)),(0,o.Lk)("div",C,[(0,o.Lk)("img",{src:I.currentLogoPreview,alt:"Logo actual",class:"logo-preview"},null,8,F),(0,o.bF)(B,{flat:"",round:"",icon:"close",size:"sm",onClick:I.clearCurrentLogo,class:"remove-logo-btn"},null,8,["onClick"])])])):(0,o.Q3)("",!0),(0,o.bF)(R,{modelValue:I.form.logo,"onUpdate:modelValue":[a[1]||(a[1]=e=>I.form.logo=e),I.onLogoSelected],label:"Subir nuevo logo (PNG, JPG, JPEG)",accept:"image/png,image/jpg,image/jpeg",outlined:"",dense:"",class:"modern-input","max-file-size":5242880},{prepend:(0,o.k6)((()=>[(0,o.bF)(q,{name:"upload"})])),_:1},8,["modelValue","onUpdate:modelValue"]),I.newLogoPreview?((0,o.uX)(),(0,o.CE)("div",w,[a[8]||(a[8]=(0,o.Lk)("div",{class:"preview-label"},"Nuevo logo:",-1)),(0,o.Lk)("div",E,[(0,o.Lk)("img",{src:I.newLogoPreview,alt:"Nuevo logo",class:"logo-preview"},null,8,S),(0,o.bF)(B,{flat:"",round:"",icon:"close",size:"sm",onClick:I.clearNewLogo,class:"remove-logo-btn"},null,8,["onClick"])])])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",P,[I.isUpdate?((0,o.uX)(),(0,o.Wv)(B,{key:0,flat:"",color:"grey",label:"Cancelar",onClick:I.goToAdmin,class:"cancel-btn"},null,8,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(B,{type:"submit",label:I.isUpdate?"Actualizar Configuración":"Guardar Configuración",class:"save-btn",size:"md",unelevated:"",loading:I.loading,disable:!I.form.name},null,8,["label","loading","disable"])])])),_:1},8,["onSubmit"])]),(0,o.Lk)("div",M,[(0,o.Lk)("div",A,[(0,o.bF)(q,{name:"favorite",class:"heart-icon"}),a[9]||(a[9]=(0,o.Lk)("span",null,"Programado por un gei 🏳️‍🌈",-1))])])])]))])}var $=t(953),T=t(220),x=t(889),D=t(246),q=t(725),z=t(697),B={name:"ConfigView",components:{ThemeToggle:z.A},setup(){const e=(0,T.rd)(),a=(0,D.dj)(),{loadTheme:t}=(0,q.D)(),n=(0,$.KR)(!1),l=(0,$.KR)(!0),i=(0,$.KR)(!1),s=(0,$.KR)(null),r=(0,$.KR)(null),c=(0,$.KR)(null),d=(0,$.KR)({name:"",logo:null}),u=async()=>{try{const a=await x.ZK.get();if(a.data&&(s.value=a.data,d.value.name=a.data.name||"",i.value=!0,a.data.id))try{const e=await x.ZK.getLogo();e.data?.logo&&(r.value=`data:image/png;base64,${e.data.logo}`)}catch(e){console.log("No hay logo existente")}}catch(e){console.log("No hay negocio configurado, será creación"),i.value=!1}finally{l.value=!1}},m=e=>{if(e){const t=["image/png","image/jpeg","image/jpg"];if(!t.includes(e.type))return a.error("Solo se permiten archivos PNG, JPG o JPEG"),void(d.value.logo=null);if(e.size>5242880)return a.error("El archivo es muy grande. Máximo 5MB."),void(d.value.logo=null);const o=new FileReader;o.onload=e=>{c.value=e.target.result},o.readAsDataURL(e)}else c.value=null},p=()=>{r.value=null,i.value&&a.info("El logo actual será eliminado al guardar")},g=()=>{d.value.logo=null,c.value=null},v=async()=>{if(d.value.name){n.value=!0;try{const t={name:d.value.name,logo:d.value.logo};let o;i.value?(o=await x.ZK.update(t),a.success("¡Negocio actualizado exitosamente!")):(o=await x.ZK.create(t),a.success("¡Negocio configurado exitosamente!")),i.value?e.push("/admin"):e.push("/login")}catch(t){const e=i.value?"Error actualizando la configuración del negocio":"Error guardando la configuración del negocio";a.error(e),console.error("Error:",t)}finally{n.value=!1}}else a.warning("Ingresa el nombre del negocio")},h=()=>{e.push("/admin")};return(0,o.sV)((async()=>{t(),await u()})),{form:d,save:v,loading:n,initialLoading:l,isUpdate:i,currentBusiness:s,currentLogoPreview:r,newLogoPreview:c,onLogoSelected:m,clearCurrentLogo:p,clearNewLogo:g,goToAdmin:h}}},R=t(262);const U=(0,R.A)(B,[["render",I],["__scopeId","data-v-e2c0c8dc"]]);var V=U},642:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return _e}});var o=t(641),n=t(33);const l={key:1,class:"selection-state"},i={class:"player-header"},s={class:"header-content"},r={class:"header-icon"},c={class:"main-content"},d={class:"content-card"},u={key:0,class:"loading-section"},m={key:1,class:"playlists-section"},p={class:"section-header"},g={class:"playlist-count"},v={class:"playlists-grid"},h=["onClick"],f={class:"playlist-icon"},k={class:"playlist-info"},y={class:"playlist-meta"},b={class:"meta-item"},L={class:"meta-item"},_={class:"playlist-action"},C={key:2,class:"empty-state"},F={class:"empty-icon"},w={class:"empty-actions"},E={class:"footer-actions"},S={key:2,class:"player-state"},P={class:"media-display-area"},M={key:0,class:"media-container"},A={key:0,class:"image-display"},I=["src","alt"],$={key:1,class:"video-display"},T=["src"],x={key:2,class:"loading-media"},D={key:3,class:"media-info-overlay"},q={class:"media-info"},z={class:"media-details"},B={key:1,class:"loading-media"},R={key:0,class:"player-controls normal-controls"},U={class:"control-panel"},V={class:"playlist-info-controls"},N={class:"media-controls"},X={class:"progress-info"},W={class:"progress-bar"},K={class:"time-info"},O={class:"additional-controls"},Q={key:2,class:"business-logo-overlay"},j=["src"],G={key:3,class:"schedule-notification"};function H(e,a,t,H,J,Z){const Y=(0,o.g2)("ThemeToggle"),ee=(0,o.g2)("q-icon"),ae=(0,o.g2)("q-spinner"),te=(0,o.g2)("q-btn"),oe=(0,o.g2)("q-spinner-dots"),ne=(0,o.g2)("q-linear-progress"),le=(0,o.g2)("q-tooltip"),ie=(0,o.g2)("q-banner");return(0,o.uX)(),(0,o.CE)("div",{class:(0,n.C4)(["player-container",{"fullscreen-mode":H.isFullscreen}]),onMousemove:a[5]||(a[5]=e=>H.isFullscreen?H.onMouseMoveFullscreen():null)},[H.isFullscreen?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(Y,{key:0,class:"theme-toggle"})),H.selectedPlaylist?((0,o.uX)(),(0,o.CE)("div",S,[(0,o.Lk)("div",P,[H.currentMedia?((0,o.uX)(),(0,o.CE)("div",M,["image"===H.currentMedia.media_type&&H.currentMediaSrc?((0,o.uX)(),(0,o.CE)("div",A,[(0,o.Lk)("img",{src:H.currentMediaSrc,alt:H.currentMedia.filename,class:"media-image",onError:a[0]||(a[0]=(...e)=>H.handleMediaError&&H.handleMediaError(...e)),onLoad:a[1]||(a[1]=(...e)=>H.onMediaLoaded&&H.onMediaLoaded(...e))},null,40,I)])):"video"===H.currentMedia.media_type&&H.currentMediaSrc?((0,o.uX)(),(0,o.CE)("div",$,[(0,o.Lk)("video",{ref:"videoPlayer",src:H.currentMediaSrc,class:"media-video",onEnded:a[2]||(a[2]=(...e)=>H.onMediaEnded&&H.onMediaEnded(...e)),onError:a[3]||(a[3]=(...e)=>H.handleMediaError&&H.handleMediaError(...e)),onLoadeddata:a[4]||(a[4]=(...e)=>H.onMediaLoaded&&H.onMediaLoaded(...e)),autoplay:"",muted:""},null,40,T)])):H.currentMedia&&!H.currentMediaSrc?((0,o.uX)(),(0,o.CE)("div",x,[(0,o.bF)(oe,{color:"primary",size:"3rem"}),(0,o.Lk)("p",null,"Preparando "+(0,n.v_)(H.currentMedia.filename)+"...",1)])):(0,o.Q3)("",!0),H.showInfo?((0,o.uX)(),(0,o.CE)("div",D,[(0,o.Lk)("div",q,[(0,o.Lk)("h3",null,(0,n.v_)(H.currentMedia.filename),1),(0,o.Lk)("p",null,(0,n.v_)(H.currentMedia.description||"Sin descripción"),1),(0,o.Lk)("div",z,[(0,o.Lk)("span",null,"Duración: "+(0,n.v_)(H.getCurrentDuration())+"s",1),(0,o.Lk)("span",null,"Tipo: "+(0,n.v_)(H.currentMedia.media_type),1),(0,o.Lk)("span",null,"Posición: "+(0,n.v_)(H.currentMediaIndex+1)+"/"+(0,n.v_)(H.playlistMedia.length),1)])])])):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",B,[(0,o.bF)(ae,{color:"primary",size:"4rem"}),a[11]||(a[11]=(0,o.Lk)("p",null,"Cargando próximo contenido...",-1))]))]),H.isFullscreen?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",R,[(0,o.Lk)("div",U,[(0,o.Lk)("div",V,[(0,o.Lk)("h4",null,(0,n.v_)(H.selectedPlaylist.name),1),(0,o.Lk)("p",null,(0,n.v_)(H.playlistMedia.length)+" elementos • Reproduciendo en bucle",1)]),(0,o.Lk)("div",N,[(0,o.bF)(te,{icon:H.isPlaying?"pause":"play_arrow",onClick:H.togglePlayPause,color:"primary",size:"lg",round:"",class:"play-pause-btn"},null,8,["icon","onClick"]),(0,o.bF)(te,{icon:"skip_next",onClick:H.skipToNext,color:"secondary",size:"md",round:"",class:"skip-btn"},null,8,["onClick"]),(0,o.bF)(te,{icon:"skip_previous",onClick:H.skipToPrevious,color:"secondary",size:"md",round:"",class:"skip-btn"},null,8,["onClick"])]),(0,o.Lk)("div",X,[(0,o.Lk)("div",W,[(0,o.bF)(ne,{value:H.progress,color:"primary",size:"4px",class:"media-progress"},null,8,["value"]),(0,o.Lk)("div",K,[(0,o.Lk)("span",null,(0,n.v_)(H.formatTime(H.elapsedTime)),1),(0,o.Lk)("span",null,(0,n.v_)(H.formatTime(H.getCurrentDuration())),1)])])]),(0,o.Lk)("div",O,[(0,o.bF)(te,{icon:H.showInfo?"info":"info_outline",onClick:H.toggleInfo,flat:"",round:"",class:"info-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(le,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,n.v_)(H.showInfo?"Ocultar":"Mostrar")+" información",1)])),_:1})])),_:1},8,["icon","onClick"]),(0,o.bF)(te,{icon:"fullscreen",onClick:H.toggleFullscreen,flat:"",round:"",size:"md",class:"fullscreen-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(le,null,{default:(0,o.k6)((()=>a[12]||(a[12]=[(0,o.eW)("Pantalla completa")]))),_:1,__:[12]})])),_:1},8,["onClick"]),(0,o.bF)(te,{icon:"stop",onClick:H.stopPlayback,flat:"",round:"",color:"negative",class:"stop-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(le,null,{default:(0,o.k6)((()=>a[13]||(a[13]=[(0,o.eW)("Detener y volver")]))),_:1,__:[13]})])),_:1},8,["onClick"])])])])),H.isFullscreen?((0,o.uX)(),(0,o.CE)("div",{key:1,class:(0,n.C4)(["fullscreen-exit-overlay",{visible:H.showFullscreenControls}])},[(0,o.bF)(te,{icon:"fullscreen_exit",onClick:H.toggleFullscreen,color:"white","text-color":"black",size:"xl",round:"",class:"exit-fullscreen-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(le,null,{default:(0,o.k6)((()=>a[14]||(a[14]=[(0,o.eW)("Salir de pantalla completa (ESC)")]))),_:1,__:[14]})])),_:1},8,["onClick"])],2)):(0,o.Q3)("",!0),H.isFullscreen&&H.businessLogo?((0,o.uX)(),(0,o.CE)("div",Q,[(0,o.Lk)("img",{src:H.businessLogo,alt:"Logo",class:"business-logo"},null,8,j)])):(0,o.Q3)("",!0),H.scheduleOverride&&!H.isFullscreen?((0,o.uX)(),(0,o.CE)("div",G,[(0,o.bF)(ie,{class:"bg-orange text-white"},{avatar:(0,o.k6)((()=>[(0,o.bF)(ee,{name:"schedule"})])),action:(0,o.k6)((()=>[(0,o.bF)(te,{flat:"",icon:"close",onClick:H.dismissScheduleNotification},null,8,["onClick"])])),default:(0,o.k6)((()=>[a[15]||(a[15]=(0,o.Lk)("strong",null,"Programación Activa",-1)),a[16]||(a[16]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)(' Reproduciendo contenido programado: "'+(0,n.v_)(H.scheduleOverride.media.filename)+'" ',1)])),_:1,__:[15,16]})])):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",i,[(0,o.Lk)("div",s,[(0,o.Lk)("div",r,[(0,o.bF)(ee,{name:"play_circle_filled",size:"3rem"})]),a[6]||(a[6]=(0,o.Lk)("div",{class:"header-text"},[(0,o.Lk)("h2",null,"Reproductor de Contenido"),(0,o.Lk)("p",null,"Seleccione una playlist para comenzar la reproducción")],-1))])]),(0,o.Lk)("div",c,[(0,o.Lk)("div",d,[H.loading?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(ae,{color:"primary",size:"3rem"}),a[7]||(a[7]=(0,o.Lk)("p",{class:"loading-text"},"Cargando playlists...",-1))])):H.playlists.length?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("div",p,[a[8]||(a[8]=(0,o.Lk)("h3",null,"Playlists Disponibles",-1)),(0,o.Lk)("div",g,(0,n.v_)(H.playlists.length)+" playlist"+(0,n.v_)(1!==H.playlists.length?"s":"")+" disponible"+(0,n.v_)(1!==H.playlists.length?"s":""),1)]),(0,o.Lk)("div",v,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(H.playlists,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"playlist-card",onClick:a=>H.selectPlaylist(e)},[(0,o.Lk)("div",f,[(0,o.bF)(ee,{name:"queue_music",size:"2.5rem"})]),(0,o.Lk)("div",k,[(0,o.Lk)("h4",null,(0,n.v_)(e.name),1),(0,o.Lk)("p",null,(0,n.v_)(e.description||"Lista de reproducción de contenido multimedia"),1),(0,o.Lk)("div",y,[(0,o.Lk)("span",b,[(0,o.bF)(ee,{name:"schedule",size:"1rem"}),(0,o.eW)(" "+(0,n.v_)(H.formatTotalDuration(e.total_duration)),1)]),(0,o.Lk)("span",L,[(0,o.bF)(ee,{name:"playlist_play",size:"1rem"}),(0,o.eW)(" "+(0,n.v_)(e.media_count||0)+" elementos ",1)])])]),(0,o.Lk)("div",_,[(0,o.bF)(ee,{name:"play_arrow",size:"1.5rem"})])],8,h)))),128))])])):((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",F,[(0,o.bF)(ee,{name:"playlist_remove",size:"4rem"})]),a[9]||(a[9]=(0,o.Lk)("h3",null,"No hay playlists disponibles",-1)),a[10]||(a[10]=(0,o.Lk)("p",null,"Actualmente no hay ninguna playlist configurada en el sistema.",-1)),(0,o.Lk)("div",w,[(0,o.bF)(te,{color:"primary",icon:"add",label:"Crear Playlist",onClick:H.goToAdmin,rounded:"",unelevated:""},null,8,["onClick"])])]))])]),(0,o.Lk)("div",E,[(0,o.bF)(te,{color:"secondary",icon:"arrow_back",label:"Volver",onClick:H.goBack,outline:"",rounded:""},null,8,["onClick"]),(0,o.bF)(te,{color:"accent",icon:"refresh",label:"Actualizar",onClick:H.fetchPlaylists,rounded:"",unelevated:""},null,8,["onClick"])])]))],34)}var J=t(953),Z=t(220),Y=t(335),ee=t(349),ae=t(680);let te=Y.A.create({baseURL:"",timeout:15e3,headers:{"Content-Type":"application/json"}}),oe=!1,ne=null;const le=async()=>oe?te:ne||(ne=(async()=>{try{console.log("🎬 Inicializando API del reproductor...");const e=(0,ae.w)();if(e)return console.log("🎯 Player API en modo producción, usando mismo origen"),te.defaults.baseURL=`${e.baseUrl}/api`,await te.get("/health",{timeout:5e3}),oe=!0,console.log(`✅ Player API inicializada en modo producción: ${e.baseUrl}`),te;console.log("🔧 Player API en modo desarrollo, detectando backend...");const{baseUrl:a}=await ee.A.detectBackend();return te.defaults.baseURL=`${a}/api`,await te.get("/health",{timeout:5e3}),oe=!0,console.log(`✅ API del reproductor inicializada: ${a}`),te}catch(e){console.error("❌ Error inicializando API del reproductor:",e),te.defaults.baseURL="http://127.0.0.1:8000/api";try{return await te.get("/health",{timeout:3e3}),console.log("✅ API del reproductor inicializada con fallback localhost:8000"),oe=!0,te}catch(a){throw console.error("❌ Fallback también falló:",a),new Error("No se pudo conectar con el backend para el reproductor.")}}})(),ne),ie=async()=>(oe||await le(),te),se={list:async(e=0,a=100)=>{const t=await ie();return t.get(`/playlists/public?skip=${e}&limit=${a}`)},listPlaylists:async(e=0,a=100)=>{const t=await ie();return t.get(`/playlists/public?skip=${e}&limit=${a}`)},getPlaylist:async e=>{const a=await ie();return a.get(`/playlists/${e}/player`)},getPlaylistInfo:async e=>{const a=await ie();return a.get(`/playlists/${e}`)}},re=async e=>{if(!e)return"";try{const a=(0,ae.w)();let t;if(a)t=a.baseUrl;else{const e=await ee.A.detectBackend();t=e.baseUrl}if(e.file_url)return`${t}${e.file_url}`;let o=e.filepath||e.served_filename||e.filename;return o.startsWith("/uploads/")||(o=`/uploads/${o}`),`${t}${o}`}catch(a){console.error("Error construyendo URL de media:",a);const t=e.file_url||`/uploads/${e.served_filename||e.filename}`;return`http://127.0.0.1:8000${t}`}};var ce=t(246),de=t(697),ue=t(725);class me{constructor(){this.socket=null,this.connected=!1,this.listeners=new Map,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.detectedBackendUrl=null}async getWebSocketUrl(){try{let e=this.detectedBackendUrl;if(!e){const{baseUrl:a}=await ee.A.detectBackend();this.detectedBackendUrl=a,e=a}const a=e.replace("http://","ws://")+"/ws";return console.log(`🎯 URL WebSocket generada: ${a}`),a}catch(e){return console.error("❌ Error obteniendo URL del WebSocket:",e),"ws://127.0.0.1:8002/ws"}}async connect(e=null){try{e||(e=await this.getWebSocketUrl()),console.log(`🔌 Conectando WebSocket a: ${e}`),this.socket=new WebSocket(e),this.socket.onopen=()=>{console.log("✅ WebSocket conectado"),this.connected=!0,this.reconnectAttempts=0,this.emit("connection-status",{connected:!0})},this.socket.onclose=a=>{console.log("❌ WebSocket desconectado:",a.code,a.reason),this.connected=!1,this.emit("connection-status",{connected:!1,reason:a.reason}),this.reconnectAttempts<this.maxReconnectAttempts&&(this.reconnectAttempts++,console.log(`🔄 Intentando reconectar (${this.reconnectAttempts}/${this.maxReconnectAttempts})...`),setTimeout((()=>this.connect(e)),this.reconnectDelay*this.reconnectAttempts))},this.socket.onerror=e=>{console.error("❌ Error de conexión WebSocket:",e),this.emit("connection-error",e)},this.socket.onmessage=e=>{try{const a=JSON.parse(e.data);a.event&&a.data&&this.emit(a.event,a.data)}catch(a){console.error("Error parseando mensaje WebSocket:",a)}}}catch(a){console.error("Error inicializando WebSocket:",a)}}disconnect(){this.socket&&(this.socket.close(),this.socket=null,this.connected=!1,this.listeners.clear(),console.log("🔌 WebSocket desconectado manualmente"))}send(e,a){if(this.socket&&this.connected){const t=JSON.stringify({event:e,data:a});this.socket.send(t)}else console.warn("⚠️ WebSocket no conectado, no se puede enviar:",e)}on(e,a){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(a)}off(e,a){if(this.listeners.has(e)){const t=this.listeners.get(e),o=t.indexOf(a);o>-1&&t.splice(o,1)}}emit(e,a){this.listeners.has(e)&&this.listeners.get(e).forEach((t=>{try{t(a)}catch(o){console.error(`Error en listener para evento ${e}:`,o)}}))}notifyUploadStart(e){this.send("media-upload-start",e)}requestPlaybackStatus(){this.send("get-playback-status")}sendPlayerCommand(e,a={}){this.send("player-command",{command:e,...a})}notifyScheduleChange(e){this.send("schedule-change",e)}requestSystemStats(){this.send("get-system-stats")}}const pe=new me,ge=()=>{pe.connect()},ve=()=>{pe.disconnect()},he=()=>pe.connected,fe=()=>({connect:ge,disconnect:ve,isConnected:he,on:(e,a)=>pe.on(e,a),off:(e,a)=>pe.off(e,a),send:(e,a)=>pe.send(e,a),notifyUploadStart:e=>pe.notifyUploadStart(e),requestPlaybackStatus:()=>pe.requestPlaybackStatus(),sendPlayerCommand:(e,a)=>pe.sendPlayerCommand(e,a),notifyScheduleChange:e=>pe.notifyScheduleChange(e),requestSystemStats:()=>pe.requestSystemStats()});var ke=t(891),ye={name:"PlayerView",components:{ThemeToggle:de.A},setup(){const e=(0,Z.rd)(),a=(0,ce.dj)(),{isDarkMode:t}=(0,ue.D)(),{backendBaseUrl:n,buildMediaUrl:l}=(0,ke.f)(),i=(0,J.KR)(null),s=(0,J.KR)(!1),r=(0,J.KR)([]),c=(0,J.KR)(null),d=(0,J.KR)([]),u=(0,J.KR)(null),m=(0,J.KR)(0),p=(0,J.KR)(!1),g=(0,J.KR)(!1),v=(0,J.KR)(0),h=(0,J.KR)(null),f=(0,J.KR)("");let k=null,y=null,b=null;const L=(0,o.EW)((()=>{if(!u.value)return 0;const e=T();return e>0?v.value/e:0})),_=(0,o.EW)((()=>f.value||"")),{connect:C,disconnect:F,on:w,off:E}=fe(),S=async({id:e})=>{c.value&&(await D(c.value.id),a.info("Se añadió un nuevo medio a la playlist"))},P=async({playlist_id:e,action:t,media_id:o})=>{if(!c.value||c.value.id!==e)return;console.log(`Playlist actualizada: ${t}`);const n=d.value.length;await D(e);const l=d.value.length;switch("media_removed"===t&&l<n&&m.value>=l&&l>0&&(m.value=0,q()),t){case"media_added":a.info("Se añadió un medio a la playlist activa");break;case"media_removed":a.warning("Se removió un medio de la playlist activa");break;case"playlist_modified":a.info("La playlist activa fue modificada");break}},M=()=>{try{C(),w("media_created",S),w("playlist_updated",P),console.log("WebSocket conectado exitosamente")}catch(e){console.warn("WebSocket no disponible, continuando sin actualizaciones automáticas:",e)}},A=()=>{try{E("media_created",S),E("playlist_updated",P),F(),console.log("WebSocket desconectado exitosamente")}catch(e){console.warn("Error al desconectar WebSocket:",e)}},I=e=>{const a=Math.floor(e/60),t=Math.floor(e%60);return`${a}:${t.toString().padStart(2,"0")}`},$=e=>{if(!e)return"0:00";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),o=e%60;return a>0?`${a}:${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${t}:${o.toString().padStart(2,"0")}`},T=()=>u.value?u.value.effective_duration||u.value.duration||5:0,x=async()=>{s.value=!0;try{console.log("Intentando cargar playlists...");const e=await se.listPlaylists();r.value=e.data||[],console.log("Playlists cargadas exitosamente:",r.value)}catch(t){console.error("Error fetching playlists:",t),401===t.response?.status?(a.error("Sesión expirada. Redirigiendo al login..."),localStorage.removeItem("signance_token"),e.push("/login")):a.error("Error al cargar las playlists")}finally{s.value=!1}},D=async e=>{try{console.log("Cargando medios de playlist:",e);const t=await se.getPlaylist(e),o=t.data||{},n=o.medias||[];if(!Array.isArray(n))return console.error("La respuesta no contiene un array de medias:",o),d.value=[],void a.error("Error: formato de datos incorrecto");d.value=n.map((e=>({...e,effective_duration:e.duration,url:e.file_url}))),console.log("Medios de playlist cargados:",{count:d.value.length,playlist_name:o.name,items:n.map((e=>({id:e.id,filename:e.filename,duration:e.duration,file_url:e.file_url})))}),d.value.length>0?(m.value=0,q()):(console.warn("No se encontraron medios en la playlist"),a.warning("Esta playlist no contiene medios"))}catch(t){console.error("Error loading playlist media:",t),d.value=[],a.error("Error al cargar los medios de la playlist")}},q=()=>{if(d.value.length>0){const e=d.value[m.value];u.value=e,v.value=0,f.value="",re(e).then((a=>{u.value===e&&(f.value=a,console.log("Medio actual cargado:",{index:m.value,filename:e.filename,media_type:e.media_type,filepath:e.filepath,duration:e.duration,effective_duration:e.effective_duration,url:a}))})).catch((t=>{console.error("Error construyendo URL del media:",t),u.value===e&&(f.value="",a.error(`Error preparando medio: ${e.filename}`))}))}else console.warn("No hay medios disponibles para cargar"),u.value=null,f.value=""},z=async e=>{c.value=e,await D(e.id),d.value.length>0?(B(),a.success(`Reproduciendo: ${e.name}`)):a.warning("Esta playlist no tiene medios para reproducir")},B=()=>{p.value=!0,R(),G(),j()},R=()=>{if(!u.value)return;const e=T();console.log(`Programando cambio de medio en ${e} segundos`),clearTimeout(k),k=setTimeout((()=>{p.value&&U()}),1e3*e)},U=()=>{0!==d.value.length&&(m.value=(m.value+1)%d.value.length,q(),p.value&&R())},V=()=>{0!==d.value.length&&(m.value=0===m.value?d.value.length-1:m.value-1,q(),p.value&&R())},N=()=>{p.value?X():W()},X=()=>{p.value=!1,clearTimeout(k),clearInterval(b),"video"===u.value?.media_type&&i.value&&i.value.pause(),a.info("Reproducción pausada")},W=()=>{p.value=!0,R(),G(),"video"===u.value?.media_type&&i.value&&i.value.play(),a.info("Reproducción reanudada")},K=()=>{p.value=!1,clearTimeout(k),clearInterval(b),clearInterval(y),c.value=null,u.value=null,d.value=[],h.value=null,v.value=0,a.info("Reproducción detenida")},O=()=>{U(),p.value&&R()},Q=()=>{V(),p.value&&R()},j=()=>{console.log("Schedule check temporalmente deshabilitado")},G=()=>{clearInterval(b),b=setInterval((()=>{p.value&&u.value&&(v.value+=.1,"video"===u.value.media_type&&i.value&&i.value.ended&&H())}),100)},H=()=>{console.log("Medio terminado, avanzando al siguiente"),U()},Y=()=>{console.log("Medio cargado exitosamente:",u.value?.filename)},ae=e=>{console.error("Error de medio:",{error:e,media:u.value,url:f.value}),a.error(`Error al cargar: ${u.value?.filename||"medio desconocido"}`),setTimeout((()=>{d.value.length>1?(console.log("Saltando al siguiente medio debido a error"),U()):(console.log("No hay más medios disponibles"),a.warning("No hay más medios disponibles en la playlist"))}),2e3)},te=()=>{g.value=!g.value},oe=(0,J.KR)(!1),ne=(0,J.KR)(!1),le=(0,J.KR)(null);let ie=null;const de=()=>{oe.value=!!document.fullscreenElement,console.log("Initialized fullscreen state:",oe.value)},me=async()=>{try{if(document.fullscreenElement)await document.exitFullscreen(),oe.value=!1,a.info("Modo pantalla completa desactivado");else{const e=document.querySelector(".player-state");e?await e.requestFullscreen():await document.documentElement.requestFullscreen(),oe.value=!0,a.info("Modo pantalla completa activado")}}catch(e){console.error("Error toggle fullscreen:",e),a.error("Error al cambiar modo de pantalla")}},pe=()=>{const e=oe.value;oe.value=!!document.fullscreenElement,console.log("Fullscreen state changed:",{wasFullscreen:e,nowFullscreen:oe.value,element:document.fullscreenElement}),oe.value||(ne.value=!1,ie&&(clearTimeout(ie),ie=null))},ge=()=>{oe.value&&(ne.value=!0,document.body.style.cursor="default",ie&&clearTimeout(ie),ie=setTimeout((()=>{ne.value=!1,oe.value&&(document.body.style.cursor="none")}),3e3))},ve=()=>{h.value=null},he=()=>{e.push("/admin")},ye=async()=>{try{console.log("🔍 Intentando cargar logo del negocio...");const a=ee.A.getCachedBackend();if(!a)return void console.log("❌ No hay backend detectado");console.log("📡 Backend detectado:",a.baseUrl);const t=`${a.baseUrl}/api/business/logo`;console.log("🖼️ Intentando cargar logo desde:",t);try{const e=await fetch(t,{method:"GET"});if(console.log("📥 Respuesta del logo:",e.status,e.statusText),e.ok){const a=await e.json();console.log("📄 Datos recibidos:",a.logo?"Logo base64 presente":"Sin logo"),a.logo?(le.value=`data:image/png;base64,${a.logo}`,console.log("✅ Logo cargado exitosamente como data URL")):(console.log("❌ No hay datos de logo en la respuesta"),le.value=null)}else 404===e.status?(console.log("📄 No hay logo configurado (404)"),le.value=null):(console.log("❌ Error cargando logo:",e.status,e.statusText),le.value=null)}catch(e){console.log("❌ Error de red cargando logo:",e),le.value=null}}catch(a){console.log("❌ Error general cargando logo:",a),le.value=null}},be=()=>{K(),e.push("/")};return(0,o.sV)((()=>{console.log("PlayerView mounted, initial fullscreen state:",oe.value),de(),x(),ye(),document.addEventListener("fullscreenchange",pe),M()})),(0,o.hi)((()=>{clearTimeout(k),clearInterval(b),clearInterval(y),ie&&clearTimeout(ie),document.removeEventListener("fullscreenchange",pe),A()})),{loading:s,playlists:r,selectedPlaylist:c,playlistMedia:d,currentMedia:u,currentMediaIndex:m,isPlaying:p,showInfo:g,elapsedTime:v,scheduleOverride:h,progress:L,currentMediaSrc:_,videoPlayer:i,isFullscreen:oe,showFullscreenControls:ne,businessLogo:le,fetchPlaylists:x,selectPlaylist:z,togglePlayPause:N,skipToNext:O,skipToPrevious:Q,stopPlayback:K,toggleInfo:te,toggleFullscreen:me,dismissScheduleNotification:ve,goToAdmin:he,goBack:be,onMediaEnded:H,onMediaLoaded:Y,handleMediaError:ae,formatTime:I,formatTotalDuration:$,getCurrentDuration:T,initializeFullscreenState:de,onMouseMoveFullscreen:ge,isDarkMode:t}}},be=t(262);const Le=(0,be.A)(ye,[["render",H],["__scopeId","data-v-6bf7c1d2"]]);var _e=Le},661:function(e,a,t){"use strict";t.d(a,{A:function(){return T}});var o=t(641),n=t(33),l=t(751);const i={class:"media-uploader"},s={key:0,class:"upload-prompt"},r={class:"upload-icon"},c={class:"supported-formats"},d={key:1,class:"file-selected"},u={class:"file-preview"},m={key:0,class:"image-preview"},p=["src","alt"],g={key:1,class:"file-icon"},v={class:"file-details"},h={class:"file-meta"},f={class:"file-size"},k={key:2,class:"upload-progress"},y={class:"progress-circle"},b={class:"progress-text"},L={key:0,class:"metadata-form"},_={class:"form-section"},C={class:"form-grid"},F={class:"form-actions"},w={key:1,class:"success-message"};function E(e,a,t,E,S,P){const M=(0,o.g2)("q-icon"),A=(0,o.g2)("q-chip"),I=(0,o.g2)("q-btn"),$=(0,o.g2)("q-circular-progress"),T=(0,o.g2)("q-input"),x=(0,o.g2)("q-select");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",{class:(0,n.C4)(["upload-zone",{"drag-over":E.isDragOver,"has-file":E.selectedFile,uploading:E.isUploading}]),onDragover:a[1]||(a[1]=(0,l.D$)(((...e)=>E.handleDragOver&&E.handleDragOver(...e)),["prevent"])),onDragleave:a[2]||(a[2]=(0,l.D$)(((...e)=>E.handleDragLeave&&E.handleDragLeave(...e)),["prevent"])),onDrop:a[3]||(a[3]=(0,l.D$)(((...e)=>E.handleDrop&&E.handleDrop(...e)),["prevent"])),onClick:a[4]||(a[4]=(...e)=>E.triggerFileSelect&&E.triggerFileSelect(...e))},[(0,o.Lk)("input",{ref:"fileInput",type:"file",accept:"image/*,video/*",onChange:a[0]||(a[0]=(...e)=>E.handleFileSelect&&E.handleFileSelect(...e)),class:"hidden-input"},null,544),E.selectedFile||E.isUploading?E.selectedFile&&!E.isUploading?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("div",u,[E.previewUrl&&"image"===E.metadata.media_type?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("img",{src:E.previewUrl,alt:E.selectedFile.name},null,8,p)])):((0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(M,{name:E.getFileIcon(E.selectedFile.type),size:"3rem"},null,8,["name"])]))]),(0,o.Lk)("div",v,[(0,o.Lk)("h4",null,(0,n.v_)(E.selectedFile.name),1),(0,o.Lk)("div",h,[(0,o.bF)(A,{size:"sm",color:E.getTypeColor(E.metadata.media_type),"text-color":"white"},{default:(0,o.k6)((()=>[(0,o.eW)((0,n.v_)(E.metadata.media_type?.toUpperCase()||"ARCHIVO"),1)])),_:1},8,["color"]),(0,o.Lk)("span",f,(0,n.v_)(E.formatFileSize(E.selectedFile.size)),1)])]),(0,o.bF)(I,{round:"",flat:"",icon:"close",onClick:(0,l.D$)(E.resetForm,["stop"]),class:"remove-file",size:"sm"},null,8,["onClick"])])):E.isUploading?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("div",y,[(0,o.bF)($,{value:E.uploadProgress.percent,size:"60px",thickness:.2,color:"primary","track-color":"grey-3",class:"q-ma-md"},null,8,["value"]),(0,o.Lk)("div",b,(0,n.v_)(Math.round(E.uploadProgress.percent))+"% ",1)]),(0,o.Lk)("h4",null,(0,n.v_)(E.uploadProgress.message),1),(0,o.Lk)("p",null,(0,n.v_)(E.selectedFile?.name),1)])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("div",r,[(0,o.bF)(M,{name:"cloud_upload",size:"3rem"})]),a[12]||(a[12]=(0,o.Lk)("h4",null,"Arrastra archivos aquí",-1)),a[13]||(a[13]=(0,o.Lk)("p",null,"o haz clic para seleccionar",-1)),(0,o.Lk)("div",c,[(0,o.bF)(A,{size:"sm",color:"primary","text-color":"white"},{default:(0,o.k6)((()=>a[8]||(a[8]=[(0,o.eW)("JPG")]))),_:1,__:[8]}),(0,o.bF)(A,{size:"sm",color:"primary","text-color":"white"},{default:(0,o.k6)((()=>a[9]||(a[9]=[(0,o.eW)("PNG")]))),_:1,__:[9]}),(0,o.bF)(A,{size:"sm",color:"secondary","text-color":"white"},{default:(0,o.k6)((()=>a[10]||(a[10]=[(0,o.eW)("MP4")]))),_:1,__:[10]}),(0,o.bF)(A,{size:"sm",color:"secondary","text-color":"white"},{default:(0,o.k6)((()=>a[11]||(a[11]=[(0,o.eW)("WebM")]))),_:1,__:[11]})]),a[14]||(a[14]=(0,o.Lk)("div",{class:"size-limit"},"Máximo 100MB",-1))]))],34),E.selectedFile&&!E.isUploading?((0,o.uX)(),(0,o.CE)("div",L,[(0,o.Lk)("div",_,[a[15]||(a[15]=(0,o.Lk)("h5",null,"Detalles del archivo",-1)),(0,o.Lk)("div",C,[(0,o.bF)(T,{modelValue:E.metadata.filename,"onUpdate:modelValue":a[5]||(a[5]=e=>E.metadata.filename=e),label:"Nombre del archivo",outlined:"",class:"filename-input",rules:[e=>!!e||"El nombre es requerido"]},{prepend:(0,o.k6)((()=>[(0,o.bF)(M,{name:"edit"})])),_:1},8,["modelValue","rules"]),(0,o.bF)(x,{modelValue:E.metadata.media_type,"onUpdate:modelValue":a[6]||(a[6]=e=>E.metadata.media_type=e),options:E.mediaTypeOptions,label:"Tipo de contenido",outlined:"","emit-value":"","map-options":"",rules:[e=>!!e||"Selecciona el tipo"]},{prepend:(0,o.k6)((()=>[(0,o.bF)(M,{name:"category"})])),_:1},8,["modelValue","options","rules"]),(0,o.bF)(T,{modelValue:E.metadata.duration,"onUpdate:modelValue":a[7]||(a[7]=e=>E.metadata.duration=e),modelModifiers:{number:!0},label:"Duración (segundos)",type:"number",outlined:"",hint:"image"===E.metadata.media_type?"Para imágenes: tiempo de visualización":"Se detectará automáticamente para videos"},{prepend:(0,o.k6)((()=>[(0,o.bF)(M,{name:"schedule"})])),_:1},8,["modelValue","hint"])])]),(0,o.Lk)("div",F,[(0,o.bF)(I,{label:"Cancelar",color:"grey-7",flat:"",onClick:E.resetForm,disable:E.isUploading,class:"cancel-btn"},null,8,["onClick","disable"]),(0,o.bF)(I,{label:"Subir archivo",color:"primary",unelevated:"",onClick:E.uploadFile,loading:E.isUploading,disable:!E.isFormValid,class:"upload-btn"},{loading:(0,o.k6)((()=>a[16]||(a[16]=[(0,o.eW)(" Subiendo... ")]))),_:1},8,["onClick","loading","disable"])])])):(0,o.Q3)("",!0),E.uploadSuccess?((0,o.uX)(),(0,o.CE)("div",w,[(0,o.bF)(M,{name:"check_circle",size:"2rem",color:"positive"}),a[17]||(a[17]=(0,o.Lk)("h4",null,"¡Archivo subido correctamente!",-1)),(0,o.Lk)("p",null,(0,n.v_)(E.uploadedFileName)+" está listo para usar",1)])):(0,o.Q3)("",!0)])}var S=t(953),P=t(246),M=t(889),A={name:"MediaUploader",emits:["upload-complete","upload-error","uploaded"],setup(e,{emit:a}){const t=(0,P.dj)(),n=(0,S.KR)(null),l=(0,S.KR)(null),i=(0,S.KR)(!1),s=(0,S.KR)(!1),r=(0,S.KR)(null),c=(0,S.KR)(!1),d=(0,S.KR)(""),u=(0,S.Kh)({filename:"",media_type:"",duration:5}),m=(0,S.Kh)({show:!1,percent:0,message:""}),p=[{label:"Imagen",value:"image"},{label:"Video",value:"video"}],g=(0,o.EW)((()=>l.value&&u.filename.trim()&&u.media_type&&u.duration>0)),v=()=>{i.value||n.value?.click()},h=e=>{const a=e.target.files?.[0]||e;a&&a instanceof File&&f(a)},f=e=>{e.size>104857600?t.error("El archivo es demasiado grande. Máximo 100MB."):e.type.startsWith("image/")||e.type.startsWith("video/")?(l.value=e,u.filename=e.name.replace(/\.[^/.]+$/,""),e.type.startsWith("image/")?(u.media_type="image",u.duration=5,k(e)):e.type.startsWith("video/")&&(u.media_type="video",u.duration=30,r.value=null),c.value=!1):t.error("Tipo de archivo no soportado. Solo imágenes y videos.")},k=e=>{const a=new FileReader;a.onload=e=>{r.value=e.target.result},a.readAsDataURL(e)},y=e=>{e.preventDefault(),s.value=!0},b=e=>{e.preventDefault(),s.value=!1},L=e=>{e.preventDefault(),s.value=!1;const a=e.dataTransfer.files;a.length>0&&f(a[0])},_=e=>e?e.startsWith("image/")?"image":e.startsWith("video/")?"videocam":"description":"description",C=e=>{switch(e){case"image":return"orange";case"video":return"purple";default:return"grey"}},F=e=>{if(0===e)return"0 Bytes";const a=1024,t=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,o)).toFixed(2))+" "+t[o]},w=async()=>{if(g.value){i.value=!0,m.show=!0,m.percent=0,m.message="Preparando subida...";try{const e=setInterval((()=>{m.percent<85&&(m.percent+=15*Math.random(),m.percent<30?m.message="Analizando archivo...":m.percent<60?m.message="Subiendo archivo...":m.message="Procesando multimedia...")}),300),o={file:l.value,filename:u.filename,media_type:u.media_type,duration:u.duration},n=await M.DX.upload(o);clearInterval(e),m.percent=100,m.message="¡Completado!",d.value=u.filename,c.value=!0,t.success(`✅ ${u.filename} subido correctamente`),a("upload-complete",n.data),a("uploaded",n.data),setTimeout((()=>{E()}),3e3)}catch(e){console.error("Error subiendo archivo:",e),(0,M.vH)(e,t),a("upload-error",e),m.message="Error en la subida"}finally{i.value=!1,setTimeout((()=>{m.show=!1}),2e3)}}else t.warning("Completa todos los campos requeridos")},E=()=>{l.value=null,u.filename="",u.media_type="",u.duration=5,r.value=null,m.show=!1,m.percent=0,c.value=!1,d.value="",s.value=!1,n.value&&(n.value.value="")};return{fileInput:n,selectedFile:l,metadata:u,isUploading:i,isDragOver:s,previewUrl:r,uploadProgress:m,uploadSuccess:c,uploadedFileName:d,isFormValid:g,mediaTypeOptions:p,triggerFileSelect:v,handleFileSelect:h,handleDragOver:y,handleDragLeave:b,handleDrop:L,getFileIcon:_,getTypeColor:C,formatFileSize:F,uploadFile:w,resetForm:E}}},I=t(262);const $=(0,I.A)(A,[["render",E],["__scopeId","data-v-65b3c1cc"]]);var T=$},680:function(e,a,t){"use strict";function o(){const e=window.location.origin,a=window.location.pathname.startsWith("/")&&!window.location.hostname.includes("localhost:8080");return console.log("🔍 Detectando contexto del frontend..."),console.log(`   📍 Origin: ${e}`),console.log(`   🌐 Hostname: ${window.location.hostname}`),console.log(`   📂 Pathname: ${window.location.pathname}`),console.log(`   🔗 Servido desde backend: ${a}`),a?(console.log("✅ Frontend servido desde backend, usando mismo origen"),{baseUrl:e,port:parseInt(window.location.port)||("https:"===window.location.protocol?443:80),isProduction:!0}):(console.log("🔧 Modo desarrollo detectado, usando auto-detección"),null)}t.d(a,{w:function(){return o}})},697:function(e,a,t){"use strict";t.d(a,{A:function(){return d}});var o=t(641),n=t(33);function l(e,a,t,l,i,s){const r=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.Wv)(r,{icon:l.isDarkMode?"wb_sunny":"nights_stay",onClick:l.toggleTheme,class:(0,n.C4)(l.themeToggleClass),flat:"",square:"",size:"md"},null,8,["icon","onClick","class"])}var i=t(725),s={name:"ThemeToggle",setup(){const{isDarkMode:e,toggleTheme:a}=(0,i.D)(),t=(0,o.EW)((()=>({"theme-toggle":!0,"theme-toggle--dark":e.value,"theme-toggle--light":!e.value})));return{isDarkMode:e,toggleTheme:a,themeToggleClass:t}}},r=t(262);const c=(0,r.A)(s,[["render",l],["__scopeId","data-v-410b47f5"]]);var d=c},714:function(e,a,t){"use strict";t.d(a,{A:function(){return r}});var o=t(641),n=t(33);const l={class:"text-h6"};var i={__name:"EditMediaDialog",props:{modelValue:Boolean,media:Object,form:Object,loading:Boolean,isDark:Boolean},emits:["update:modelValue","save","close"],setup(e){return(a,t)=>{const i=(0,o.g2)("q-card-section"),s=(0,o.g2)("q-input"),r=(0,o.g2)("q-btn"),c=(0,o.g2)("q-card-actions"),d=(0,o.g2)("q-card"),u=(0,o.g2)("q-dialog");return(0,o.uX)(),(0,o.Wv)(u,{"model-value":e.modelValue,"onUpdate:modelValue":t[4]||(t[4]=e=>a.$emit("update:modelValue",e)),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(d,{style:{"min-width":"800px","max-width":"1000px"},class:(0,n.C4)({"bg-dark text-white":e.isDark})},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",l,"Gestionar Medio - "+(0,n.v_)(e.media?.filename),1)])),_:1}),(0,o.bF)(i,{class:"q-pt-none"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{modelValue:e.form.filename,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.filename=a),label:"Nombre del archivo",outlined:"",class:"q-mb-md"},null,8,["modelValue"]),(0,o.bF)(s,{modelValue:e.form.description,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.description=a),label:"Descripción",type:"textarea",outlined:"",rows:"3"},null,8,["modelValue"])])),_:1}),(0,o.bF)(c,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{flat:"",label:"Cancelar",onClick:t[2]||(t[2]=e=>a.$emit("close"))}),(0,o.bF)(r,{color:"primary",label:"Guardar",loading:e.loading,onClick:t[3]||(t[3]=e=>a.$emit("save"))},null,8,["loading"])])),_:1})])),_:1},8,["class"])])),_:1},8,["model-value"])}}};const s=i;var r=s},725:function(e,a,t){"use strict";t.d(a,{D:function(){return m}});var o=t(953),n=t(641);const l=(0,o.KR)(!1),i=localStorage.getItem("signance-theme");l.value=i?"dark"===i:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;const s=e=>{const a=document.documentElement;e?(a.style.setProperty("--primary","#FFAA93"),a.style.setProperty("--primary-dark","#CC7A66"),a.style.setProperty("--primary-light","#FFCCB3"),a.style.setProperty("--secondary","#5A9DCB"),a.style.setProperty("--accent","#D1B05F"),a.style.setProperty("--background","#121212"),a.style.setProperty("--surface","#1E1E1E"),a.style.setProperty("--on-primary","#000000"),a.style.setProperty("--on-secondary","#FFFFFF"),a.style.setProperty("--text-primary","#E0E0E0"),a.style.setProperty("--text-secondary","#B0B0B0"),a.style.setProperty("--border","#2C2C2C"),a.style.setProperty("--error","#FF6F6F"),a.style.setProperty("--success","#66BB6A"),a.style.setProperty("--warning","#FFA726"),a.style.setProperty("--info","#42A5F5")):(a.style.setProperty("--primary","#F0907B"),a.style.setProperty("--primary-dark","#D66E58"),a.style.setProperty("--primary-light","#FAC3B8"),a.style.setProperty("--secondary","#7BC5F0"),a.style.setProperty("--accent","#F0D27B"),a.style.setProperty("--background","#FFFFFF"),a.style.setProperty("--surface","#F5F5F5"),a.style.setProperty("--on-primary","#FFFFFF"),a.style.setProperty("--on-secondary","#FFFFFF"),a.style.setProperty("--text-primary","#212121"),a.style.setProperty("--text-secondary","#424242"),a.style.setProperty("--border","#E0E0E0"),a.style.setProperty("--error","#E53935"),a.style.setProperty("--success","#43A047"),a.style.setProperty("--warning","#FB8C00"),a.style.setProperty("--info","#1E88E5"))},r=e=>{s(e),e?(document.documentElement.setAttribute("data-theme","dark"),document.body.style.backgroundColor="#121212",document.body.style.color="#E0E0E0",document.body.classList.add("dark-mode"),document.body.classList.remove("light-mode")):(document.documentElement.removeAttribute("data-theme"),document.body.style.backgroundColor="#FFFFFF",document.body.style.color="#212121",document.body.classList.add("light-mode"),document.body.classList.remove("dark-mode"))};r(l.value),(0,n.wB)(l,(e=>{localStorage.setItem("signance-theme",e?"dark":"light"),r(e)}));const c=(0,n.EW)((()=>({primaryColor:l.value?"#FFAA93":"#F0907B",primaryDark:l.value?"#CC7A66":"#D66E58",primaryLight:l.value?"#FFCCB3":"#FAC3B8",secondaryColor:l.value?"#5A9DCB":"#7BC5F0",accentColor:l.value?"#D1B05F":"#F0D27B",errorColor:l.value?"#FF6F6F":"#E53935",successColor:l.value?"#66BB6A":"#43A047",warningColor:l.value?"#FFA726":"#FB8C00",infoColor:l.value?"#42A5F5":"#1E88E5",backgroundColor:l.value?"#121212":"#FFFFFF",surfaceColor:l.value?"#1E1E1E":"#F5F5F5",cardColor:l.value?"#1E1E1E":"#FFFFFF",textPrimary:l.value?"#E0E0E0":"#212121",textSecondary:l.value?"#B0B0B0":"#424242",onPrimary:l.value?"#000000":"#FFFFFF",onSecondary:(l.value,"#FFFFFF"),borderColor:l.value?"#2C2C2C":"#E0E0E0",gradientPrimary:l.value?"linear-gradient(135deg, #FFAA93 0%, #CC7A66 100%)":"linear-gradient(135deg, #F0907B 0%, #D66E58 100%)",gradientSecondary:l.value?"linear-gradient(135deg, #5A9DCB 0%, #42A5F5 100%)":"linear-gradient(135deg, #7BC5F0 0%, #1E88E5 100%)",gradientAccent:l.value?"linear-gradient(135deg, #D1B05F 0%, #FFA726 100%)":"linear-gradient(135deg, #F0D27B 0%, #FB8C00 100%)",shadowSm:l.value?"0 1px 3px 0 rgba(0, 0, 0, 0.5)":"0 1px 3px 0 rgba(0, 0, 0, 0.1)",shadowMd:l.value?"0 4px 6px -1px rgba(0, 0, 0, 0.4)":"0 4px 6px -1px rgba(0, 0, 0, 0.1)",shadowLg:l.value?"0 10px 15px -3px rgba(0, 0, 0, 0.4)":"0 10px 15px -3px rgba(0, 0, 0, 0.1)",shadowXl:l.value?"0 20px 25px -5px rgba(0, 0, 0, 0.5)":"0 20px 25px -5px rgba(0, 0, 0, 0.1)",hoverColor:l.value?"#2C2C2C":"#F5F5F5",hoverPrimary:l.value?"rgba(255, 170, 147, 0.1)":"rgba(240, 144, 123, 0.1)",hoverSecondary:l.value?"rgba(90, 157, 203, 0.1)":"rgba(123, 197, 240, 0.1)"}))),d=()=>{l.value=!l.value},u=()=>{r(l.value)};function m(){return{isDarkMode:l,toggleTheme:d,loadTheme:u,themeVars:c}}},880:function(e,a,t){"use strict";function o(){console.log("🎨 Inicializando Material Icons..."),n(),l(),setTimeout(i,1e3)}function n(){const e=document.querySelector('link[href*="fonts.googleapis.com"][href*="Material+Icons"]');if(!e){console.log("📥 Cargando Material Icons desde Google Fonts...");const e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/icon?family=Material+Icons&display=swap",e.onload=()=>{console.log("✅ Material Icons cargado desde Google Fonts")},e.onerror=()=>{console.error("❌ Error al cargar Material Icons desde Google Fonts")},document.head.appendChild(e)}}function l(){console.log("🎨 Aplicando CSS correctivo para iconos...");const e="\n    /* Corrección global para Material Icons sin interferir con tamaños */\n    .material-icons {\n      font-family: 'Material Icons' !important;\n      font-weight: normal !important;\n      font-style: normal !important;\n      line-height: 1 !important;\n      letter-spacing: normal !important;\n      text-transform: none !important;\n      display: inline-block !important;\n      white-space: nowrap !important;\n      word-wrap: normal !important;\n      direction: ltr !important;\n      font-feature-settings: 'liga' !important;\n      -webkit-font-feature-settings: 'liga' !important;\n      -webkit-font-smoothing: antialiased !important;\n      -moz-osx-font-smoothing: grayscale !important;\n    }\n    \n    /* Corrección específica para Quasar Icons - mantener tamaños */\n    .q-icon {\n      font-family: 'Material Icons' !important;\n      font-feature-settings: 'liga' !important;\n      -webkit-font-feature-settings: 'liga' !important;\n      /* NO sobrescribir font-size, width, height - dejar que Quasar los maneje */\n    }\n    \n    /* Corrección para iconos que aparecen como texto */\n    .q-icon:not(.q-icon--svg) {\n      font-family: 'Material Icons' !important;\n    }\n  ",a=document.createElement("style");a.id="material-icons-fix",a.textContent=e,document.head.appendChild(a)}function i(){console.log("🔍 Verificando carga de iconos...");const e=document.createElement("i");e.className="material-icons",e.textContent="home",e.style.position="absolute",e.style.left="-9999px",e.style.fontSize="24px",document.body.appendChild(e),setTimeout((()=>{const a=e.getBoundingClientRect(),t=window.getComputedStyle(e);console.log("📊 Resultados de verificación:",{width:a.width,height:a.height,fontFamily:t.fontFamily,fontSize:t.fontSize,rendered:a.width>0&&a.height>0}),a.width>0&&a.height>0?console.log("✅ Material Icons cargado correctamente"):(console.warn("⚠️ Material Icons puede no estar cargando correctamente"),s()),document.body.removeChild(e)}),100)}function s(){console.log("🔧 Aplicando corrección forzada de iconos...");const e=document.querySelectorAll(".q-icon");e.forEach(((e,a)=>{if(e.style.fontFamily='"Material Icons" !important',e.textContent&&e.textContent.length>0){console.warn("Icono "+a+' contiene texto: "'+e.textContent+'"');const t=e.textContent;e.innerHTML='<i class="material-icons">'+t+"</i>"}}))}function r(e){const a=document.createElement("i");return a.className="material-icons",a.textContent=e,a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a),new Promise((e=>{setTimeout((()=>{const t=a.getBoundingClientRect(),o=t.width>0&&t.height>0;document.body.removeChild(a),e(o)}),100)}))}function c(){return{fontsAPI:{available:!!document.fonts,size:document.fonts?document.fonts.size:"N/A",materialIconsCheck:document.fonts?document.fonts.check('1rem "Material Icons"'):"N/A"},stylesheets:Array.from(document.styleSheets).map((e=>{try{return{href:e.href,rules:e.cssRules?e.cssRules.length:"N/A"}}catch(a){return{href:e.href,error:"CORS restriction"}}})),materialIconsLinks:Array.from(document.querySelectorAll('link[href*="material-icons"], link[href*="Material+Icons"]')).map((e=>e.href))}}t.d(a,{HF:function(){return r},Yp:function(){return o},ZS:function(){return c}})},889:function(e,a,t){"use strict";t.d(a,{DX:function(){return v},R2:function(){return g},X3:function(){return d},ZK:function(){return h},fP:function(){return k},gr:function(){return f},vH:function(){return y}});var o=t(335),n=t(246),l=t(349),i=t(680);let s=o.A.create({baseURL:"",timeout:15e3,headers:{"Content-Type":"application/json"}}),r=!1,c=null;const d=async()=>r?s:c||(c=(async()=>{try{console.log("🚀 Inicializando API con detección mejorada...");const a=(0,i.w)();if(a)return console.log("🎯 Modo producción detectado, usando mismo origen"),s.defaults.baseURL=`${a.baseUrl}/api`,console.log("🧪 Probando conectividad en modo producción..."),await s.get("/health",{timeout:5e3}),r=!0,console.log(`✅ API inicializada en modo producción: ${a.baseUrl}`),s;console.log("🔧 Modo desarrollo detectado, usando auto-detección...");const t=l.A.getCachedBackend();if(t){console.log(`📦 Usando backend desde caché: ${t.baseUrl}`),s.defaults.baseURL=`${t.baseUrl}/api`;try{const e=await l.A.testPort(t.port);if(e)return r=!0,console.log("✅ API inicializada correctamente con backend desde caché"),s;console.log("❌ Backend cached no responde, detectando nuevamente..."),l.A.clearCache()}catch(e){console.log("❌ Error probando backend cached:",e.message),l.A.clearCache()}}console.log("🔍 Detectando backend automáticamente...");const{baseUrl:o}=await l.A.detectBackend();return s.defaults.baseURL=`${o}/api`,console.log("🧪 Probando conectividad con el backend..."),await s.get("/health",{timeout:5e3}),r=!0,console.log(`✅ API inicializada correctamente con backend: ${o}`),l.A.startHealthCheck((()=>{console.log("⚠️ Conexión con backend perdida, reintentando..."),r=!1,c=null})),s}catch(e){console.error("❌ Error inicializando API:",e),console.log("🔄 Intentando fallback con localhost:8000..."),s.defaults.baseURL="http://127.0.0.1:8000/api";try{return await s.get("/health",{timeout:3e3}),console.log("✅ API inicializada con fallback localhost:8000"),r=!0,s}catch(a){throw console.error("❌ Fallback también falló:",a),new Error("No se pudo conectar con el backend. Verifica que el servidor esté ejecutándose.")}}})(),c),u=async()=>(r||await d(),s);s.interceptors.request.use((e=>{const a=localStorage.getItem("signance_token");return a&&(e.headers.Authorization=`Bearer ${a}`),e}),(e=>Promise.reject(e))),s.interceptors.response.use((e=>e),(e=>{const a=(0,n.dj)();if(e.response){const t=e.response.status,o=e.response.data?.detail||"Error del servidor";switch(t){case 401:localStorage.removeItem("signance_token"),a.error("Sesión expirada. Por favor inicia sesión nuevamente."),window.location.href="/login";break;case 403:a.error("No tienes permisos para realizar esta acción");break;case 404:a.error("Recurso no encontrado");break;case 500:a.error("Error interno del servidor");break;default:a.error(o)}}else e.request?a.error("No se puede conectar con el servidor"):a.error("Error en la solicitud");return Promise.reject(e)}));const m=e=>async(...a)=>{const t=await u();return t[e](...a)},p={get:m("get"),post:m("post"),put:m("put"),delete:m("delete"),patch:m("patch")},g={checkSetup:()=>p.get("/auth/check-setup"),setupAdmin:e=>p.post("/auth/setup-admin",e),login:async e=>{const a=new FormData;a.append("username",e.username),a.append("password",e.password);const t=await u();return t.post("/auth/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},logout:()=>p.post("/auth/logout"),getCurrentUser:()=>p.get("/auth/me"),testProtected:()=>p.get("/auth/protected")},v={list:(e=0,a=100)=>p.get(`/media/?skip=${e}&limit=${a}`),get:e=>p.get(`/media/${e}`),upload:async e=>{const a=new FormData;a.append("file",e.file),a.append("filename",e.filename),a.append("media_type",e.media_type),a.append("duration",e.duration);const t=await u();return t.post("/media/",a,{headers:{"Content-Type":"multipart/form-data"}})},update:(e,a)=>p.put(`/media/${e}`,a),delete:e=>p.delete(`/media/${e}`),getPlaylists:e=>p.get(`/media/${e}/playlists`)},h={get:()=>p.get("/business/"),checkSetup:()=>p.get("/business/check-setup"),create:async e=>{const a=new FormData;a.append("name",e.name),e.logo&&a.append("logo",e.logo);const t=await u();return t.post("/business/",a,{headers:{"Content-Type":"multipart/form-data"}})},update:async e=>{const a=new FormData;e.name&&a.append("name",e.name),e.logo&&a.append("logo",e.logo);const t=await u();return t.put("/business/",a,{headers:{"Content-Type":"multipart/form-data"}})},getLogo:()=>p.get("/business/logo"),delete:()=>p.delete("/business/")},f={list:(e=0,a=100)=>p.get(`/schedules/?skip=${e}&limit=${a}`),get:e=>p.get(`/schedules/${e}`),getByMedia:e=>p.get(`/schedules/media/${e}`),getActive:(e=null)=>{const a=e?`/schedules/schedules/active?schedule_type=${e}`:"/schedules/schedules/active";return p.get(a)},create:e=>p.post("/schedules/",e),update:(e,a)=>p.put(`/schedules/${e}`,a),delete:e=>p.delete(`/schedules/${e}`)},k={list:(e=0,a=100)=>p.get(`/playlists/?skip=${e}&limit=${a}`),get:e=>p.get(`/playlists/${e}`),getStats:()=>p.get("/playlists/stats"),create:e=>p.post("/playlists/",e),update:(e,a)=>p.put(`/playlists/${e}`,a),delete:e=>p.delete(`/playlists/${e}`),addMedia:(e,a)=>p.post(`/playlists/${e}/media`,{media_ids:a}),addSingleMedia:(e,a)=>p.post(`/playlists/${e}/media`,a),removeMedia:(e,a)=>p.delete(`/playlists/${e}/media/${a}`),updateMedia:(e,a,t)=>p.put(`/playlists/${e}/media/${a}`,t),reorder:(e,a)=>p.put(`/playlists/${e}/reorder`,{media_orders:a}),getMedia:e=>p.get(`/playlists/${e}`)},y=(e,a)=>{413===e.response?.status?a.error("El archivo es demasiado grande"):415===e.response?.status?a.error("Tipo de archivo no soportado"):a.error("Error al procesar el archivo")}},891:function(e,a,t){"use strict";t.d(a,{f:function(){return l}});var o=t(953),n=t(349);function l(){const e=(0,o.KR)(""),a=async()=>{try{const{baseUrl:a}=await n.A.detectBackend();e.value=a}catch(a){console.error("Error detectando backend:",a),e.value="http://127.0.0.1:8000"}},t=a=>{if(!a||!e.value)return"";let t=a.filepath||a.file_path||"";if(!t){if(!a.id)return console.error("No se puede construir filepath sin ID"),"";t=`/uploads/${a.id}`}return t&&!t.startsWith("/")&&(t="/"+t),t&&!t.includes("/uploads/")&&(t.startsWith("/")&&(t=t.substring(1)),t=`/uploads/${t}`),`${e.value}${t}`};return a(),{backendBaseUrl:e,buildMediaUrl:t,detectBackend:a}}}},a={};function t(o){var n=a[o];if(void 0!==n)return n.exports;var l=a[o]={exports:{}};return e[o].call(l.exports,l,l.exports,t),l.exports}t.m=e,function(){var e=[];t.O=function(a,o,n,l){if(!o){var i=1/0;for(d=0;d<e.length;d++){o=e[d][0],n=e[d][1],l=e[d][2];for(var s=!0,r=0;r<o.length;r++)(!1&l||i>=l)&&Object.keys(t.O).every((function(e){return t.O[e](o[r])}))?o.splice(r--,1):(s=!1,l<i&&(i=l));if(s){e.splice(d--,1);var c=n();void 0!==c&&(a=c)}}return a}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[o,n,l]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})}}(),function(){t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce((function(a,o){return t.f[o](e,a),a}),[]))}}(),function(){t.u=function(e){return"js/"+e+"."+{289:"3e9580c5",403:"08a85daf",650:"645265dc",935:"98ac9301",941:"ea9f767e",990:"39d39084"}[e]+".js"}}(),function(){t.miniCssF=function(e){return"css/"+e+"."+{289:"2facc57a",403:"3a0e73e2",650:"e20c89da",935:"e475adb7",941:"b79bc63a",990:"ac9bc180"}[e]+".css"}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){var e={},a="signance-frontend:";t.l=function(o,n,l,i){if(e[o])e[o].push(n);else{var s,r;if(void 0!==l)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==a+l){s=u;break}}s||(r=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,t.nc&&s.setAttribute("nonce",t.nc),s.setAttribute("data-webpack",a+l),s.src=o),e[o]=[n];var m=function(a,t){s.onerror=s.onload=null,clearTimeout(p);var n=e[o];if(delete e[o],s.parentNode&&s.parentNode.removeChild(s),n&&n.forEach((function(e){return e(t)})),a)return a(t)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),r&&document.head.appendChild(s)}}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,a,o,n,l){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",t.nc&&(i.nonce=t.nc);var s=function(t){if(i.onerror=i.onload=null,"load"===t.type)n();else{var o=t&&t.type,s=t&&t.target&&t.target.href||a,r=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+s+")");r.name="ChunkLoadError",r.code="CSS_CHUNK_LOAD_FAILED",r.type=o,r.request=s,i.parentNode&&i.parentNode.removeChild(i),l(r)}};return i.onerror=i.onload=s,i.href=a,o?o.parentNode.insertBefore(i,o.nextSibling):document.head.appendChild(i),i},a=function(e,a){for(var t=document.getElementsByTagName("link"),o=0;o<t.length;o++){var n=t[o],l=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(l===e||l===a))return n}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){n=i[o],l=n.getAttribute("data-href");if(l===e||l===a)return n}},o=function(o){return new Promise((function(n,l){var i=t.miniCssF(o),s=t.p+i;if(a(i,s))return n();e(o,s,null,n,l)}))},n={524:0};t.f.miniCss=function(e,a){var t={289:1,403:1,650:1,935:1,941:1,990:1};n[e]?a.push(n[e]):0!==n[e]&&t[e]&&a.push(n[e]=o(e).then((function(){n[e]=0}),(function(a){throw delete n[e],a})))}}}(),function(){var e={524:0};t.f.j=function(a,o){var n=t.o(e,a)?e[a]:void 0;if(0!==n)if(n)o.push(n[2]);else{var l=new Promise((function(t,o){n=e[a]=[t,o]}));o.push(n[2]=l);var i=t.p+t.u(a),s=new Error,r=function(o){if(t.o(e,a)&&(n=e[a],0!==n&&(e[a]=void 0),n)){var l=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;s.message="Loading chunk "+a+" failed.\n("+l+": "+i+")",s.name="ChunkLoadError",s.type=l,s.request=i,n[1](s)}};t.l(i,r,"chunk-"+a,a)}},t.O.j=function(a){return 0===e[a]};var a=function(a,o){var n,l,i=o[0],s=o[1],r=o[2],c=0;if(i.some((function(a){return 0!==e[a]}))){for(n in s)t.o(s,n)&&(t.m[n]=s[n]);if(r)var d=r(t)}for(a&&a(o);c<i.length;c++)l=i[c],t.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return t.O(d)},o=self["webpackChunksignance_frontend"]=self["webpackChunksignance_frontend"]||[];o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(137)}));o=t.O(o)})();
//# sourceMappingURL=app.8a6b424e.js.map