(function(){"use strict";var e={301:function(e,a,t){var o=t(751),l=t(641);const n={id:"app"};function s(e,a,t,o,s,i){const r=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.bF)(r)])}var i=t(349),r={name:"App",mounted(){console.log("🎬 Pochtecayotl Signance System - Frontend iniciado"),this.checkBackendConnection()},methods:{async checkBackendConnection(){try{const e=await i.A.detectBackend();console.log(`✅ Conexión con backend establecida en ${e.baseUrl}`)}catch(e){console.error("❌ No se puede conectar con el backend:",e),this.$q.notify({type:"warning",message:"No se puede conectar con el servidor",caption:"Verifica que el backend esté ejecutándose en el rango de puertos 8000-8010"})}}}},c=t(262);const d=(0,c.A)(r,[["render",s]]);var u=d,m=t(220);const p={class:"login-container"},g={class:"theme-toggle-container"},v={class:"login-content"},h={class:"login-header"},k={class:"logo-container"},f={class:"input-group"},y={class:"input-group"},b={class:"login-actions"};function L(e,a,t,o,n,s){const i=(0,l.g2)("ThemeToggle"),r=(0,l.g2)("q-icon"),c=(0,l.g2)("q-card-section"),d=(0,l.g2)("q-input"),u=(0,l.g2)("q-btn"),m=(0,l.g2)("q-form"),L=(0,l.g2)("q-card"),_=(0,l.g2)("q-card-actions"),F=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("div",g,[(0,l.bF)(i)]),(0,l.Lk)("div",v,[(0,l.bF)(L,{class:"login-card"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{class:"text-center login-header-section"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",h,[(0,l.Lk)("div",k,[(0,l.bF)(r,{name:"video_library",class:"main-logo"}),a[5]||(a[5]=(0,l.Lk)("div",{class:"logo-glow"},null,-1))]),a[6]||(a[6]=(0,l.Lk)("h2",{class:"app-title"},"Pochtecayotl",-1)),a[7]||(a[7]=(0,l.Lk)("h3",{class:"app-subtitle-main"},"Signance System",-1)),a[8]||(a[8]=(0,l.Lk)("p",{class:"app-subtitle"},"Sistema de Gestión de Anuncios Digitales",-1)),a[9]||(a[9]=(0,l.Lk)("div",{class:"pride-divider"},null,-1))])])),_:1}),(0,l.bF)(c,{class:"login-form-section"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{onSubmit:o.handleLogin,class:"login-form"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",f,[(0,l.bF)(d,{modelValue:o.credentials.username,"onUpdate:modelValue":a[0]||(a[0]=e=>o.credentials.username=e),label:"Usuario",outlined:"",dense:"",rules:[e=>!!e||"El usuario es requerido"],ref:"usernameRef",class:"modern-input"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"person",class:"input-icon"})])),_:1},8,["modelValue","rules"])]),(0,l.Lk)("div",y,[(0,l.bF)(d,{modelValue:o.credentials.password,"onUpdate:modelValue":a[1]||(a[1]=e=>o.credentials.password=e),label:"Contraseña",type:"password",outlined:"",dense:"",rules:[e=>!!e||"La contraseña es requerida"],ref:"passwordRef",class:"modern-input"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"lock",class:"input-icon"})])),_:1},8,["modelValue","rules"])]),(0,l.Lk)("div",b,[(0,l.bF)(u,{type:"submit",label:"Iniciar Sesión",class:"login-btn",size:"md",unelevated:"",loading:o.isLoading,disable:!o.credentials.username||!o.credentials.password},null,8,["loading","disable"])])])),_:1},8,["onSubmit"])])),_:1}),(0,l.bF)(c,{class:"text-center footer-section"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",label:"Probar Conexión",onClick:o.testBackendConnection,size:"sm",class:"test-btn"},null,8,["onClick"])])),_:1})])),_:1})]),(0,l.bF)(F,{modelValue:o.showSetupDialog,"onUpdate:modelValue":a[4]||(a[4]=e=>o.showSetupDialog=e),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(L,{class:"setup-dialog-card",style:{"min-width":"400px"}},{default:(0,l.k6)((()=>[(0,l.bF)(c,{class:"setup-header row items-center"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{name:"admin_panel_settings",size:"2rem",color:"orange"}),a[10]||(a[10]=(0,l.Lk)("span",{class:"q-ml-sm text-h6 setup-title"},"Configuración Inicial",-1))])),_:1,__:[10]}),(0,l.bF)(c,{class:"setup-content"},{default:(0,l.k6)((()=>[a[11]||(a[11]=(0,l.Lk)("p",{class:"setup-description"},"El sistema necesita configuración inicial. Crea el usuario administrador:",-1)),(0,l.bF)(m,{onSubmit:o.handleSetupAdmin,class:"q-gutter-md"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{modelValue:o.setupData.username,"onUpdate:modelValue":a[2]||(a[2]=e=>o.setupData.username=e),label:"Usuario Administrador",outlined:"",class:"setup-input",rules:[e=>!!e||"Requerido"]},null,8,["modelValue","rules"]),(0,l.bF)(d,{modelValue:o.setupData.password,"onUpdate:modelValue":a[3]||(a[3]=e=>o.setupData.password=e),label:"Contraseña",type:"password",outlined:"",class:"setup-input",rules:[e=>!!e||"Requerido"]},null,8,["modelValue","rules"])])),_:1},8,["onSubmit"])])),_:1,__:[11]}),(0,l.bF)(_,{align:"right",class:"setup-actions"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"Configurar",color:"primary",class:"setup-btn",onClick:o.handleSetupAdmin,loading:o.isSetupLoading},null,8,["onClick","loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var _=t(953),F=t(840),C=t(246),w=t(889),E=t(725),P=t(697),S={name:"LoginView",components:{ThemeToggle:P.A},setup(){const e=(0,m.rd)(),a=(0,F.Jud)(),t=(0,C.dj)(),{loadTheme:o}=(0,E.D)(),n=(0,_.KR)(!1),s=(0,_.KR)(!1),i=(0,_.KR)(!1),r=(0,_.Kh)({username:"",password:""}),c=(0,_.Kh)({username:"admin",password:""}),d=async()=>{try{const e=await w.R2.checkSetup();e.data.setup_required&&(i.value=!0,t.info("Se requiere configuración inicial del sistema"))}catch(e){console.error("Error verificando setup:",e),t.error("Error conectando con el servidor")}},u=async()=>{if(c.username&&c.password){s.value=!0;try{await w.R2.setupAdmin(c),t.success("Administrador configurado exitosamente"),i.value=!1,r.username=c.username,r.password=c.password,await p()}catch(e){console.error("Error en setup:",e),t.error("Error configurando administrador")}finally{s.value=!1}}else t.warning("Completa todos los campos")},p=async()=>{n.value=!0;try{const a=await w.R2.login(r),{access_token:o}=a.data;localStorage.setItem("signance_token",o),t.success(`¡Bienvenido, ${r.username}!`),e.push("/admin")}catch(a){console.error("Error en login:",a),401===a.response?.status?t.error("Credenciales incorrectas"):t.error("Error iniciando sesión"),r.password=""}finally{n.value=!1}},g=async()=>{a.loading.show({message:"Probando conexión..."});try{const e=await fetch("http://127.0.0.1:8000/health");if(e.ok){const a=await e.json();t.success(`Conexión exitosa: ${a.status}`)}else t.warning("El servidor responde pero con errores")}catch(e){console.error("Error de conexión:",e),t.error("No se puede conectar con el servidor")}finally{a.loading.hide()}},v=()=>{const a=localStorage.getItem("signance_token");a&&e.push("/test-ok")};return(0,l.sV)((()=>{o(),v(),d()})),{credentials:r,setupData:c,isLoading:n,isSetupLoading:s,showSetupDialog:i,handleLogin:p,handleSetupAdmin:u,testBackendConnection:g}}};const M=(0,c.A)(S,[["render",L],["__scopeId","data-v-ff55de2c"]]);var A=M,$=t(33);const D={class:"test-ok-container"},T={class:"signance-container"},I={class:"success-header"},x={class:"success-icon"},q={class:"info-card user-info"},U={class:"card-header"},z={class:"header-text"},B={class:"info-card tests-card"},R={class:"tests-grid"},V={class:"test-icon"},X={class:"test-info"},N={class:"test-action"},W={class:"info-card actions-card"},K={class:"actions-grid"},O={class:"logout-section"},Q={class:"info-card system-info"},j={class:"system-details"},G={class:"detail-item"},H={class:"detail-value"},J={class:"detail-item"},Z={class:"detail-value"},Y={class:"detail-item"},ee={class:"detail-value"},ae={class:"detail-item"},te={class:"detail-value"};function oe(e,a,t,o,n,s){const i=(0,l.g2)("ThemeToggle"),r=(0,l.g2)("q-icon"),c=(0,l.g2)("q-btn"),d=(0,l.g2)("q-chip");return(0,l.uX)(),(0,l.CE)("div",D,[(0,l.bF)(i,{class:"theme-toggle"}),(0,l.Lk)("div",T,[(0,l.Lk)("div",I,[(0,l.Lk)("div",x,[(0,l.bF)(r,{name:"check_circle",size:"4rem"})]),a[4]||(a[4]=(0,l.Lk)("h2",null,"¡Sistema Funcionando Correctamente!",-1)),a[5]||(a[5]=(0,l.Lk)("p",null,"Pochtecayotl Signance System - Autenticación Exitosa",-1))]),(0,l.Lk)("div",q,[(0,l.Lk)("div",U,[(0,l.bF)(r,{name:"person",size:"2rem"}),(0,l.Lk)("div",z,[a[6]||(a[6]=(0,l.Lk)("h3",null,"Usuario Autenticado",-1)),(0,l.Lk)("p",null,(0,$.v_)(o.userInfo.username||"Cargando..."),1)])])]),(0,l.Lk)("div",B,[a[7]||(a[7]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Pruebas del Sistema")],-1)),(0,l.Lk)("div",R,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.systemTests,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.name,class:(0,$.C4)(["test-item",{"test-success":"success"===e.status,"test-error":"error"===e.status,"test-testing":"testing"===e.status}])},[(0,l.Lk)("div",V,[(0,l.bF)(r,{name:"success"===e.status?"check_circle":"error"===e.status?"error":"hourglass_empty",size:"1.5rem"},null,8,["name"])]),(0,l.Lk)("div",X,[(0,l.Lk)("h4",null,(0,$.v_)(e.name),1),(0,l.Lk)("p",null,(0,$.v_)(e.description),1)]),(0,l.Lk)("div",N,[(0,l.bF)(c,{flat:"",round:"",icon:"testing"===e.status?"refresh":"play_arrow",onClick:a=>o.runTest(e),loading:"testing"===e.status,size:"sm",color:"success"===e.status?"positive":"primary"},null,8,["icon","onClick","loading","color"])])],2)))),128))])]),(0,l.Lk)("div",W,[a[12]||(a[12]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Acciones Disponibles")],-1)),(0,l.Lk)("div",K,[(0,l.Lk)("div",{class:"action-button primary-action",onClick:a[0]||(a[0]=(...e)=>o.goToDashboard&&o.goToDashboard(...e))},[(0,l.bF)(r,{name:"dashboard",size:"2rem"}),a[8]||(a[8]=(0,l.Lk)("span",null,"Dashboard",-1))]),(0,l.Lk)("div",{class:"action-button secondary-action",onClick:a[1]||(a[1]=(...e)=>o.goToMediaManager&&o.goToMediaManager(...e))},[(0,l.bF)(r,{name:"cloud_upload",size:"2rem"}),a[9]||(a[9]=(0,l.Lk)("span",null,"Gestión de Media",-1))]),(0,l.Lk)("div",{class:"action-button accent-action",onClick:a[2]||(a[2]=(...e)=>o.goToConfig&&o.goToConfig(...e))},[(0,l.bF)(r,{name:"settings",size:"2rem"}),a[10]||(a[10]=(0,l.Lk)("span",null,"Configuración",-1))]),(0,l.Lk)("div",{class:"action-button warning-action",onClick:a[3]||(a[3]=(...e)=>o.goToErrorPage&&o.goToErrorPage(...e))},[(0,l.bF)(r,{name:"bug_report",size:"2rem"}),a[11]||(a[11]=(0,l.Lk)("span",null,"Ver Página de Error",-1))])]),(0,l.Lk)("div",O,[(0,l.bF)(c,{color:"negative",icon:"logout",label:"Cerrar Sesión",onClick:o.logout,outline:"",rounded:"",size:"md"},null,8,["onClick"])])]),(0,l.Lk)("div",Q,[a[17]||(a[17]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Información del Sistema")],-1)),(0,l.Lk)("div",j,[(0,l.Lk)("div",G,[a[13]||(a[13]=(0,l.Lk)("span",{class:"detail-label"},"Estado del Backend",-1)),(0,l.Lk)("div",H,[(0,l.bF)(d,{color:o.backendStatus.connected?"positive":"negative","text-color":"white",icon:o.backendStatus.connected?"check":"close",size:"sm"},{default:(0,l.k6)((()=>[(0,l.eW)((0,$.v_)(o.backendStatus.connected?"Conectado":"Desconectado"),1)])),_:1},8,["color","icon"])])]),(0,l.Lk)("div",J,[a[14]||(a[14]=(0,l.Lk)("span",{class:"detail-label"},"URL del Backend",-1)),(0,l.Lk)("span",Z,(0,$.v_)(o.backendStatus.url),1)]),(0,l.Lk)("div",Y,[a[15]||(a[15]=(0,l.Lk)("span",{class:"detail-label"},"Fecha de Acceso",-1)),(0,l.Lk)("span",ee,(0,$.v_)((new Date).toLocaleString("es-ES")),1)]),(0,l.Lk)("div",ae,[a[16]||(a[16]=(0,l.Lk)("span",{class:"detail-label"},"Token JWT",-1)),(0,l.Lk)("div",te,[(0,l.bF)(d,{color:"info","text-color":"white",size:"sm"},{default:(0,l.k6)((()=>[(0,l.eW)((0,$.v_)(o.tokenInfo),1)])),_:1})])])])])])])}var le={name:"Ok_TestView",components:{ThemeToggle:P.A},setup(){const e=(0,m.rd)(),a=(0,C.dj)(),{isDarkMode:t}=(0,E.D)(),o=(0,_.KR)({}),n=(0,_.Kh)({connected:!1,lastCheck:null,url:"Detectando...",port:null}),s=(0,l.EW)((()=>{const e=localStorage.getItem("signance_token");return e?`${e.substring(0,20)}...`:"No disponible"})),r=(0,_.KR)([{name:"Autenticación",description:"Verificar ruta protegida",status:"pending",test:()=>w.R2.testProtected()},{name:"Gestión de Media",description:"Listar archivos multimedia",status:"pending",test:()=>w.DX.list(0,5)},{name:"Información de Negocio",description:"Obtener configuración empresarial",status:"pending",test:()=>w.ZK.get()},{name:"Programación",description:"Listar horarios programados",status:"pending",test:()=>w.gr.list(0,5)}]),c=async e=>{e.status="testing";try{const t=await e.test();e.status="success",e.result=t.data,a.success(`✅ ${e.name}: Prueba exitosa`)}catch(t){e.status="error",e.error=t.message,a.error(`❌ ${e.name}: ${t.message}`)}},d=async()=>{for(const e of r.value)await c(e),await new Promise((e=>setTimeout(e,500)))},u=async()=>{try{const e=await w.R2.getCurrentUser();o.value=e.data}catch(e){console.error("Error obteniendo información del usuario:",e),a.error("Error obteniendo información del usuario")}},p=async()=>{try{console.log("🔍 Verificando estado del backend...");const e=i.A.getCachedBackend();if(e){console.log("📦 Usando información cached del backend:",e),n.url=e.baseUrl,n.port=e.port;const a=await i.A.testPort(e.port);if(n.connected=a,n.lastCheck=new Date,a)return void console.log("✅ Backend confirmado desde caché");console.log("❌ Backend cached no responde, detectando nuevamente...")}const a=await i.A.detectBackend();n.connected=!0,n.url=a.baseUrl,n.port=a.port,n.lastCheck=new Date,console.log("✅ Backend detectado exitosamente:",a)}catch(e){console.error("❌ Error detectando backend:",e),n.connected=!1,n.url="No disponible",n.port=null,n.lastCheck=new Date}},g=()=>{e.push("/admin")},v=()=>{e.push("/media")},h=()=>{e.push("/config")},k=()=>{e.push("/error")},f=async()=>{try{await w.R2.logout()}catch(t){console.error("Error en logout:",t)}finally{localStorage.removeItem("signance_token"),a.success("Sesión cerrada exitosamente"),e.push("/login")}};return(0,l.sV)((()=>{u(),p(),setTimeout(d,2e3)})),{userInfo:o,backendStatus:n,tokenInfo:s,systemTests:r,runTest:c,runAllTests:d,goToDashboard:g,goToMediaManager:v,goToConfig:h,goToErrorPage:k,logout:f,isDarkMode:t}}};const ne=(0,c.A)(le,[["render",oe],["__scopeId","data-v-0aaf4706"]]);var se=ne;const ie={class:"error-container"},re={class:"signance-container"},ce={class:"error-header"},de={class:"error-icon"},ue={class:"info-card error-info"},me={class:"card-header"},pe={class:"error-details"},ge={class:"error-badge"},ve={class:"detail-item"},he={class:"detail-value"},ke={class:"detail-item"},fe={class:"detail-value"},ye={class:"detail-item"},be={class:"detail-value"},Le={class:"info-card diagnostic-card"},_e={class:"diagnostic-grid"},Fe={class:"diagnostic-icon"},Ce={class:"diagnostic-info"},we={key:0,class:"diagnostic-details"},Ee={class:"diagnostic-action"},Pe={class:"info-card solutions-card"},Se={class:"solutions-timeline"},Me={class:"solution-step"},Ae={class:"step-content"},$e={class:"solution-step"},De={class:"step-content"},Te={class:"solution-step"},Ie={class:"step-content"},xe={class:"solution-step"},qe={class:"step-content"},Ue={class:"info-card navigation-card"},ze={class:"navigation-actions"},Be={class:"technical-section"},Re={class:"technical-content"},Ve={class:"technical-info"};function Xe(e,a,t,o,n,s){const i=(0,l.g2)("ThemeToggle"),r=(0,l.g2)("q-icon"),c=(0,l.g2)("q-chip"),d=(0,l.g2)("q-btn"),u=(0,l.g2)("q-expansion-item");return(0,l.uX)(),(0,l.CE)("div",ie,[(0,l.bF)(i,{class:"theme-toggle"}),(0,l.Lk)("div",re,[(0,l.Lk)("div",ce,[(0,l.Lk)("div",de,[(0,l.bF)(r,{name:"error",size:"5rem"})]),a[3]||(a[3]=(0,l.Lk)("h2",null,"¡Oops! Algo salió mal",-1)),a[4]||(a[4]=(0,l.Lk)("p",null,"Pochtecayotl Signance System - Página de Error",-1))]),(0,l.Lk)("div",ue,[(0,l.Lk)("div",me,[(0,l.bF)(r,{name:"bug_report",size:"2rem"}),a[5]||(a[5]=(0,l.Lk)("div",{class:"header-text"},[(0,l.Lk)("h3",null,"Error del Sistema"),(0,l.Lk)("p",null,"Detalles técnicos del problema")],-1))]),(0,l.Lk)("div",pe,[(0,l.Lk)("div",ge,[(0,l.bF)(c,{color:"negative","text-color":"white",icon:"error"},{default:(0,l.k6)((()=>[(0,l.eW)(" Código: "+(0,$.v_)(o.errorCode),1)])),_:1})]),(0,l.Lk)("div",ve,[a[6]||(a[6]=(0,l.Lk)("span",{class:"detail-label"},"Mensaje:",-1)),(0,l.Lk)("span",he,(0,$.v_)(o.errorMessage),1)]),(0,l.Lk)("div",ke,[a[7]||(a[7]=(0,l.Lk)("span",{class:"detail-label"},"Timestamp:",-1)),(0,l.Lk)("span",fe,(0,$.v_)((new Date).toLocaleString("es-ES")),1)]),(0,l.Lk)("div",ye,[a[8]||(a[8]=(0,l.Lk)("span",{class:"detail-label"},"URL:",-1)),(0,l.Lk)("span",be,(0,$.v_)(o.currentUrl),1)])])]),(0,l.Lk)("div",Le,[a[9]||(a[9]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Diagnóstico del Sistema")],-1)),(0,l.Lk)("div",_e,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.diagnosticChecks,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.name,class:(0,$.C4)(["diagnostic-item",{"diagnostic-ok":"ok"===e.status,"diagnostic-error":"error"===e.status,"diagnostic-checking":e.checking}])},[(0,l.Lk)("div",Fe,[(0,l.bF)(r,{name:"ok"===e.status?"check_circle":"error"===e.status?"error":"help",size:"1.5rem"},null,8,["name"])]),(0,l.Lk)("div",Ce,[(0,l.Lk)("h4",null,(0,$.v_)(e.name),1),(0,l.Lk)("p",null,(0,$.v_)(e.description),1),e.details?((0,l.uX)(),(0,l.CE)("p",we,(0,$.v_)(e.details),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",Ee,[(0,l.bF)(d,{flat:"",round:"",icon:"refresh",onClick:a=>o.runDiagnostic(e),loading:e.checking,size:"sm",color:"primary"},null,8,["onClick","loading"])])],2)))),128))])]),(0,l.Lk)("div",Pe,[a[22]||(a[22]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Posibles Soluciones")],-1)),(0,l.Lk)("div",Se,[(0,l.Lk)("div",Me,[a[12]||(a[12]=(0,l.Lk)("div",{class:"step-number"},"1",-1)),(0,l.Lk)("div",Ae,[a[10]||(a[10]=(0,l.Lk)("h4",null,"Verificar Conexión",-1)),a[11]||(a[11]=(0,l.Lk)("p",null,[(0,l.eW)("Verifica que el servidor backend esté ejecutándose en "),(0,l.Lk)("code",null,"http://127.0.0.1:8002")],-1)),(0,l.bF)(d,{flat:"",color:"primary",label:"Probar Conexión",onClick:o.testConnection,size:"sm",icon:"wifi",rounded:""},null,8,["onClick"])])]),(0,l.Lk)("div",$e,[a[15]||(a[15]=(0,l.Lk)("div",{class:"step-number"},"2",-1)),(0,l.Lk)("div",De,[a[13]||(a[13]=(0,l.Lk)("h4",null,"Revisar Autenticación",-1)),a[14]||(a[14]=(0,l.Lk)("p",null,"Verifica que tu sesión no haya expirado",-1)),(0,l.bF)(d,{flat:"",color:"primary",label:"Ir a Login",onClick:o.goToLogin,size:"sm",icon:"key",rounded:""},null,8,["onClick"])])]),(0,l.Lk)("div",Te,[a[18]||(a[18]=(0,l.Lk)("div",{class:"step-number"},"3",-1)),(0,l.Lk)("div",Ie,[a[16]||(a[16]=(0,l.Lk)("h4",null,"Recargar Página",-1)),a[17]||(a[17]=(0,l.Lk)("p",null,"A veces un simple recargo puede solucionar el problema",-1)),(0,l.bF)(d,{flat:"",color:"primary",label:"Recargar",onClick:o.reloadPage,size:"sm",icon:"refresh",rounded:""},null,8,["onClick"])])]),(0,l.Lk)("div",xe,[a[21]||(a[21]=(0,l.Lk)("div",{class:"step-number"},"4",-1)),(0,l.Lk)("div",qe,[a[19]||(a[19]=(0,l.Lk)("h4",null,"Contactar Soporte",-1)),a[20]||(a[20]=(0,l.Lk)("p",null,"Si el problema persiste, contacta al equipo de soporte",-1)),(0,l.bF)(d,{flat:"",color:"primary",label:"Reportar Error",onClick:o.reportError,size:"sm",icon:"support",rounded:""},null,8,["onClick"])])])])]),(0,l.Lk)("div",Ue,[a[26]||(a[26]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Navegación")],-1)),(0,l.Lk)("div",ze,[(0,l.Lk)("div",{class:"nav-button primary-nav",onClick:a[0]||(a[0]=(...e)=>o.goToHome&&o.goToHome(...e))},[(0,l.bF)(r,{name:"home",size:"2rem"}),a[23]||(a[23]=(0,l.Lk)("span",null,"Ir al Inicio",-1))]),(0,l.Lk)("div",{class:"nav-button secondary-nav",onClick:a[1]||(a[1]=(...e)=>o.goToLogin&&o.goToLogin(...e))},[(0,l.bF)(r,{name:"login",size:"2rem"}),a[24]||(a[24]=(0,l.Lk)("span",null,"Iniciar Sesión",-1))]),(0,l.Lk)("div",{class:"nav-button success-nav",onClick:a[2]||(a[2]=(...e)=>o.goToTestPage&&o.goToTestPage(...e))},[(0,l.bF)(r,{name:"check",size:"2rem"}),a[25]||(a[25]=(0,l.Lk)("span",null,"Página de Prueba",-1))])])]),(0,l.Lk)("div",Be,[(0,l.bF)(u,{icon:"code",label:"Información Técnica",caption:"Detalles para desarrolladores",class:"technical-expansion"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Re,[(0,l.Lk)("pre",Ve,(0,$.v_)(o.technicalInfo),1)])])),_:1})])])])}var Ne={name:"Error_View",components:{ThemeToggle:P.A},setup(){const e=(0,m.rd)(),a=(0,m.lq)(),t=(0,F.Jud)(),o=(0,C.dj)(),{isDarkMode:n}=(0,E.D)(),s=(0,_.KR)(a.query.code||"500"),i=(0,_.KR)(a.query.message||"Error interno del sistema"),r=(0,_.KR)(window.location.href),c=(0,_.KR)([{name:"Conexión Backend",description:"Verificar si el servidor está disponible",status:"unknown",checking:!1,test:async()=>{const e=await fetch("http://127.0.0.1:8002/health");return e.ok}},{name:"Token de Autenticación",description:"Verificar validez del token JWT",status:"unknown",checking:!1,test:()=>{const e=localStorage.getItem("signance_token");return!!e}},{name:"Almacenamiento Local",description:"Verificar disponibilidad de localStorage",status:"unknown",checking:!1,test:()=>{try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch{return!1}}},{name:"Conectividad de Red",description:"Verificar conexión a internet",status:"unknown",checking:!1,test:()=>navigator.onLine}]),d=(0,l.EW)((()=>JSON.stringify({errorCode:s.value,errorMessage:i.value,url:r.value,userAgent:navigator.userAgent,timestamp:(new Date).toISOString(),localStorage:{hasToken:!!localStorage.getItem("signance_token"),tokenLength:localStorage.getItem("signance_token")?.length||0},route:{path:a.path,query:a.query,params:a.params}},null,2))),u=async e=>{e.checking=!0;try{const a=await e.test();e.status=a?"ok":"error",e.details=a?"Funcionando correctamente":"Problema detectado"}catch(a){e.status="error",e.details=`Error: ${a.message}`}finally{e.checking=!1}},p=async()=>{for(const e of c.value)await u(e),await new Promise((e=>setTimeout(e,300)))},g=async()=>{t.loading.show({message:"Probando conexión..."});try{const e=await fetch("http://127.0.0.1:8002/health");e.ok?o.success("✅ Conexión exitosa con el backend"):o.warning("⚠️ El servidor responde pero con errores")}catch(e){o.error("❌ No se puede conectar con el servidor")}finally{t.loading.hide()}},v=()=>{e.push("/")},h=()=>{e.push("/login")},k=()=>{e.push("/test-ok")},f=()=>{window.location.reload()},y=()=>{o.info("Función de reporte de errores en desarrollo"),console.log("Error Report:",d.value)};return(0,l.sV)((()=>{setTimeout(p,1e3)})),{errorCode:s,errorMessage:i,currentUrl:r,diagnosticChecks:c,technicalInfo:d,runDiagnostic:u,runAllDiagnostics:p,testConnection:g,goToHome:v,goToLogin:h,goToTestPage:k,reloadPage:f,reportError:y,isDarkMode:n}}};const We=(0,c.A)(Ne,[["render",Xe],["__scopeId","data-v-2aecc947"]]);var Ke=We;const Oe={class:"selection-container"},Qe={class:"selection-card"},je={class:"card-header"},Ge={class:"logo-section"},He={class:"options-section"},Je={class:"option-icon"},Ze={class:"option-icon"};function Ye(e,a,t,o,n,s){const i=(0,l.g2)("ThemeToggle"),r=(0,l.g2)("q-icon");return(0,l.uX)(),(0,l.CE)("div",Oe,[(0,l.bF)(i,{class:"theme-toggle"}),(0,l.Lk)("div",Qe,[(0,l.Lk)("div",je,[(0,l.Lk)("div",Ge,[(0,l.bF)(r,{name:"campaign",size:"4rem",class:"ads-icon"}),a[2]||(a[2]=(0,l.Lk)("h2",{class:"welcome-title"},"Bienvenido",-1)),a[3]||(a[3]=(0,l.Lk)("h3",{class:"system-title"},"Pochtecayotl Signance System",-1))]),a[4]||(a[4]=(0,l.Lk)("p",{class:"subtitle"},"Seleccione una opción para continuar",-1))]),(0,l.Lk)("div",He,[(0,l.Lk)("div",{class:"option-card player-option",onClick:a[0]||(a[0]=(...e)=>o.goPlayer&&o.goPlayer(...e))},[(0,l.Lk)("div",Je,[(0,l.bF)(r,{name:"play_circle_filled",size:"3rem"})]),a[5]||(a[5]=(0,l.Lk)("div",{class:"option-content"},[(0,l.Lk)("h4",null,"Reproductor"),(0,l.Lk)("p",null,"Acceder al reproductor de contenido multimedia")],-1)),(0,l.bF)(r,{name:"arrow_forward",size:"1.5rem",class:"arrow-icon"})]),(0,l.Lk)("div",{class:"option-card admin-option",onClick:a[1]||(a[1]=(...e)=>o.goAdmin&&o.goAdmin(...e))},[(0,l.Lk)("div",Ze,[(0,l.bF)(r,{name:"dashboard",size:"3rem"})]),a[6]||(a[6]=(0,l.Lk)("div",{class:"option-content"},[(0,l.Lk)("h4",null,"Admin Dashboard"),(0,l.Lk)("p",null,"Gestionar contenido y configuración del sistema")],-1)),(0,l.bF)(r,{name:"arrow_forward",size:"1.5rem",class:"arrow-icon"})])]),a[7]||(a[7]=(0,l.Lk)("div",{class:"footer-section"},[(0,l.Lk)("p",{class:"footer-text"},"Sistema diseñado por un gei 🏳️‍🌈")],-1))])])}var ea={name:"SelectionView",components:{ThemeToggle:P.A},setup(){const e=(0,m.rd)(),{isDarkMode:a}=(0,E.D)(),t=()=>e.push("/player"),o=()=>e.push("/admin");return{goPlayer:t,goAdmin:o,isDarkMode:a}}};const aa=(0,c.A)(ea,[["render",Ye],["__scopeId","data-v-8e67c9e0"]]);var ta=aa,oa=t(642),la=t(600);const na={class:"admin-dashboard-container"},sa={class:"signance-container"},ia={class:"dashboard-header"},ra={class:"header-icon"},ca={class:"info-card upload-card"},da={class:"card-header"},ua={class:"upload-content"},ma={class:"text-h6"},pa={class:"row q-gutter-md"},ga={class:"col-5"},va={class:"col-6"};function ha(e,a,t,o,n,s){const i=(0,l.g2)("ThemeToggle"),r=(0,l.g2)("q-icon"),c=(0,l.g2)("StatisticsCard"),d=(0,l.g2)("PlaylistManagement"),u=(0,l.g2)("MediaUploader"),m=(0,l.g2)("MediaGallery"),p=(0,l.g2)("QuickActions"),g=(0,l.g2)("PlaylistDialog"),v=(0,l.g2)("EditMediaDialog"),h=(0,l.g2)("ScheduleDialog"),k=(0,l.g2)("q-card-section"),f=(0,l.g2)("q-item-section"),y=(0,l.g2)("q-item-label"),b=(0,l.g2)("q-btn"),L=(0,l.g2)("q-item"),_=(0,l.g2)("q-list"),F=(0,l.g2)("draggable"),C=(0,l.g2)("q-card-actions"),w=(0,l.g2)("q-card"),E=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.CE)("div",na,[(0,l.bF)(i,{class:"theme-toggle"}),(0,l.Lk)("div",sa,[(0,l.Lk)("div",ia,[(0,l.Lk)("div",ra,[(0,l.bF)(r,{name:"dashboard",size:"4rem"})]),a[5]||(a[5]=(0,l.Lk)("h2",null,"Dashboard Administrativo",-1)),a[6]||(a[6]=(0,l.Lk)("p",null,"Pochtecayotl Signance System - Panel de Control",-1))]),(0,l.bF)(c,{stats:o.stats,"business-info":o.businessInfo},null,8,["stats","business-info"]),(0,l.bF)(d,{playlists:o.playlists,onCreate:o.showCreatePlaylistDialog,onEdit:o.editPlaylist,onManage:o.managePlaylistMedia,onSchedule:o.schedulePlaylist,onDelete:o.deletePlaylist},null,8,["playlists","onCreate","onEdit","onManage","onSchedule","onDelete"]),(0,l.Lk)("div",ca,[(0,l.Lk)("div",da,[(0,l.bF)(r,{name:"cloud_upload",size:"2rem"}),a[7]||(a[7]=(0,l.Lk)("div",{class:"header-text"},[(0,l.Lk)("h3",null,"Subir Multimedia"),(0,l.Lk)("p",null,"Agregar nuevos archivos al sistema")],-1))]),(0,l.Lk)("div",ua,[(0,l.bF)(u,{onUploaded:o.onMediaUploaded,onError:o.onMediaUploadError},null,8,["onUploaded","onError"])])]),(0,l.bF)(m,{"media-files":o.mediaFiles,"backend-base-url":o.backendBaseUrl,loading:o.mediaLoading,mode:"compact",title:"Archivos Multimedia",subtitle:"Archivos recientes","max-items":8,onRefresh:o.loadMedia,onEdit:o.editMedia,onDelete:o.deleteMedia,onShowAll:e.navigateToMediaManager,class:"section-spacing"},null,8,["media-files","backend-base-url","loading","onRefresh","onEdit","onDelete","onShowAll"]),(0,l.bF)(p,{onLogout:o.logout,class:"section-spacing"},null,8,["onLogout"])]),(0,l.bF)(g,{modelValue:o.playlistDialog,"onUpdate:modelValue":a[0]||(a[0]=e=>o.playlistDialog=e),playlist:o.editingPlaylist,form:o.playlistForm,loading:o.savingPlaylist,"is-dark":o.isDarkMode,onSave:o.savePlaylist,onClose:o.closePlaylistDialog},null,8,["modelValue","playlist","form","loading","is-dark","onSave","onClose"]),(0,l.bF)(v,{modelValue:o.editMediaDialog,"onUpdate:modelValue":a[1]||(a[1]=e=>o.editMediaDialog=e),media:o.editingMedia,form:o.editMediaForm,loading:o.savingMedia,"is-dark":o.isDarkMode,onSave:o.saveMediaChanges,onClose:o.closeEditMediaDialog},null,8,["modelValue","media","form","loading","is-dark","onSave","onClose"]),(0,l.bF)(h,{modelValue:o.scheduleDialog,"onUpdate:modelValue":a[2]||(a[2]=e=>o.scheduleDialog=e),form:o.scheduleForm,loading:o.savingSchedule,"weekday-options":o.weekdayOptions,"is-dark":o.isDarkMode,onSave:o.saveSchedule,onClose:o.closeScheduleDialog},null,8,["modelValue","form","loading","weekday-options","is-dark","onSave","onClose"]),(0,l.bF)(E,{modelValue:o.playlistMediaDialog,"onUpdate:modelValue":a[4]||(a[4]=e=>o.playlistMediaDialog=e),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(w,{style:{"min-width":"700px","max-width":"900px"},class:(0,$.C4)({"bg-dark text-white":o.isDarkMode})},{default:(0,l.k6)((()=>[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",ma," Gestionar Medios - "+(0,$.v_)(o.selectedPlaylist?.name),1)])),_:1}),(0,l.bF)(k,{class:"q-pt-none"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",pa,[(0,l.Lk)("div",ga,[a[9]||(a[9]=(0,l.Lk)("div",{class:"text-subtitle2 q-mb-md"},"Medios Disponibles",-1)),(0,l.bF)(_,{bordered:"",class:(0,$.C4)(["available-media-list",{"bg-grey-9":o.isDarkMode}])},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.availableMedia,(e=>((0,l.uX)(),(0,l.Wv)(L,{key:e.id,clickable:"",onClick:a=>o.addMediaToPlaylist(e)},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{name:o.getMediaIcon(e.media_type||e.file_type)},null,8,["name"])])),_:2},1024),(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,$.v_)(e.filename),1)])),_:2},1024),(0,l.bF)(y,{caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,$.v_)(e.media_type||e.file_type),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(f,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",round:"",icon:"add",size:"sm"})])),_:1})])),_:2},1032,["onClick"])))),128)),0===o.availableMedia.length?((0,l.uX)(),(0,l.Wv)(L,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(y,{class:"text-center text-grey"},{default:(0,l.k6)((()=>a[8]||(a[8]=[(0,l.eW)("No hay medios disponibles")]))),_:1,__:[8]})])),_:1})])),_:1})):(0,l.Q3)("",!0)])),_:1},8,["class"])]),(0,l.Lk)("div",va,[a[11]||(a[11]=(0,l.Lk)("div",{class:"text-subtitle2 q-mb-md"},"Medios en Playlist",-1)),(0,l.bF)(_,{bordered:"",class:(0,$.C4)(["playlist-media-list",{"bg-grey-9":o.isDarkMode}])},{default:(0,l.k6)((()=>[(0,l.bF)(F,{modelValue:o.playlistMedias,"onUpdate:modelValue":a[3]||(a[3]=e=>o.playlistMedias=e),onEnd:o.reorderPlaylistMedia,"item-key":"id"},{item:(0,l.k6)((({element:e,index:a})=>[(0,l.bF)(L,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{name:"drag_handle"})])),_:1}),(0,l.bF)(f,{avatar:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{name:o.getMediaIcon(e.media_type||e.file_type)},null,8,["name"])])),_:2},1024),(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,$.v_)(e.filename),1)])),_:2},1024),(0,l.bF)(y,{caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,$.v_)(e.media_type||e.file_type)+" - Orden: "+(0,$.v_)(a+1),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(f,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",round:"",icon:"remove",size:"sm",onClick:a=>o.removeMediaFromPlaylist(e.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue","onEnd"]),0===o.playlistMedias.length?((0,l.uX)(),(0,l.Wv)(L,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(y,{class:"text-center text-grey"},{default:(0,l.k6)((()=>a[10]||(a[10]=[(0,l.eW)("No hay medios en esta playlist")]))),_:1,__:[10]})])),_:1})])),_:1})):(0,l.Q3)("",!0)])),_:1},8,["class"])])])])),_:1}),(0,l.bF)(C,{align:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",label:"Cerrar",onClick:o.closePlaylistMediaDialog},null,8,["onClick"])])),_:1})])),_:1},8,["class"])])),_:1},8,["modelValue"])])}var ka=t(661);const fa={class:"info-card stats-card"},ya={class:"stats-grid"},ba={class:"stat-item media-stat"},La={class:"stat-icon"},_a={class:"stat-info"},Fa={class:"stat-item playlist-stat"},Ca={class:"stat-icon"},wa={class:"stat-info"},Ea={class:"stat-item schedule-stat"},Pa={class:"stat-icon"},Sa={class:"stat-info"},Ma={class:"stat-item business-stat"},Aa={class:"stat-icon"},$a={class:"stat-info"};var Da={__name:"StatisticsCard",props:{stats:Object,businessInfo:Object},setup(e){return(a,t)=>{const o=(0,l.g2)("q-icon");return(0,l.uX)(),(0,l.CE)("div",fa,[t[4]||(t[4]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Estadísticas del Sistema")],-1)),(0,l.Lk)("div",ya,[(0,l.Lk)("div",ba,[(0,l.Lk)("div",La,[(0,l.bF)(o,{name:"video_library",size:"2rem"})]),(0,l.Lk)("div",_a,[(0,l.Lk)("h4",null,(0,$.v_)(e.stats.totalMedia),1),t[0]||(t[0]=(0,l.Lk)("p",null,"Archivos Multimedia",-1))])]),(0,l.Lk)("div",Fa,[(0,l.Lk)("div",Ca,[(0,l.bF)(o,{name:"playlist_play",size:"2rem"})]),(0,l.Lk)("div",wa,[(0,l.Lk)("h4",null,(0,$.v_)(e.stats.totalPlaylists),1),t[1]||(t[1]=(0,l.Lk)("p",null,"Playlists Creadas",-1))])]),(0,l.Lk)("div",Ea,[(0,l.Lk)("div",Pa,[(0,l.bF)(o,{name:"schedule",size:"2rem"})]),(0,l.Lk)("div",Sa,[(0,l.Lk)("h4",null,(0,$.v_)(e.stats.totalScheduledItems),1),t[2]||(t[2]=(0,l.Lk)("p",null,"Elementos Programados",-1))])]),(0,l.Lk)("div",Ma,[(0,l.Lk)("div",Aa,[(0,l.bF)(o,{name:"business",size:"2rem"})]),(0,l.Lk)("div",$a,[(0,l.Lk)("h4",null,(0,$.v_)(e.businessInfo.name||"N/A"),1),t[3]||(t[3]=(0,l.Lk)("p",null,"Negocio Configurado",-1))])])])])}}};const Ta=(0,c.A)(Da,[["__scopeId","data-v-ed43a590"]]);var Ia=Ta;const xa={class:"info-card playlists-card"},qa={class:"card-header"},Ua={class:"playlists-content"},za={key:0,class:"empty-state"},Ba={key:1,class:"playlists-grid"},Ra={class:"playlist-icon"},Va={class:"playlist-info"},Xa={class:"playlist-meta"},Na={class:"playlist-date"},Wa={class:"playlist-actions"};var Ka={__name:"PlaylistManagement",props:{playlists:Array},setup(e){const a=e=>e?new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"Fecha no disponible";return(t,o)=>{const n=(0,l.g2)("q-icon"),s=(0,l.g2)("q-btn"),i=(0,l.g2)("q-chip");return(0,l.uX)(),(0,l.CE)("div",xa,[(0,l.Lk)("div",qa,[(0,l.bF)(n,{name:"playlist_play",size:"2rem"}),o[2]||(o[2]=(0,l.Lk)("div",{class:"header-text"},[(0,l.Lk)("h3",null,"Gestión de Playlists"),(0,l.Lk)("p",null,"Crear y administrar listas de reproducción")],-1)),(0,l.bF)(s,{color:"primary",icon:"add",label:"Nueva Playlist",onClick:o[0]||(o[0]=e=>t.$emit("create")),rounded:"","no-caps":""})]),(0,l.Lk)("div",Ua,[0===e.playlists.length?((0,l.uX)(),(0,l.CE)("div",za,[(0,l.bF)(n,{name:"playlist_add",size:"3rem"}),o[3]||(o[3]=(0,l.Lk)("p",null,"No hay playlists creadas",-1)),(0,l.bF)(s,{flat:"",color:"primary",label:"Crear primera playlist",onClick:o[1]||(o[1]=e=>t.$emit("create"))})])):((0,l.uX)(),(0,l.CE)("div",Ba,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.playlists,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"playlist-item"},[(0,l.Lk)("div",Ra,[(0,l.bF)(n,{name:"queue_music",size:"1.5rem"})]),(0,l.Lk)("div",Va,[(0,l.Lk)("h4",null,(0,$.v_)(e.name),1),(0,l.Lk)("p",null,(0,$.v_)(e.description||"Sin descripción"),1),(0,l.Lk)("div",Xa,[(0,l.bF)(i,{size:"sm",color:"primary","text-color":"white"},{default:(0,l.k6)((()=>[(0,l.eW)((0,$.v_)(e.media_count||0)+" medios ",1)])),_:2},1024),(0,l.Lk)("span",Na,(0,$.v_)(a(e.created_at)),1)])]),(0,l.Lk)("div",Wa,[(0,l.bF)(s,{flat:"",round:"",icon:"video_library",size:"sm",color:"secondary",title:"Gestionar medios",onClick:a=>t.$emit("manage",e)},null,8,["onClick"]),(0,l.bF)(s,{flat:"",round:"",icon:"schedule",size:"sm",color:"orange",title:"Programar playlist",onClick:a=>t.$emit("schedule",e)},null,8,["onClick"]),(0,l.bF)(s,{flat:"",round:"",icon:"edit",size:"sm",color:"primary",title:"Editar",onClick:a=>t.$emit("edit",e)},null,8,["onClick"]),(0,l.bF)(s,{flat:"",round:"",icon:"delete",size:"sm",color:"negative",title:"Eliminar",onClick:a=>t.$emit("delete",e.id)},null,8,["onClick"])])])))),128))]))])])}}};const Oa=(0,c.A)(Ka,[["__scopeId","data-v-56cea820"]]);var Qa=Oa,ja=t(503);const Ga={class:"info-card actions-card"},Ha={class:"actions-grid"};var Ja={__name:"QuickActions",emits:["logout"],setup(e){const a=(0,m.rd)(),t=()=>{a.push("/media")},o=()=>{a.push("/test-ok")};return(e,n)=>{const s=(0,l.g2)("q-icon");return(0,l.uX)(),(0,l.CE)("div",Ga,[n[8]||(n[8]=(0,l.Lk)("div",{class:"card-title"},[(0,l.Lk)("h3",null,"Acciones Rápidas")],-1)),(0,l.Lk)("div",Ha,[(0,l.Lk)("div",{class:"action-button primary-action",onClick:n[0]||(n[0]=e=>(0,_.R1)(a).push("/config"))},[(0,l.bF)(s,{name:"settings",size:"2rem"}),n[3]||(n[3]=(0,l.Lk)("span",null,"Configuración del Negocio",-1))]),(0,l.Lk)("div",{class:"action-button secondary-action",onClick:n[1]||(n[1]=e=>(0,_.R1)(a).push("/player"))},[(0,l.bF)(s,{name:"play_circle",size:"2rem"}),n[4]||(n[4]=(0,l.Lk)("span",null,"Reproductor",-1))]),(0,l.Lk)("div",{class:"action-button accent-action",onClick:t},[(0,l.bF)(s,{name:"folder",size:"2rem"}),n[5]||(n[5]=(0,l.Lk)("span",null,"Explorar Media",-1))]),(0,l.Lk)("div",{class:"action-button info-action",onClick:o},[(0,l.bF)(s,{name:"support_agent",size:"2rem"}),n[6]||(n[6]=(0,l.Lk)("span",null,"Asistencia",-1))]),(0,l.Lk)("div",{class:"action-button warning-action",onClick:n[2]||(n[2]=a=>e.$emit("logout"))},[(0,l.bF)(s,{name:"logout",size:"2rem"}),n[7]||(n[7]=(0,l.Lk)("span",null,"Cerrar Sesión",-1))])])])}}};const Za=(0,c.A)(Ja,[["__scopeId","data-v-ac02aafe"]]);var Ya=Za;const et={class:"text-h6"};var at={__name:"PlaylistDialog",props:{modelValue:Boolean,playlist:Object,form:Object,loading:Boolean,isDark:Boolean},emits:["update:modelValue","save","close"],setup(e){return(a,t)=>{const o=(0,l.g2)("q-card-section"),n=(0,l.g2)("q-input"),s=(0,l.g2)("q-btn"),i=(0,l.g2)("q-card-actions"),r=(0,l.g2)("q-card"),c=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.Wv)(c,{"model-value":e.modelValue,"onUpdate:modelValue":t[4]||(t[4]=e=>a.$emit("update:modelValue",e)),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{style:{"min-width":"400px"},class:(0,$.C4)({"bg-dark text-white":e.isDark})},{default:(0,l.k6)((()=>[(0,l.bF)(o,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",et,(0,$.v_)(e.playlist?"Editar Playlist":"Nueva Playlist"),1)])),_:1}),(0,l.bF)(o,{class:"q-pt-none"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.name=a),label:"Nombre de la playlist",outlined:"",class:"q-mb-md"},null,8,["modelValue"]),(0,l.bF)(n,{modelValue:e.form.description,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.description=a),label:"Descripción (opcional)",type:"textarea",outlined:"",rows:"3"},null,8,["modelValue"])])),_:1}),(0,l.bF)(i,{align:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{flat:"",label:"Cancelar",onClick:t[2]||(t[2]=e=>a.$emit("close"))}),(0,l.bF)(s,{color:"primary",label:"Guardar",loading:e.loading,onClick:t[3]||(t[3]=e=>a.$emit("save"))},null,8,["loading"])])),_:1})])),_:1},8,["class"])])),_:1},8,["model-value"])}}};const tt=at;var ot=tt,lt=t(714),nt={__name:"ScheduleDialog",props:{modelValue:Boolean,form:Object,loading:Boolean,isDark:Boolean,weekdayOptions:Array},emits:["update:modelValue","save","close"],setup(e){return(a,t)=>{const o=(0,l.g2)("q-card-section"),n=(0,l.g2)("q-input"),s=(0,l.g2)("q-btn"),i=(0,l.g2)("q-card-actions"),r=(0,l.g2)("q-card"),c=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.Wv)(c,{"model-value":e.modelValue,"onUpdate:modelValue":t[3]||(t[3]=e=>a.$emit("update:modelValue",e)),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{style:{"min-width":"400px"},class:(0,$.C4)({"bg-dark text-white":e.isDark})},{default:(0,l.k6)((()=>[(0,l.bF)(o,null,{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.Lk)("div",{class:"text-h6"},"Programar Contenido",-1)]))),_:1,__:[4]}),(0,l.bF)(o,{class:"q-pt-none"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{modelValue:e.form.contentName,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.contentName=a),label:"Nombre",outlined:"",class:"q-mb-md"},null,8,["modelValue"])])),_:1}),(0,l.bF)(i,{align:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{flat:"",label:"Cancelar",onClick:t[1]||(t[1]=e=>a.$emit("close"))}),(0,l.bF)(s,{color:"primary",label:"Guardar",loading:e.loading,onClick:t[2]||(t[2]=e=>a.$emit("save"))},null,8,["loading"])])),_:1})])),_:1},8,["class"])])),_:1},8,["model-value"])}}};const st=nt;var it=st;function rt(){const e=(0,_.KR)([]),a=(0,_.Kh)({totalPlaylists:0,totalScheduledItems:0,totalMedia:0}),t=(0,C.dj)(),o=async()=>{try{const{data:a}=await w.fP.list();e.value=a}catch(a){t.error("Error cargando playlists")}},l=async()=>{try{const[e,t]=await Promise.all([w.fP.getStats(),w.DX.list()]);a.totalPlaylists=e.data.total_playlists,a.totalScheduledItems=e.data.total_scheduled_items,a.totalMedia=t.data.length}catch(e){t.error("Error cargando estadísticas")}},n=async e=>{await w.fP.create(e),await o(),await l()},s=async(e,a)=>{await w.fP.update(e,a),await o(),await l()},i=async e=>{await w.fP.delete(e),await o(),await l()};return{playlists:e,stats:a,loadPlaylists:o,loadStats:l,createPlaylist:n,updatePlaylist:s,removePlaylist:i}}function ct(){const e=(0,_.KR)([]),a=(0,C.dj)(),t=async()=>{try{const{data:a}=await w.DX.list();e.value=a}catch(t){a.error("Error cargando medios")}},o=async e=>{await w.DX.delete(e),await t()};return{mediaFiles:e,loadMedia:t,removeMedia:o}}function dt(){const e=(0,_.KR)([]),a=(0,C.dj)(),t=async()=>{try{const{data:a}=await w.gr.list();e.value=a}catch(t){a.error("Error cargando programaciones")}},o=async e=>{await w.gr.create(e),await t()};return{schedules:e,loadSchedules:t,createSchedule:o}}var ut=t(891),mt=t(432),pt=t.n(mt),gt={name:"AdminView",components:{MediaUploader:ka.A,ThemeToggle:P.A,StatisticsCard:Ia,PlaylistManagement:Qa,MediaGallery:ja.A,QuickActions:Ya,PlaylistDialog:ot,EditMediaDialog:lt.A,ScheduleDialog:it,draggable:pt()},setup(){const e=(0,m.rd)(),a=(0,F.Jud)(),t=(0,C.dj)(),{isDarkMode:o}=(0,E.D)(),{backendBaseUrl:n}=(0,ut.f)(),s=(0,_.KR)(!1),i=(0,_.KR)(!1),r=(0,_.KR)(!1),c=(0,_.KR)(!1),d=(0,_.Kh)({name:"",description:""}),u=(0,_.Kh)({filename:"",description:""}),p=(0,_.Kh)({contentName:""}),g=(0,_.KR)(!1),v=(0,_.KR)(!1),h=(0,_.KR)(!1),k=(0,_.KR)(!1),{playlists:f,stats:y,loadPlaylists:b,loadStats:L,createPlaylist:P,updatePlaylist:S,removePlaylist:M}=rt(),{mediaFiles:A,loadMedia:$,removeMedia:D}=ct(),{loadSchedules:T}=dt(),I=(0,_.Kh)({name:"",logo:null}),x=(0,_.KR)(null),q=(0,_.KR)(null),U=(0,_.KR)(null),z=(0,_.KR)([]),B=(0,_.KR)([]),R=[{label:"Lun",value:0},{label:"Mar",value:1},{label:"Mié",value:2},{label:"Jue",value:3},{label:"Vie",value:4},{label:"Sáb",value:5},{label:"Dom",value:6}],V=async()=>{await Promise.all([b(),$(),L(),T(),X()])},X=async()=>{try{const e=await w.ZK.get();Object.assign(I,e.data)}catch(e){console.error("Error loading business info:",e),I.name="Signance System",I.logo=null}},N=()=>{x.value=null,d.name="",d.description="",s.value=!0},W=e=>{x.value=e,d.name=e.name,d.description=e.description||"",s.value=!0},K=async()=>{g.value=!0;try{x.value?await S(x.value.id,d):await P(d),s.value=!1}finally{g.value=!1}},O=async e=>{await M(e)},Q=()=>{$(),L()},j=()=>{t.error("Error subiendo archivo")},G=e=>{q.value=e,u.filename=e.filename,u.description=e.description,i.value=!0},H=async()=>{i.value=!1},J=async e=>{await D(e),L()},Z=e=>{p.contentName=e.name,r.value=!0},Y=async e=>{U.value=e;try{const a=await fetch(`${n.value}/api/playlists/${e.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("signance_token")}`}}),t=await a.json();B.value=t.medias||[];const o=new Set(B.value.map((e=>e.id)));z.value=A.value.filter((e=>!o.has(e.id))),c.value=!0}catch(a){t.error("Error cargando datos de playlist"),console.error("Error loading playlist media:",a)}},ee=()=>{c.value=!1,U.value=null,z.value=[],B.value=[]},ae=()=>{s.value=!1},te=()=>{i.value=!1},oe=()=>{r.value=!1},le=async()=>{h.value=!1,r.value=!1},ne=()=>{localStorage.removeItem("signance_token"),e.push("/login")},se=async e=>{try{const a=await fetch(`${n.value}/api/playlists/${U.value.id}/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("signance_token")}`},body:JSON.stringify({media_id:e.id})});if(!a.ok)throw new Error("Error en la respuesta del servidor");z.value=z.value.filter((a=>a.id!==e.id)),B.value.push({...e,order_index:B.value.length}),t.success(`"${e.filename}" añadido a la playlist`)}catch(a){t.error("Error añadiendo medio a la playlist"),console.error("Error adding media to playlist:",a)}},ie=async e=>{try{const a=await fetch(`${n.value}/api/playlists/${U.value.id}/media/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("signance_token")}`}});if(!a.ok)throw new Error("Error en la respuesta del servidor");{const a=B.value.find((a=>a.id===e));a&&(B.value=B.value.filter((a=>a.id!==e)),z.value.push(a),t.success(`"${a.filename}" removido de la playlist`))}}catch(a){t.error("Error removiendo medio de la playlist"),console.error("Error removing media from playlist:",a)}},re=async()=>{try{const e=B.value.map(((e,a)=>({media_id:e.id,order_index:a}))),a=await fetch(`${n.value}/api/playlists/${U.value.id}/reorder`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("signance_token")}`},body:JSON.stringify({media_order:e})});if(!a.ok)throw new Error("Error en la respuesta del servidor");t.success("Orden actualizado")}catch(e){t.error("Error reordenando medios"),console.error("Error reordering media:",e)}},ce=e=>{if(!e)return"description";const a=e.toLowerCase();return a.includes("image")?"image":a.includes("video")?"videocam":a.includes("audio")?"audiotrack":a.includes("pdf")?"picture_as_pdf":"description"};return(0,l.sV)((async()=>{V(),a.dark.set(o.value)})),(0,l.wB)(o,(e=>{a.dark.set(e)})),{backendBaseUrl:n,playlistDialog:s,editMediaDialog:i,scheduleDialog:r,playlistMediaDialog:c,playlistForm:d,editMediaForm:u,scheduleForm:p,savingPlaylist:g,savingMedia:v,savingSchedule:h,mediaLoading:k,playlists:f,stats:y,mediaFiles:A,businessInfo:I,editingPlaylist:x,editingMedia:q,selectedPlaylist:U,availableMedia:z,playlistMedias:B,weekdayOptions:R,isDarkMode:o,loadMedia:$,showCreatePlaylistDialog:N,editPlaylist:W,savePlaylist:K,deletePlaylist:O,managePlaylistMedia:Y,closePlaylistMediaDialog:ee,schedulePlaylist:Z,onMediaUploaded:Q,onMediaUploadError:j,editMedia:G,saveMediaChanges:H,deleteMedia:J,saveSchedule:le,closePlaylistDialog:ae,closeEditMediaDialog:te,closeScheduleDialog:oe,logout:ne,addMediaToPlaylist:se,removeMediaFromPlaylist:ie,reorderPlaylistMedia:re,getMediaIcon:ce}}};const vt=(0,c.A)(gt,[["render",ha],["__scopeId","data-v-2388a27e"]]);var ht=vt;const kt=[{path:"/",name:"Selection",component:ta,meta:{requiresAuth:!1,title:"Pochtecayotl Signance System"}},{path:"/login",name:"Login",component:A,meta:{requiresAuth:!1,title:"Iniciar Sesión - Pochtecayotl Signance System"}},{path:"/config",name:"Config",component:la["default"],meta:{requiresAuth:!1,title:"Configuración - Pochtecayotl Signance System"}},{path:"/test-ok",name:"TestOk",component:se,meta:{requiresAuth:!0,title:"Prueba Exitosa - Pochtecayotl Signance System"}},{path:"/error",name:"Error",component:Ke,meta:{requiresAuth:!1,title:"Error - Pochtecayotl Signance System"}},{path:"/player",name:"Player",component:oa["default"],meta:{requiresAuth:!1,title:"Reproductor - Pochtecayotl Signance System"}},{path:"/admin",name:"Admin",component:ht,meta:{requiresAuth:!0,role:"admin",title:"Dashboard Admin - Pochtecayotl Signance System"}},{path:"/config-admin",name:"ConfigAdmin",component:()=>Promise.resolve().then(t.bind(t,600)),meta:{requiresAuth:!0,role:"admin"}},{path:"/media",name:"MediaManager",component:()=>t.e(403).then(t.bind(t,403)),meta:{requiresAuth:!0,role:"admin"}},{path:"/player-admin",name:"PlayerAdmin",component:()=>Promise.resolve().then(t.bind(t,642)),meta:{requiresAuth:!0}}],ft=(0,m.aE)({history:(0,m.LA)("/"),routes:kt});ft.beforeEach(((e,a,t)=>{document.title=e.meta.title||"Pochtecayotl Signance System";const o=localStorage.getItem("signance_token"),l=!!o;e.matched.some((e=>e.meta.requiresAuth))?l?t():t({path:"/login",query:{redirect:e.fullPath}}):t()}));var yt=ft,bt=t(388),Lt=t(86);t(917);const _t=(0,o.Ef)(u);console.log("🎬 Pochtecayotl Signance System - Frontend iniciado"),_t.use(F.y87,{plugins:{Notify:F.M9W,Dialog:F.lGe,Loading:F.Rhj},components:{QCard:F.C$d,QCardSection:F.XH8,QCardActions:F.zZw,QBtn:F.IlC,QInput:F.ieb,QForm:F.iXO,QPage:F.Tuf,QPageContainer:F.kci,QLayout:F.QQm,QHeader:F.rpC,QToolbar:F.ZVc,QToolbarTitle:F.r_C,QDrawer:F.psX,QList:F.Mbi,QItem:F.H0$,QItemSection:F.ypq,QItemLabel:F.TwD,QSeparator:F.N7v,QIcon:F.bP4,QSpinner:F.$fs,QLinearProgress:F.GFm,QFile:F.mt8,QUploader:F.IuS,QTable:F.kH6,QTh:F.EJt,QTr:F.qhW,QTd:F.Efd,QSelect:F.Sic,QDate:F.wZt,QTime:F.TpF,QToggle:F.c5C,QDialog:F.OQI,QExpansionItem:F.AIx,QTooltip:F.nCc,QBanner:F.GrT,QBtnToggle:F.QL$,QSkeleton:F.Rf8},lang:bt.A,iconSet:Lt.A,config:{notify:{position:"top-right",timeout:3e3}}});const Ft={position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1};_t.use(C.Ay,Ft),_t.use(yt),(0,w.X3)().catch((e=>{console.warn("⚠️ No se pudo conectar al backend al iniciar:",e.message),console.log("🔄 La detección se reintentará automáticamente en las próximas peticiones")})),_t.mount("#app")},349:function(e,a,t){t.d(a,{A:function(){return i}});const o={BACKEND_PREFERRED_PORT:8e3,PORT_RANGE:{start:8e3,end:8010},HEALTH_ENDPOINT:"/health",CONNECTION_TIMEOUT:3e3};function l(){const e=window.location.hostname,a=[];if(console.log(`🔍 Detectando IPs candidatas desde: ${e}`),"localhost"!==e&&"127.0.0.1"!==e&&(a.push(e),console.log(`✅ Agregando IP actual del frontend: ${e}`)),a.push("127.0.0.1","localhost"),"localhost"!==e&&"127.0.0.1"!==e){const t=e.split(".");if(4===t.length&&t.every((e=>!isNaN(e)))){const e=`${t[0]}.${t[1]}.${t[2]}`;console.log(`🌐 Generando IPs de la red: ${e}.x`);const o=[1,10,50,100,150,200,254];for(const t of o)a.push(`${e}.${t}`)}}const t=["192.168.1","192.168.0","192.168.100","192.168.10","10.0.0","10.0.1","10.1.1","172.16.0","172.16.1"];for(const l of t)e.startsWith(l)||a.push(`${l}.1`,`${l}.100`,`${l}.10`);const o=[...new Set(a)];return console.log(`🎯 ${o.length} IPs candidatas generadas:`,o),o}class n{constructor(){this.detectedPort=null,this.detectedBaseUrl=null,this.portRange=o.PORT_RANGE,this.testEndpoint=o.HEALTH_ENDPOINT,this.preferredPort=o.BACKEND_PREFERRED_PORT,this.connectionTimeout=o.CONNECTION_TIMEOUT}getCurrentHost(){const e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"127.0.0.1":e}getCandidateHosts(){return l()}async detectBackend(){if(console.log("🔍 Iniciando detección automática del backend..."),console.log(`🎯 Puerto preferido: ${this.preferredPort}`),console.log(`📊 Rango de puertos: ${this.portRange.start}-${this.portRange.end}`),this.detectedPort&&this.detectedBaseUrl){console.log(`⚡ Probando configuración previa: ${this.detectedBaseUrl}`);const e=new URL(this.detectedBaseUrl).hostname;if(await this.testSpecificHostPort(e,this.detectedPort))return console.log(`✅ Backend confirmado en configuración previa: ${this.detectedBaseUrl}`),{port:this.detectedPort,baseUrl:this.detectedBaseUrl};console.log("❌ Configuración previa no responde, buscando nuevamente..."),this.detectedPort=null,this.detectedBaseUrl=null}const e=this.getCandidateHosts();console.log(`🎯 ${e.length} hosts candidatos detectados`),console.log(`🚀 FASE 1: Probando puerto preferido ${this.preferredPort} en todas las IPs...`);for(const a of e)if(console.log(`🔍 Probando ${a}:${this.preferredPort}`),await this.testSpecificHostPort(a,this.preferredPort))return this.detectedPort=this.preferredPort,this.detectedBaseUrl=`http://${a}:${this.preferredPort}`,console.log(`✅ ¡Backend encontrado en puerto preferido! ${this.detectedBaseUrl}`),this.saveToLocalStorage(a,this.preferredPort),{port:this.detectedPort,baseUrl:this.detectedBaseUrl};console.log(`🔍 FASE 2: Buscando en rango completo ${this.portRange.start}-${this.portRange.end}...`);for(const a of e){console.log(`🔍 Probando host: ${a}`);for(let e=this.portRange.start;e<=this.portRange.end;e++)if(e!==this.preferredPort&&(console.log(`🔍 Probando puerto ${e} en ${a}...`),await this.testSpecificHostPort(a,e)))return this.detectedPort=e,this.detectedBaseUrl=`http://${a}:${e}`,console.log(`✅ ¡Backend encontrado en ${this.detectedBaseUrl}!`),this.saveToLocalStorage(a,e),{port:this.detectedPort,baseUrl:this.detectedBaseUrl}}throw new Error(`❌ No se pudo encontrar el backend en ningún host candidato (${e.join(", ")}) en puertos ${this.portRange.start}-${this.portRange.end}`)}async testPort(e){if(this.detectedBaseUrl){const a=new URL(this.detectedBaseUrl).hostname;return await this.testSpecificHostPort(a,e)}const a=window.location.hostname;return await this.testSpecificHostPort(a,e)}async testSpecificHostPort(e,a){const t=`http://${e}:${a}`;try{const o=new AbortController,l=setTimeout((()=>o.abort()),3e3),n=await fetch(`${t}${this.testEndpoint}`,{method:"GET",signal:o.signal,mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(l),n.ok){const t=await n.json();if("healthy"===t.status||"auth"===t.module||200===n.status)return console.log(`✅ Puerto ${a} en ${e}: Backend FastAPI confirmado - ${JSON.stringify(t)}`),!0}}catch(o){"AbortError"===o.name?console.log(`⏱️ Puerto ${a} en ${e}: Timeout (3s)`):console.log(`❌ Puerto ${a} en ${e}: ${o.message}`)}return!1}getCachedBackend(){const e=localStorage.getItem("signance_backend_port"),a=localStorage.getItem("signance_backend_url"),t=localStorage.getItem("signance_backend_host"),o=window.location.hostname;return t&&t!==o?(console.log(`🔄 Host cambió de ${t} a ${o}, limpiando caché...`),this.clearCache(),null):e&&a?{port:parseInt(e),baseUrl:a}:null}clearCache(){localStorage.removeItem("signance_backend_port"),localStorage.removeItem("signance_backend_url"),localStorage.removeItem("signance_backend_host"),this.detectedPort=null,this.detectedBaseUrl=null}startHealthCheck(e){this.healthCheckInterval&&clearInterval(this.healthCheckInterval),this.healthCheckInterval=setInterval((async()=>{if(this.detectedPort){const a=await this.testPort(this.detectedPort);!a&&e&&(console.log("❌ Conexión con backend perdida"),e())}}),3e4)}stopHealthCheck(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}saveToLocalStorage(e,a){const t=`http://${e}:${a}`;localStorage.setItem("signance_backend_port",a.toString()),localStorage.setItem("signance_backend_url",t),localStorage.setItem("signance_backend_host",e),console.log(`💾 Configuración guardada: ${t}`)}}const s=new n;var i=s},503:function(e,a,t){t.d(a,{A:function(){return ae}});var o=t(641),l=t(33),n=t(953);const s={class:"media-preview"},i={key:0,class:"image-preview"},r=["src","alt"],c={key:1,class:"video-preview"},d=["src"],u={class:"video-overlay"},m={key:0,class:"video-duration"},p={key:2,class:"file-preview"},g={class:"media-info"},v=["title"],h={class:"media-meta"},k={class:"file-size"},f={key:0,class:"upload-date"},y={class:"media-actions"};var b={__name:"MediaCard",props:{media:{type:Object,required:!0},backendBaseUrl:{type:String,default:""},compact:{type:Boolean,default:!1}},emits:["edit","delete"],setup(e){const a=e,t=(0,o.EW)((()=>{const e=a.backendBaseUrl||"",t=a.media.file_url||`/uploads/${a.media.served_filename||a.media.filename}`;return`${e}${t}`})),n=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"image"===e||/\.(jpg|jpeg|png|gif|webp|bmp)$/i.test(a.media.filename)})),b=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"video"===e||/\.(mp4|avi|mov|mkv|webm)$/i.test(a.media.filename)})),L=()=>{const e=a.media.filename||"",t=e.split(".").pop()?.toLowerCase();switch(t){case"pdf":return"picture_as_pdf";case"doc":case"docx":return"description";case"mp3":case"wav":case"aac":return"audiotrack";default:return"insert_drive_file"}},_=e=>{if(!e)return"N/A";const a=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+a[t]},F=e=>{if(!e)return"";const a=Math.floor(e/60),t=Math.floor(e%60);return`${a}:${t.toString().padStart(2,"0")}`},C=e=>{if(!e)return"";const a=new Date(e);return a.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})},w=e=>{const a=e.target,t=a.closest(".image-preview");t&&(t.innerHTML='\n      <div class="file-preview">\n        <q-icon name="broken_image" size="3rem" color="grey-6" />\n      </div>\n    ')},E=e=>{const a=e.target,t=a.closest(".video-preview");t&&(t.innerHTML='\n      <div class="file-preview">\n        <q-icon name="error" size="3rem" color="grey-6" />\n      </div>\n    ')};return(a,P)=>{const S=(0,o.g2)("q-icon"),M=(0,o.g2)("q-tooltip"),A=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.CE)("div",{class:(0,l.C4)(["media-card",{"compact-card":e.compact}])},[(0,o.Lk)("div",s,[n.value?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("img",{src:t.value,alt:e.media.filename,onError:w,class:"preview-img"},null,40,r)])):b.value?((0,o.uX)(),(0,o.CE)("div",c,[(0,o.Lk)("video",{src:t.value,class:"preview-video",muted:"",preload:"metadata",onError:E},null,40,d),(0,o.Lk)("div",u,[(0,o.bF)(S,{name:"play_circle_filled",size:"2.5rem",class:"play-icon"}),e.media.duration?((0,o.uX)(),(0,o.CE)("div",m,(0,l.v_)(F(e.media.duration)),1)):(0,o.Q3)("",!0)])])):((0,o.uX)(),(0,o.CE)("div",p,[(0,o.bF)(S,{name:L(),size:"3rem",color:"grey-6"},null,8,["name"])]))]),(0,o.Lk)("div",g,[(0,o.Lk)("h4",{class:"media-title",title:e.media.filename},(0,l.v_)(e.media.filename),9,v),(0,o.Lk)("p",h,[(0,o.Lk)("span",k,(0,l.v_)(_(e.media.file_size||e.media.size)),1),e.media.created_at?((0,o.uX)(),(0,o.CE)("span",f,(0,l.v_)(C(e.media.created_at)),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",y,[(0,o.bF)(A,{flat:"",round:"",icon:"edit",onClick:P[0]||(P[0]=e=>a.$emit("edit")),size:"sm",color:"primary"},{default:(0,o.k6)((()=>[(0,o.bF)(M,null,{default:(0,o.k6)((()=>P[2]||(P[2]=[(0,o.eW)("Editar")]))),_:1,__:[2]})])),_:1}),(0,o.bF)(A,{flat:"",round:"",icon:"delete",onClick:P[1]||(P[1]=e=>a.$emit("delete")),size:"sm",color:"negative"},{default:(0,o.k6)((()=>[(0,o.bF)(M,null,{default:(0,o.k6)((()=>P[3]||(P[3]=[(0,o.eW)("Eliminar")]))),_:1,__:[3]})])),_:1})])],2)}}},L=t(262);const _=(0,L.A)(b,[["__scopeId","data-v-0ad5556d"]]);var F=_;const C={class:"media-list-item"},w={class:"media-thumbnail"},E={key:0,class:"image-thumb"},P=["src","alt"],S={key:1,class:"video-thumb"},M=["src"],A={key:2,class:"file-thumb"},$={class:"media-details"},D={class:"media-name"},T={key:0},I={class:"media-metadata"},x={class:"meta-item"},q={class:"meta-item"},U={key:0,class:"meta-item"},z={key:1,class:"meta-item"},B={class:"media-list-actions"};var R={__name:"MediaListItem",props:{media:{type:Object,required:!0},backendBaseUrl:{type:String,default:""}},emits:["edit","delete"],setup(e){const a=e,t=(0,o.EW)((()=>{const e=a.backendBaseUrl||"",t=a.media.file_url||`/uploads/${a.media.served_filename||a.media.filename}`;return`${e}${t}`})),n=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"image"===e||/\.(jpg|jpeg|png|gif|webp|bmp)$/i.test(a.media.filename)})),s=(0,o.EW)((()=>{const e=a.media.file_type||a.media.media_type||"";return"video"===e||/\.(mp4|avi|mov|mkv|webm)$/i.test(a.media.filename)})),i=()=>{const e=a.media.filename||"",t=e.split(".").pop()?.toLowerCase();switch(t){case"pdf":return"picture_as_pdf";case"doc":case"docx":return"description";case"mp3":case"wav":case"aac":return"audiotrack";default:return"insert_drive_file"}},r=()=>{const e=a.media.file_type||a.media.media_type;if(e)return e.charAt(0).toUpperCase()+e.slice(1);const t=a.media.filename||"",o=t.split(".").pop()?.toLowerCase();return o?o.toUpperCase():"Archivo"},c=e=>{if(!e)return"N/A";const a=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+a[t]},d=e=>{if(!e)return"";const a=Math.floor(e/60),t=Math.floor(e%60);return`${a}:${t.toString().padStart(2,"0")}`},u=e=>{if(!e)return"";const a=new Date(e);return a.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},m=e=>{const a=e.target,t=a.closest(".image-thumb");t&&(t.innerHTML='\n      <div class="file-thumb">\n        <q-icon name="broken_image" size="2rem" color="grey-6" />\n      </div>\n    ')},p=e=>{const a=e.target,t=a.closest(".video-thumb");t&&(t.innerHTML='\n      <div class="file-thumb">\n        <q-icon name="error" size="2rem" color="grey-6" />\n      </div>\n    ')};return(a,g)=>{const v=(0,o.g2)("q-icon"),h=(0,o.g2)("q-tooltip"),k=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",w,[n.value?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("img",{src:t.value,alt:e.media.filename,onError:m},null,40,P)])):s.value?((0,o.uX)(),(0,o.CE)("div",S,[(0,o.Lk)("video",{src:t.value,muted:"",preload:"metadata",onError:p},null,40,M),(0,o.bF)(v,{name:"play_circle_filled",class:"play-overlay"})])):((0,o.uX)(),(0,o.CE)("div",A,[(0,o.bF)(v,{name:i(),size:"2rem"},null,8,["name"])]))]),(0,o.Lk)("div",$,[(0,o.Lk)("div",D,[(0,o.Lk)("h4",null,(0,l.v_)(e.media.filename),1),e.media.description?((0,o.uX)(),(0,o.CE)("p",T,(0,l.v_)(e.media.description),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",I,[(0,o.Lk)("div",x,[(0,o.bF)(v,{name:"folder",size:"sm"}),(0,o.Lk)("span",null,(0,l.v_)(r()),1)]),(0,o.Lk)("div",q,[(0,o.bF)(v,{name:"data_usage",size:"sm"}),(0,o.Lk)("span",null,(0,l.v_)(c(e.media.file_size||e.media.size)),1)]),e.media.duration?((0,o.uX)(),(0,o.CE)("div",U,[(0,o.bF)(v,{name:"schedule",size:"sm"}),(0,o.Lk)("span",null,(0,l.v_)(d(e.media.duration)),1)])):(0,o.Q3)("",!0),e.media.created_at?((0,o.uX)(),(0,o.CE)("div",z,[(0,o.bF)(v,{name:"event",size:"sm"}),(0,o.Lk)("span",null,(0,l.v_)(u(e.media.created_at)),1)])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",B,[(0,o.bF)(k,{flat:"",round:"",icon:"edit",onClick:g[0]||(g[0]=e=>a.$emit("edit")),size:"sm",color:"primary"},{default:(0,o.k6)((()=>[(0,o.bF)(h,null,{default:(0,o.k6)((()=>g[2]||(g[2]=[(0,o.eW)("Editar")]))),_:1,__:[2]})])),_:1}),(0,o.bF)(k,{flat:"",round:"",icon:"delete",onClick:g[1]||(g[1]=e=>a.$emit("delete")),size:"sm",color:"negative"},{default:(0,o.k6)((()=>[(0,o.bF)(h,null,{default:(0,o.k6)((()=>g[3]||(g[3]=[(0,o.eW)("Eliminar")]))),_:1,__:[3]})])),_:1})])])}}};const V=(0,L.A)(R,[["__scopeId","data-v-4dde5f74"]]);var X=V;const N={class:"gallery-header"},W={class:"header-info"},K={class:"header-text"},O={class:"header-controls"},Q={key:1,class:"view-controls"},j={class:"gallery-content"},G={key:0,class:"empty-state"},H={key:1,class:"loading-state"},J={key:3,class:"media-list"},Z={key:0,class:"show-more"};var Y={__name:"MediaGallery",props:{mediaFiles:{type:Array,default:()=>[]},backendBaseUrl:{type:String,default:""},loading:{type:Boolean,default:!1},mode:{type:String,default:"compact",validator:e=>["compact","full"].includes(e)},title:{type:String,default:""},subtitle:{type:String,default:""},maxItems:{type:Number,default:6}},emits:["refresh","edit","delete","show-all"],setup(e){const a=e,t=(0,n.KR)(""),s=(0,n.KR)("grid"),i=(0,o.EW)((()=>{if(!a.mediaFiles)return[];let e=[...a.mediaFiles];if(t.value){const a=t.value.toLowerCase();e=e.filter((e=>e.filename?.toLowerCase().includes(a)||e.description?.toLowerCase().includes(a)))}return e.sort(((e,a)=>{const t=new Date(e.created_at||e.upload_date||0),o=new Date(a.created_at||a.upload_date||0);return o-t})),e})),r=(0,o.EW)((()=>"compact"===a.mode?i.value.slice(0,a.maxItems):i.value));return(a,n)=>{const c=(0,o.g2)("q-icon"),d=(0,o.g2)("q-input"),u=(0,o.g2)("q-btn-toggle"),m=(0,o.g2)("q-tooltip"),p=(0,o.g2)("q-btn"),g=(0,o.g2)("q-skeleton");return(0,o.uX)(),(0,o.CE)("div",{class:(0,l.C4)(["media-gallery",{"full-view":"full"===e.mode,"compact-view":"compact"===e.mode}])},[(0,o.Lk)("div",N,[(0,o.Lk)("div",W,[(0,o.bF)(c,{name:"video_library",size:"2rem"}),(0,o.Lk)("div",K,[(0,o.Lk)("h3",null,(0,l.v_)(e.title||"Archivos Multimedia"),1),(0,o.Lk)("p",null,(0,l.v_)(e.subtitle||("full"===e.mode?"Gestiona tu biblioteca completa":"Archivos recientes")),1)])]),(0,o.Lk)("div",O,["full"===e.mode?((0,o.uX)(),(0,o.Wv)(d,{key:0,modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=e=>t.value=e),placeholder:"Buscar archivos...",outlined:"",dense:"",class:"search-input"},{prepend:(0,o.k6)((()=>[(0,o.bF)(c,{name:"search"})])),append:(0,o.k6)((()=>[t.value?((0,o.uX)(),(0,o.Wv)(c,{key:0,name:"clear",onClick:n[0]||(n[0]=e=>t.value=""),class:"cursor-pointer"})):(0,o.Q3)("",!0)])),_:1},8,["modelValue"])):(0,o.Q3)("",!0),"full"===e.mode?((0,o.uX)(),(0,o.CE)("div",Q,[(0,o.bF)(u,{modelValue:s.value,"onUpdate:modelValue":n[2]||(n[2]=e=>s.value=e),options:[{label:"Tarjetas",value:"grid",icon:"grid_view"},{label:"Lista",value:"list",icon:"view_list"}],flat:"",color:"primary","toggle-color":"primary","no-caps":""},null,8,["modelValue"])])):(0,o.Q3)("",!0),(0,o.bF)(p,{flat:"",icon:"refresh",onClick:n[3]||(n[3]=e=>a.$emit("refresh")),loading:e.loading,round:"",color:"primary"},{default:(0,o.k6)((()=>[(0,o.bF)(m,null,{default:(0,o.k6)((()=>n[5]||(n[5]=[(0,o.eW)("Actualizar")]))),_:1,__:[5]})])),_:1},8,["loading"])])]),(0,o.Lk)("div",j,[0!==i.value.length||e.loading?e.loading?((0,o.uX)(),(0,o.CE)("div",H,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)("compact"===e.mode?8:6,(e=>((0,o.uX)(),(0,o.Wv)(g,{height:"150px",class:"q-mb-md",key:e})))),128))])):"grid"===s.value?((0,o.uX)(),(0,o.CE)("div",{key:2,class:(0,l.C4)(["media-grid",{"compact-grid":"compact"===e.mode}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.value,(t=>((0,o.uX)(),(0,o.Wv)(F,{key:t.id,media:t,"backend-base-url":e.backendBaseUrl,compact:"compact"===e.mode,onEdit:e=>a.$emit("edit",t),onDelete:e=>a.$emit("delete",t.id)},null,8,["media","backend-base-url","compact","onEdit","onDelete"])))),128))],2)):"list"===s.value&&"full"===e.mode?((0,o.uX)(),(0,o.CE)("div",J,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.value,(t=>((0,o.uX)(),(0,o.Wv)(X,{key:t.id,media:t,"backend-base-url":e.backendBaseUrl,onEdit:e=>a.$emit("edit",t),onDelete:e=>a.$emit("delete",t.id)},null,8,["media","backend-base-url","onEdit","onDelete"])))),128))])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",G,[(0,o.bF)(c,{name:"video_library",size:"4rem",color:"grey-5"}),(0,o.Lk)("h4",null,(0,l.v_)(t.value?"No se encontraron archivos":"No hay archivos multimedia"),1),(0,o.Lk)("p",null,(0,l.v_)(t.value?"Intenta con otros términos de búsqueda":"Sube tus primeros archivos multimedia"),1)]))]),"compact"===e.mode&&e.mediaFiles.length>e.maxItems?((0,o.uX)(),(0,o.CE)("div",Z,[(0,o.bF)(p,{flat:"",color:"primary",label:`Ver todos (${e.mediaFiles.length} archivos)`,icon:"arrow_forward",onClick:n[4]||(n[4]=e=>a.$emit("show-all"))},null,8,["label"])])):(0,o.Q3)("",!0)],2)}}};const ee=(0,L.A)(Y,[["__scopeId","data-v-8cf16336"]]);var ae=ee},600:function(e,a,t){t.r(a),t.d(a,{default:function(){return V}});var o=t(641),l=t(33),n=t(751);const s={class:"config-container"},i={class:"theme-toggle-container"},r={key:0,class:"loading-overlay"},c={key:1,class:"config-content"},d={class:"config-card"},u={class:"config-header"},m={class:"header-content"},p={class:"logo-container"},g={class:"page-title"},v={class:"page-subtitle"},h={key:0,class:"status-badge"},k={class:"config-form-section"},f={class:"input-group"},y={class:"input-group"},b={class:"logo-upload-section"},L={class:"logo-upload-header"},_={key:0,class:"current-logo-preview"},F={class:"logo-preview-container"},C=["src"],w={key:1,class:"new-logo-preview"},E={class:"logo-preview-container"},P=["src"],S={class:"form-actions"},M={class:"footer-section"},A={class:"diversity-message"};function $(e,a,t,$,D,T){const I=(0,o.g2)("ThemeToggle"),x=(0,o.g2)("q-spinner-dots"),q=(0,o.g2)("q-icon"),U=(0,o.g2)("q-input"),z=(0,o.g2)("q-btn"),B=(0,o.g2)("q-file"),R=(0,o.g2)("q-form");return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("div",i,[(0,o.bF)(I)]),$.initialLoading?((0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(x,{size:"3rem"}),a[2]||(a[2]=(0,o.Lk)("p",null,"Cargando configuración...",-1))])):((0,o.uX)(),(0,o.CE)("div",c,[(0,o.Lk)("div",d,[(0,o.Lk)("div",u,[(0,o.Lk)("div",m,[(0,o.Lk)("div",p,[(0,o.bF)(q,{name:"business",class:"main-logo"}),a[3]||(a[3]=(0,o.Lk)("div",{class:"logo-glow"},null,-1))]),(0,o.Lk)("h2",g,(0,l.v_)($.isUpdate?"Actualizar Negocio":"Configurar Negocio"),1),(0,o.Lk)("p",v,(0,l.v_)($.isUpdate?"Modifica la información de tu negocio":"Configura tu espacio LGBT+ friendly"),1),a[5]||(a[5]=(0,o.Lk)("div",{class:"pride-divider"},null,-1)),$.isUpdate?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(q,{name:"check_circle"}),a[4]||(a[4]=(0,o.Lk)("span",null,"Negocio ya configurado",-1))])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",k,[(0,o.bF)(R,{onSubmit:(0,n.D$)($.save,["prevent"]),class:"config-form"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",f,[(0,o.bF)(U,{modelValue:$.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>$.form.name=e),label:"Nombre del negocio",outlined:"",dense:"",required:"",class:"modern-input",rules:[e=>!!e||"El nombre es requerido"]},{prepend:(0,o.k6)((()=>[(0,o.bF)(q,{name:"store",class:"input-icon"})])),_:1},8,["modelValue","rules"])]),(0,o.Lk)("div",y,[(0,o.Lk)("div",b,[(0,o.Lk)("div",L,[(0,o.bF)(q,{name:"image",class:"input-icon"}),a[6]||(a[6]=(0,o.Lk)("span",null,"Logo del negocio",-1))]),$.currentLogoPreview?((0,o.uX)(),(0,o.CE)("div",_,[a[7]||(a[7]=(0,o.Lk)("div",{class:"preview-label"},"Logo actual:",-1)),(0,o.Lk)("div",F,[(0,o.Lk)("img",{src:$.currentLogoPreview,alt:"Logo actual",class:"logo-preview"},null,8,C),(0,o.bF)(z,{flat:"",round:"",icon:"close",size:"sm",onClick:$.clearCurrentLogo,class:"remove-logo-btn"},null,8,["onClick"])])])):(0,o.Q3)("",!0),(0,o.bF)(B,{modelValue:$.form.logo,"onUpdate:modelValue":[a[1]||(a[1]=e=>$.form.logo=e),$.onLogoSelected],label:"Subir nuevo logo (PNG, JPG, JPEG)",accept:"image/png,image/jpg,image/jpeg",outlined:"",dense:"",class:"modern-input","max-file-size":5242880},{prepend:(0,o.k6)((()=>[(0,o.bF)(q,{name:"upload"})])),_:1},8,["modelValue","onUpdate:modelValue"]),$.newLogoPreview?((0,o.uX)(),(0,o.CE)("div",w,[a[8]||(a[8]=(0,o.Lk)("div",{class:"preview-label"},"Nuevo logo:",-1)),(0,o.Lk)("div",E,[(0,o.Lk)("img",{src:$.newLogoPreview,alt:"Nuevo logo",class:"logo-preview"},null,8,P),(0,o.bF)(z,{flat:"",round:"",icon:"close",size:"sm",onClick:$.clearNewLogo,class:"remove-logo-btn"},null,8,["onClick"])])])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",S,[$.isUpdate?((0,o.uX)(),(0,o.Wv)(z,{key:0,flat:"",color:"grey",label:"Cancelar",onClick:$.goToAdmin,class:"cancel-btn"},null,8,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(z,{type:"submit",label:$.isUpdate?"Actualizar Configuración":"Guardar Configuración",class:"save-btn",size:"md",unelevated:"",loading:$.loading,disable:!$.form.name},null,8,["label","loading","disable"])])])),_:1},8,["onSubmit"])]),(0,o.Lk)("div",M,[(0,o.Lk)("div",A,[(0,o.bF)(q,{name:"favorite",class:"heart-icon"}),a[9]||(a[9]=(0,o.Lk)("span",null,"Programado por un gei 🏳️‍🌈",-1))])])])]))])}var D=t(953),T=t(220),I=t(889),x=t(246),q=t(725),U=t(697),z={name:"ConfigView",components:{ThemeToggle:U.A},setup(){const e=(0,T.rd)(),a=(0,x.dj)(),{loadTheme:t}=(0,q.D)(),l=(0,D.KR)(!1),n=(0,D.KR)(!0),s=(0,D.KR)(!1),i=(0,D.KR)(null),r=(0,D.KR)(null),c=(0,D.KR)(null),d=(0,D.KR)({name:"",logo:null}),u=async()=>{try{const a=await I.ZK.get();if(a.data&&(i.value=a.data,d.value.name=a.data.name||"",s.value=!0,a.data.id))try{const e=await I.ZK.getLogo();e.data?.logo&&(r.value=`data:image/png;base64,${e.data.logo}`)}catch(e){console.log("No hay logo existente")}}catch(e){console.log("No hay negocio configurado, será creación"),s.value=!1}finally{n.value=!1}},m=e=>{if(e){const t=["image/png","image/jpeg","image/jpg"];if(!t.includes(e.type))return a.error("Solo se permiten archivos PNG, JPG o JPEG"),void(d.value.logo=null);if(e.size>5242880)return a.error("El archivo es muy grande. Máximo 5MB."),void(d.value.logo=null);const o=new FileReader;o.onload=e=>{c.value=e.target.result},o.readAsDataURL(e)}else c.value=null},p=()=>{r.value=null,s.value&&a.info("El logo actual será eliminado al guardar")},g=()=>{d.value.logo=null,c.value=null},v=async()=>{if(d.value.name){l.value=!0;try{const t={name:d.value.name,logo:d.value.logo};let o;s.value?(o=await I.ZK.update(t),a.success("¡Negocio actualizado exitosamente!")):(o=await I.ZK.create(t),a.success("¡Negocio configurado exitosamente!")),s.value?e.push("/admin"):e.push("/login")}catch(t){const e=s.value?"Error actualizando la configuración del negocio":"Error guardando la configuración del negocio";a.error(e),console.error("Error:",t)}finally{l.value=!1}}else a.warning("Ingresa el nombre del negocio")},h=()=>{e.push("/admin")};return(0,o.sV)((async()=>{t(),await u()})),{form:d,save:v,loading:l,initialLoading:n,isUpdate:s,currentBusiness:i,currentLogoPreview:r,newLogoPreview:c,onLogoSelected:m,clearCurrentLogo:p,clearNewLogo:g,goToAdmin:h}}},B=t(262);const R=(0,B.A)(z,[["render",$],["__scopeId","data-v-e2c0c8dc"]]);var V=R},642:function(e,a,t){t.r(a),t.d(a,{default:function(){return _e}});var o=t(641),l=t(33);const n={key:1,class:"selection-state"},s={class:"player-header"},i={class:"header-content"},r={class:"header-icon"},c={class:"main-content"},d={class:"content-card"},u={key:0,class:"loading-section"},m={key:1,class:"playlists-section"},p={class:"section-header"},g={class:"playlist-count"},v={class:"playlists-grid"},h=["onClick"],k={class:"playlist-icon"},f={class:"playlist-info"},y={class:"playlist-meta"},b={class:"meta-item"},L={class:"meta-item"},_={class:"playlist-action"},F={key:2,class:"empty-state"},C={class:"empty-icon"},w={class:"empty-actions"},E={class:"footer-actions"},P={key:2,class:"player-state"},S={class:"media-display-area"},M={key:0,class:"media-container"},A={key:0,class:"image-display"},$=["src","alt"],D={key:1,class:"video-display"},T=["src"],I={key:2,class:"loading-media"},x={key:3,class:"media-info-overlay"},q={class:"media-info"},U={class:"media-details"},z={key:1,class:"loading-media"},B={key:0,class:"player-controls normal-controls"},R={class:"control-panel"},V={class:"playlist-info-controls"},X={class:"media-controls"},N={class:"progress-info"},W={class:"progress-bar"},K={class:"time-info"},O={class:"additional-controls"},Q={key:2,class:"business-logo-overlay"},j=["src"],G={key:3,class:"schedule-notification"};function H(e,a,t,H,J,Z){const Y=(0,o.g2)("ThemeToggle"),ee=(0,o.g2)("q-icon"),ae=(0,o.g2)("q-spinner"),te=(0,o.g2)("q-btn"),oe=(0,o.g2)("q-spinner-dots"),le=(0,o.g2)("q-linear-progress"),ne=(0,o.g2)("q-tooltip"),se=(0,o.g2)("q-banner");return(0,o.uX)(),(0,o.CE)("div",{class:(0,l.C4)(["player-container",{"fullscreen-mode":H.isFullscreen}]),onMousemove:a[5]||(a[5]=e=>H.isFullscreen?H.onMouseMoveFullscreen():null)},[H.isFullscreen?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(Y,{key:0,class:"theme-toggle"})),H.selectedPlaylist?((0,o.uX)(),(0,o.CE)("div",P,[(0,o.Lk)("div",S,[H.currentMedia?((0,o.uX)(),(0,o.CE)("div",M,["image"===H.currentMedia.media_type&&H.currentMediaSrc?((0,o.uX)(),(0,o.CE)("div",A,[(0,o.Lk)("img",{src:H.currentMediaSrc,alt:H.currentMedia.filename,class:"media-image",onError:a[0]||(a[0]=(...e)=>H.handleMediaError&&H.handleMediaError(...e)),onLoad:a[1]||(a[1]=(...e)=>H.onMediaLoaded&&H.onMediaLoaded(...e))},null,40,$)])):"video"===H.currentMedia.media_type&&H.currentMediaSrc?((0,o.uX)(),(0,o.CE)("div",D,[(0,o.Lk)("video",{ref:"videoPlayer",src:H.currentMediaSrc,class:"media-video",onEnded:a[2]||(a[2]=(...e)=>H.onMediaEnded&&H.onMediaEnded(...e)),onError:a[3]||(a[3]=(...e)=>H.handleMediaError&&H.handleMediaError(...e)),onLoadeddata:a[4]||(a[4]=(...e)=>H.onMediaLoaded&&H.onMediaLoaded(...e)),autoplay:"",muted:""},null,40,T)])):H.currentMedia&&!H.currentMediaSrc?((0,o.uX)(),(0,o.CE)("div",I,[(0,o.bF)(oe,{color:"primary",size:"3rem"}),(0,o.Lk)("p",null,"Preparando "+(0,l.v_)(H.currentMedia.filename)+"...",1)])):(0,o.Q3)("",!0),H.showInfo?((0,o.uX)(),(0,o.CE)("div",x,[(0,o.Lk)("div",q,[(0,o.Lk)("h3",null,(0,l.v_)(H.currentMedia.filename),1),(0,o.Lk)("p",null,(0,l.v_)(H.currentMedia.description||"Sin descripción"),1),(0,o.Lk)("div",U,[(0,o.Lk)("span",null,"Duración: "+(0,l.v_)(H.getCurrentDuration())+"s",1),(0,o.Lk)("span",null,"Tipo: "+(0,l.v_)(H.currentMedia.media_type),1),(0,o.Lk)("span",null,"Posición: "+(0,l.v_)(H.currentMediaIndex+1)+"/"+(0,l.v_)(H.playlistMedia.length),1)])])])):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",z,[(0,o.bF)(ae,{color:"primary",size:"4rem"}),a[11]||(a[11]=(0,o.Lk)("p",null,"Cargando próximo contenido...",-1))]))]),H.isFullscreen?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",B,[(0,o.Lk)("div",R,[(0,o.Lk)("div",V,[(0,o.Lk)("h4",null,(0,l.v_)(H.selectedPlaylist.name),1),(0,o.Lk)("p",null,(0,l.v_)(H.playlistMedia.length)+" elementos • Reproduciendo en bucle",1)]),(0,o.Lk)("div",X,[(0,o.bF)(te,{icon:H.isPlaying?"pause":"play_arrow",onClick:H.togglePlayPause,color:"primary",size:"lg",round:"",class:"play-pause-btn"},null,8,["icon","onClick"]),(0,o.bF)(te,{icon:"skip_next",onClick:H.skipToNext,color:"secondary",size:"md",round:"",class:"skip-btn"},null,8,["onClick"]),(0,o.bF)(te,{icon:"skip_previous",onClick:H.skipToPrevious,color:"secondary",size:"md",round:"",class:"skip-btn"},null,8,["onClick"])]),(0,o.Lk)("div",N,[(0,o.Lk)("div",W,[(0,o.bF)(le,{value:H.progress,color:"primary",size:"4px",class:"media-progress"},null,8,["value"]),(0,o.Lk)("div",K,[(0,o.Lk)("span",null,(0,l.v_)(H.formatTime(H.elapsedTime)),1),(0,o.Lk)("span",null,(0,l.v_)(H.formatTime(H.getCurrentDuration())),1)])])]),(0,o.Lk)("div",O,[(0,o.bF)(te,{icon:H.showInfo?"info":"info_outline",onClick:H.toggleInfo,flat:"",round:"",class:"info-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(ne,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,l.v_)(H.showInfo?"Ocultar":"Mostrar")+" información",1)])),_:1})])),_:1},8,["icon","onClick"]),(0,o.bF)(te,{icon:"fullscreen",onClick:H.toggleFullscreen,flat:"",round:"",size:"md",class:"fullscreen-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(ne,null,{default:(0,o.k6)((()=>a[12]||(a[12]=[(0,o.eW)("Pantalla completa")]))),_:1,__:[12]})])),_:1},8,["onClick"]),(0,o.bF)(te,{icon:"stop",onClick:H.stopPlayback,flat:"",round:"",color:"negative",class:"stop-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(ne,null,{default:(0,o.k6)((()=>a[13]||(a[13]=[(0,o.eW)("Detener y volver")]))),_:1,__:[13]})])),_:1},8,["onClick"])])])])),H.isFullscreen?((0,o.uX)(),(0,o.CE)("div",{key:1,class:(0,l.C4)(["fullscreen-exit-overlay",{visible:H.showFullscreenControls}])},[(0,o.bF)(te,{icon:"fullscreen_exit",onClick:H.toggleFullscreen,color:"white","text-color":"black",size:"xl",round:"",class:"exit-fullscreen-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(ne,null,{default:(0,o.k6)((()=>a[14]||(a[14]=[(0,o.eW)("Salir de pantalla completa (ESC)")]))),_:1,__:[14]})])),_:1},8,["onClick"])],2)):(0,o.Q3)("",!0),H.isFullscreen&&H.businessLogo?((0,o.uX)(),(0,o.CE)("div",Q,[(0,o.Lk)("img",{src:H.businessLogo,alt:"Logo",class:"business-logo"},null,8,j)])):(0,o.Q3)("",!0),H.scheduleOverride&&!H.isFullscreen?((0,o.uX)(),(0,o.CE)("div",G,[(0,o.bF)(se,{class:"bg-orange text-white"},{avatar:(0,o.k6)((()=>[(0,o.bF)(ee,{name:"schedule"})])),action:(0,o.k6)((()=>[(0,o.bF)(te,{flat:"",icon:"close",onClick:H.dismissScheduleNotification},null,8,["onClick"])])),default:(0,o.k6)((()=>[a[15]||(a[15]=(0,o.Lk)("strong",null,"Programación Activa",-1)),a[16]||(a[16]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)(' Reproduciendo contenido programado: "'+(0,l.v_)(H.scheduleOverride.media.filename)+'" ',1)])),_:1,__:[15,16]})])):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("div",s,[(0,o.Lk)("div",i,[(0,o.Lk)("div",r,[(0,o.bF)(ee,{name:"play_circle_filled",size:"3rem"})]),a[6]||(a[6]=(0,o.Lk)("div",{class:"header-text"},[(0,o.Lk)("h2",null,"Reproductor de Contenido"),(0,o.Lk)("p",null,"Seleccione una playlist para comenzar la reproducción")],-1))])]),(0,o.Lk)("div",c,[(0,o.Lk)("div",d,[H.loading?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(ae,{color:"primary",size:"3rem"}),a[7]||(a[7]=(0,o.Lk)("p",{class:"loading-text"},"Cargando playlists...",-1))])):H.playlists.length?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("div",p,[a[8]||(a[8]=(0,o.Lk)("h3",null,"Playlists Disponibles",-1)),(0,o.Lk)("div",g,(0,l.v_)(H.playlists.length)+" playlist"+(0,l.v_)(1!==H.playlists.length?"s":"")+" disponible"+(0,l.v_)(1!==H.playlists.length?"s":""),1)]),(0,o.Lk)("div",v,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(H.playlists,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"playlist-card",onClick:a=>H.selectPlaylist(e)},[(0,o.Lk)("div",k,[(0,o.bF)(ee,{name:"queue_music",size:"2.5rem"})]),(0,o.Lk)("div",f,[(0,o.Lk)("h4",null,(0,l.v_)(e.name),1),(0,o.Lk)("p",null,(0,l.v_)(e.description||"Lista de reproducción de contenido multimedia"),1),(0,o.Lk)("div",y,[(0,o.Lk)("span",b,[(0,o.bF)(ee,{name:"schedule",size:"1rem"}),(0,o.eW)(" "+(0,l.v_)(H.formatTotalDuration(e.total_duration)),1)]),(0,o.Lk)("span",L,[(0,o.bF)(ee,{name:"playlist_play",size:"1rem"}),(0,o.eW)(" "+(0,l.v_)(e.media_count||0)+" elementos ",1)])])]),(0,o.Lk)("div",_,[(0,o.bF)(ee,{name:"play_arrow",size:"1.5rem"})])],8,h)))),128))])])):((0,o.uX)(),(0,o.CE)("div",F,[(0,o.Lk)("div",C,[(0,o.bF)(ee,{name:"playlist_remove",size:"4rem"})]),a[9]||(a[9]=(0,o.Lk)("h3",null,"No hay playlists disponibles",-1)),a[10]||(a[10]=(0,o.Lk)("p",null,"Actualmente no hay ninguna playlist configurada en el sistema.",-1)),(0,o.Lk)("div",w,[(0,o.bF)(te,{color:"primary",icon:"add",label:"Crear Playlist",onClick:H.goToAdmin,rounded:"",unelevated:""},null,8,["onClick"])])]))])]),(0,o.Lk)("div",E,[(0,o.bF)(te,{color:"secondary",icon:"arrow_back",label:"Volver",onClick:H.goBack,outline:"",rounded:""},null,8,["onClick"]),(0,o.bF)(te,{color:"accent",icon:"refresh",label:"Actualizar",onClick:H.fetchPlaylists,rounded:"",unelevated:""},null,8,["onClick"])])]))],34)}var J=t(953),Z=t(220),Y=t(335),ee=t(349),ae=t(680);let te=Y.A.create({baseURL:"",timeout:15e3,headers:{"Content-Type":"application/json"}}),oe=!1,le=null;const ne=async()=>oe?te:le||(le=(async()=>{try{console.log("🎬 Inicializando API del reproductor...");const e=(0,ae.w)();if(e)return console.log("🎯 Player API en modo producción, usando mismo origen"),te.defaults.baseURL=`${e.baseUrl}/api`,await te.get("/health",{timeout:5e3}),oe=!0,console.log(`✅ Player API inicializada en modo producción: ${e.baseUrl}`),te;console.log("🔧 Player API en modo desarrollo, detectando backend...");const{baseUrl:a}=await ee.A.detectBackend();return te.defaults.baseURL=`${a}/api`,await te.get("/health",{timeout:5e3}),oe=!0,console.log(`✅ API del reproductor inicializada: ${a}`),te}catch(e){console.error("❌ Error inicializando API del reproductor:",e),te.defaults.baseURL="http://127.0.0.1:8000/api";try{return await te.get("/health",{timeout:3e3}),console.log("✅ API del reproductor inicializada con fallback localhost:8000"),oe=!0,te}catch(a){throw console.error("❌ Fallback también falló:",a),new Error("No se pudo conectar con el backend para el reproductor.")}}})(),le),se=async()=>(oe||await ne(),te),ie={list:async(e=0,a=100)=>{const t=await se();return t.get(`/playlists/public?skip=${e}&limit=${a}`)},listPlaylists:async(e=0,a=100)=>{const t=await se();return t.get(`/playlists/public?skip=${e}&limit=${a}`)},getPlaylist:async e=>{const a=await se();return a.get(`/playlists/${e}/player`)},getPlaylistInfo:async e=>{const a=await se();return a.get(`/playlists/${e}`)}},re=async e=>{if(!e)return"";try{const a=(0,ae.w)();let t;if(a)t=a.baseUrl;else{const e=await ee.A.detectBackend();t=e.baseUrl}if(e.file_url)return`${t}${e.file_url}`;let o=e.filepath||e.served_filename||e.filename;return o.startsWith("/uploads/")||(o=`/uploads/${o}`),`${t}${o}`}catch(a){console.error("Error construyendo URL de media:",a);const t=e.file_url||`/uploads/${e.served_filename||e.filename}`;return`http://127.0.0.1:8000${t}`}};var ce=t(246),de=t(697),ue=t(725);class me{constructor(){this.socket=null,this.connected=!1,this.listeners=new Map,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.detectedBackendUrl=null}async getWebSocketUrl(){try{let e=this.detectedBackendUrl;if(!e){const{baseUrl:a}=await ee.A.detectBackend();this.detectedBackendUrl=a,e=a}const a=e.replace("http://","ws://")+"/ws";return console.log(`🎯 URL WebSocket generada: ${a}`),a}catch(e){return console.error("❌ Error obteniendo URL del WebSocket:",e),"ws://127.0.0.1:8002/ws"}}async connect(e=null){try{e||(e=await this.getWebSocketUrl()),console.log(`🔌 Conectando WebSocket a: ${e}`),this.socket=new WebSocket(e),this.socket.onopen=()=>{console.log("✅ WebSocket conectado"),this.connected=!0,this.reconnectAttempts=0,this.emit("connection-status",{connected:!0})},this.socket.onclose=a=>{console.log("❌ WebSocket desconectado:",a.code,a.reason),this.connected=!1,this.emit("connection-status",{connected:!1,reason:a.reason}),this.reconnectAttempts<this.maxReconnectAttempts&&(this.reconnectAttempts++,console.log(`🔄 Intentando reconectar (${this.reconnectAttempts}/${this.maxReconnectAttempts})...`),setTimeout((()=>this.connect(e)),this.reconnectDelay*this.reconnectAttempts))},this.socket.onerror=e=>{console.error("❌ Error de conexión WebSocket:",e),this.emit("connection-error",e)},this.socket.onmessage=e=>{try{const a=JSON.parse(e.data);a.event&&a.data&&this.emit(a.event,a.data)}catch(a){console.error("Error parseando mensaje WebSocket:",a)}}}catch(a){console.error("Error inicializando WebSocket:",a)}}disconnect(){this.socket&&(this.socket.close(),this.socket=null,this.connected=!1,this.listeners.clear(),console.log("🔌 WebSocket desconectado manualmente"))}send(e,a){if(this.socket&&this.connected){const t=JSON.stringify({event:e,data:a});this.socket.send(t)}else console.warn("⚠️ WebSocket no conectado, no se puede enviar:",e)}on(e,a){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(a)}off(e,a){if(this.listeners.has(e)){const t=this.listeners.get(e),o=t.indexOf(a);o>-1&&t.splice(o,1)}}emit(e,a){this.listeners.has(e)&&this.listeners.get(e).forEach((t=>{try{t(a)}catch(o){console.error(`Error en listener para evento ${e}:`,o)}}))}notifyUploadStart(e){this.send("media-upload-start",e)}requestPlaybackStatus(){this.send("get-playback-status")}sendPlayerCommand(e,a={}){this.send("player-command",{command:e,...a})}notifyScheduleChange(e){this.send("schedule-change",e)}requestSystemStats(){this.send("get-system-stats")}}const pe=new me,ge=()=>{pe.connect()},ve=()=>{pe.disconnect()},he=()=>pe.connected,ke=()=>({connect:ge,disconnect:ve,isConnected:he,on:(e,a)=>pe.on(e,a),off:(e,a)=>pe.off(e,a),send:(e,a)=>pe.send(e,a),notifyUploadStart:e=>pe.notifyUploadStart(e),requestPlaybackStatus:()=>pe.requestPlaybackStatus(),sendPlayerCommand:(e,a)=>pe.sendPlayerCommand(e,a),notifyScheduleChange:e=>pe.notifyScheduleChange(e),requestSystemStats:()=>pe.requestSystemStats()});var fe=t(891),ye={name:"PlayerView",components:{ThemeToggle:de.A},setup(){const e=(0,Z.rd)(),a=(0,ce.dj)(),{isDarkMode:t}=(0,ue.D)(),{backendBaseUrl:l,buildMediaUrl:n}=(0,fe.f)(),s=(0,J.KR)(null),i=(0,J.KR)(!1),r=(0,J.KR)([]),c=(0,J.KR)(null),d=(0,J.KR)([]),u=(0,J.KR)(null),m=(0,J.KR)(0),p=(0,J.KR)(!1),g=(0,J.KR)(!1),v=(0,J.KR)(0),h=(0,J.KR)(null),k=(0,J.KR)("");let f=null,y=null,b=null;const L=(0,o.EW)((()=>{if(!u.value)return 0;const e=T();return e>0?v.value/e:0})),_=(0,o.EW)((()=>k.value||"")),{connect:F,disconnect:C,on:w,off:E}=ke(),P=async({id:e})=>{c.value&&(await x(c.value.id),a.info("Se añadió un nuevo medio a la playlist"))},S=async({playlist_id:e,action:t,media_id:o})=>{if(!c.value||c.value.id!==e)return;console.log(`Playlist actualizada: ${t}`);const l=d.value.length;await x(e);const n=d.value.length;switch("media_removed"===t&&n<l&&m.value>=n&&n>0&&(m.value=0,q()),t){case"media_added":a.info("Se añadió un medio a la playlist activa");break;case"media_removed":a.warning("Se removió un medio de la playlist activa");break;case"playlist_modified":a.info("La playlist activa fue modificada");break}},M=()=>{try{F(),w("media_created",P),w("playlist_updated",S),console.log("WebSocket conectado exitosamente")}catch(e){console.warn("WebSocket no disponible, continuando sin actualizaciones automáticas:",e)}},A=()=>{try{E("media_created",P),E("playlist_updated",S),C(),console.log("WebSocket desconectado exitosamente")}catch(e){console.warn("Error al desconectar WebSocket:",e)}},$=e=>{const a=Math.floor(e/60),t=Math.floor(e%60);return`${a}:${t.toString().padStart(2,"0")}`},D=e=>{if(!e)return"0:00";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),o=e%60;return a>0?`${a}:${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${t}:${o.toString().padStart(2,"0")}`},T=()=>u.value?u.value.effective_duration||u.value.duration||5:0,I=async()=>{i.value=!0;try{console.log("Intentando cargar playlists...");const e=await ie.listPlaylists();r.value=e.data||[],console.log("Playlists cargadas exitosamente:",r.value)}catch(t){console.error("Error fetching playlists:",t),401===t.response?.status?(a.error("Sesión expirada. Redirigiendo al login..."),localStorage.removeItem("signance_token"),e.push("/login")):a.error("Error al cargar las playlists")}finally{i.value=!1}},x=async e=>{try{console.log("Cargando medios de playlist:",e);const t=await ie.getPlaylist(e),o=t.data||{},l=o.medias||[];if(!Array.isArray(l))return console.error("La respuesta no contiene un array de medias:",o),d.value=[],void a.error("Error: formato de datos incorrecto");d.value=l.map((e=>({...e,effective_duration:e.duration,url:e.file_url}))),console.log("Medios de playlist cargados:",{count:d.value.length,playlist_name:o.name,items:l.map((e=>({id:e.id,filename:e.filename,duration:e.duration,file_url:e.file_url})))}),d.value.length>0?(m.value=0,q()):(console.warn("No se encontraron medios en la playlist"),a.warning("Esta playlist no contiene medios"))}catch(t){console.error("Error loading playlist media:",t),d.value=[],a.error("Error al cargar los medios de la playlist")}},q=()=>{if(d.value.length>0){const e=d.value[m.value];u.value=e,v.value=0,k.value="",re(e).then((a=>{u.value===e&&(k.value=a,console.log("Medio actual cargado:",{index:m.value,filename:e.filename,media_type:e.media_type,filepath:e.filepath,duration:e.duration,effective_duration:e.effective_duration,url:a}))})).catch((t=>{console.error("Error construyendo URL del media:",t),u.value===e&&(k.value="",a.error(`Error preparando medio: ${e.filename}`))}))}else console.warn("No hay medios disponibles para cargar"),u.value=null,k.value=""},U=async e=>{c.value=e,await x(e.id),d.value.length>0?(z(),a.success(`Reproduciendo: ${e.name}`)):a.warning("Esta playlist no tiene medios para reproducir")},z=()=>{p.value=!0,B(),G(),j()},B=()=>{if(!u.value)return;const e=T();console.log(`Programando cambio de medio en ${e} segundos`),clearTimeout(f),f=setTimeout((()=>{p.value&&R()}),1e3*e)},R=()=>{0!==d.value.length&&(m.value=(m.value+1)%d.value.length,q(),p.value&&B())},V=()=>{0!==d.value.length&&(m.value=0===m.value?d.value.length-1:m.value-1,q(),p.value&&B())},X=()=>{p.value?N():W()},N=()=>{p.value=!1,clearTimeout(f),clearInterval(b),"video"===u.value?.media_type&&s.value&&s.value.pause(),a.info("Reproducción pausada")},W=()=>{p.value=!0,B(),G(),"video"===u.value?.media_type&&s.value&&s.value.play(),a.info("Reproducción reanudada")},K=()=>{p.value=!1,clearTimeout(f),clearInterval(b),clearInterval(y),c.value=null,u.value=null,d.value=[],h.value=null,v.value=0,a.info("Reproducción detenida")},O=()=>{R(),p.value&&B()},Q=()=>{V(),p.value&&B()},j=()=>{console.log("Schedule check temporalmente deshabilitado")},G=()=>{clearInterval(b),b=setInterval((()=>{p.value&&u.value&&(v.value+=.1,"video"===u.value.media_type&&s.value&&s.value.ended&&H())}),100)},H=()=>{console.log("Medio terminado, avanzando al siguiente"),R()},Y=()=>{console.log("Medio cargado exitosamente:",u.value?.filename)},ae=e=>{console.error("Error de medio:",{error:e,media:u.value,url:k.value}),a.error(`Error al cargar: ${u.value?.filename||"medio desconocido"}`),setTimeout((()=>{d.value.length>1?(console.log("Saltando al siguiente medio debido a error"),R()):(console.log("No hay más medios disponibles"),a.warning("No hay más medios disponibles en la playlist"))}),2e3)},te=()=>{g.value=!g.value},oe=(0,J.KR)(!1),le=(0,J.KR)(!1),ne=(0,J.KR)(null);let se=null;const de=()=>{oe.value=!!document.fullscreenElement,console.log("Initialized fullscreen state:",oe.value)},me=async()=>{try{if(document.fullscreenElement)await document.exitFullscreen(),oe.value=!1,a.info("Modo pantalla completa desactivado");else{const e=document.querySelector(".player-state");e?await e.requestFullscreen():await document.documentElement.requestFullscreen(),oe.value=!0,a.info("Modo pantalla completa activado")}}catch(e){console.error("Error toggle fullscreen:",e),a.error("Error al cambiar modo de pantalla")}},pe=()=>{const e=oe.value;oe.value=!!document.fullscreenElement,console.log("Fullscreen state changed:",{wasFullscreen:e,nowFullscreen:oe.value,element:document.fullscreenElement}),oe.value||(le.value=!1,se&&(clearTimeout(se),se=null))},ge=()=>{oe.value&&(le.value=!0,document.body.style.cursor="default",se&&clearTimeout(se),se=setTimeout((()=>{le.value=!1,oe.value&&(document.body.style.cursor="none")}),3e3))},ve=()=>{h.value=null},he=()=>{e.push("/admin")},ye=async()=>{try{console.log("🔍 Intentando cargar logo del negocio...");const a=ee.A.getCachedBackend();if(!a)return void console.log("❌ No hay backend detectado");console.log("📡 Backend detectado:",a.baseUrl);const t=`${a.baseUrl}/api/business/logo`;console.log("🖼️ Intentando cargar logo desde:",t);try{const e=await fetch(t,{method:"GET"});if(console.log("📥 Respuesta del logo:",e.status,e.statusText),e.ok){const a=await e.json();console.log("📄 Datos recibidos:",a.logo?"Logo base64 presente":"Sin logo"),a.logo?(ne.value=`data:image/png;base64,${a.logo}`,console.log("✅ Logo cargado exitosamente como data URL")):(console.log("❌ No hay datos de logo en la respuesta"),ne.value=null)}else 404===e.status?(console.log("📄 No hay logo configurado (404)"),ne.value=null):(console.log("❌ Error cargando logo:",e.status,e.statusText),ne.value=null)}catch(e){console.log("❌ Error de red cargando logo:",e),ne.value=null}}catch(a){console.log("❌ Error general cargando logo:",a),ne.value=null}},be=()=>{K(),e.push("/")};return(0,o.sV)((()=>{console.log("PlayerView mounted, initial fullscreen state:",oe.value),de(),I(),ye(),document.addEventListener("fullscreenchange",pe),M()})),(0,o.hi)((()=>{clearTimeout(f),clearInterval(b),clearInterval(y),se&&clearTimeout(se),document.removeEventListener("fullscreenchange",pe),A()})),{loading:i,playlists:r,selectedPlaylist:c,playlistMedia:d,currentMedia:u,currentMediaIndex:m,isPlaying:p,showInfo:g,elapsedTime:v,scheduleOverride:h,progress:L,currentMediaSrc:_,videoPlayer:s,isFullscreen:oe,showFullscreenControls:le,businessLogo:ne,fetchPlaylists:I,selectPlaylist:U,togglePlayPause:X,skipToNext:O,skipToPrevious:Q,stopPlayback:K,toggleInfo:te,toggleFullscreen:me,dismissScheduleNotification:ve,goToAdmin:he,goBack:be,onMediaEnded:H,onMediaLoaded:Y,handleMediaError:ae,formatTime:$,formatTotalDuration:D,getCurrentDuration:T,initializeFullscreenState:de,onMouseMoveFullscreen:ge,isDarkMode:t}}},be=t(262);const Le=(0,be.A)(ye,[["render",H],["__scopeId","data-v-6bf7c1d2"]]);var _e=Le},661:function(e,a,t){t.d(a,{A:function(){return T}});var o=t(641),l=t(33),n=t(751);const s={class:"media-uploader"},i={key:0,class:"upload-prompt"},r={class:"upload-icon"},c={class:"supported-formats"},d={key:1,class:"file-selected"},u={class:"file-preview"},m={key:0,class:"image-preview"},p=["src","alt"],g={key:1,class:"file-icon"},v={class:"file-details"},h={class:"file-meta"},k={class:"file-size"},f={key:2,class:"upload-progress"},y={class:"progress-circle"},b={class:"progress-text"},L={key:0,class:"metadata-form"},_={class:"form-section"},F={class:"form-grid"},C={class:"form-actions"},w={key:1,class:"success-message"};function E(e,a,t,E,P,S){const M=(0,o.g2)("q-icon"),A=(0,o.g2)("q-chip"),$=(0,o.g2)("q-btn"),D=(0,o.g2)("q-circular-progress"),T=(0,o.g2)("q-input"),I=(0,o.g2)("q-select");return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("div",{class:(0,l.C4)(["upload-zone",{"drag-over":E.isDragOver,"has-file":E.selectedFile,uploading:E.isUploading}]),onDragover:a[1]||(a[1]=(0,n.D$)(((...e)=>E.handleDragOver&&E.handleDragOver(...e)),["prevent"])),onDragleave:a[2]||(a[2]=(0,n.D$)(((...e)=>E.handleDragLeave&&E.handleDragLeave(...e)),["prevent"])),onDrop:a[3]||(a[3]=(0,n.D$)(((...e)=>E.handleDrop&&E.handleDrop(...e)),["prevent"])),onClick:a[4]||(a[4]=(...e)=>E.triggerFileSelect&&E.triggerFileSelect(...e))},[(0,o.Lk)("input",{ref:"fileInput",type:"file",accept:"image/*,video/*",onChange:a[0]||(a[0]=(...e)=>E.handleFileSelect&&E.handleFileSelect(...e)),class:"hidden-input"},null,544),E.selectedFile||E.isUploading?E.selectedFile&&!E.isUploading?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("div",u,[E.previewUrl&&"image"===E.metadata.media_type?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("img",{src:E.previewUrl,alt:E.selectedFile.name},null,8,p)])):((0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(M,{name:E.getFileIcon(E.selectedFile.type),size:"3rem"},null,8,["name"])]))]),(0,o.Lk)("div",v,[(0,o.Lk)("h4",null,(0,l.v_)(E.selectedFile.name),1),(0,o.Lk)("div",h,[(0,o.bF)(A,{size:"sm",color:E.getTypeColor(E.metadata.media_type),"text-color":"white"},{default:(0,o.k6)((()=>[(0,o.eW)((0,l.v_)(E.metadata.media_type?.toUpperCase()||"ARCHIVO"),1)])),_:1},8,["color"]),(0,o.Lk)("span",k,(0,l.v_)(E.formatFileSize(E.selectedFile.size)),1)])]),(0,o.bF)($,{round:"",flat:"",icon:"close",onClick:(0,n.D$)(E.resetForm,["stop"]),class:"remove-file",size:"sm"},null,8,["onClick"])])):E.isUploading?((0,o.uX)(),(0,o.CE)("div",f,[(0,o.Lk)("div",y,[(0,o.bF)(D,{value:E.uploadProgress.percent,size:"60px",thickness:.2,color:"primary","track-color":"grey-3",class:"q-ma-md"},null,8,["value"]),(0,o.Lk)("div",b,(0,l.v_)(Math.round(E.uploadProgress.percent))+"% ",1)]),(0,o.Lk)("h4",null,(0,l.v_)(E.uploadProgress.message),1),(0,o.Lk)("p",null,(0,l.v_)(E.selectedFile?.name),1)])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",r,[(0,o.bF)(M,{name:"cloud_upload",size:"3rem"})]),a[12]||(a[12]=(0,o.Lk)("h4",null,"Arrastra archivos aquí",-1)),a[13]||(a[13]=(0,o.Lk)("p",null,"o haz clic para seleccionar",-1)),(0,o.Lk)("div",c,[(0,o.bF)(A,{size:"sm",color:"primary","text-color":"white"},{default:(0,o.k6)((()=>a[8]||(a[8]=[(0,o.eW)("JPG")]))),_:1,__:[8]}),(0,o.bF)(A,{size:"sm",color:"primary","text-color":"white"},{default:(0,o.k6)((()=>a[9]||(a[9]=[(0,o.eW)("PNG")]))),_:1,__:[9]}),(0,o.bF)(A,{size:"sm",color:"secondary","text-color":"white"},{default:(0,o.k6)((()=>a[10]||(a[10]=[(0,o.eW)("MP4")]))),_:1,__:[10]}),(0,o.bF)(A,{size:"sm",color:"secondary","text-color":"white"},{default:(0,o.k6)((()=>a[11]||(a[11]=[(0,o.eW)("WebM")]))),_:1,__:[11]})]),a[14]||(a[14]=(0,o.Lk)("div",{class:"size-limit"},"Máximo 100MB",-1))]))],34),E.selectedFile&&!E.isUploading?((0,o.uX)(),(0,o.CE)("div",L,[(0,o.Lk)("div",_,[a[15]||(a[15]=(0,o.Lk)("h5",null,"Detalles del archivo",-1)),(0,o.Lk)("div",F,[(0,o.bF)(T,{modelValue:E.metadata.filename,"onUpdate:modelValue":a[5]||(a[5]=e=>E.metadata.filename=e),label:"Nombre del archivo",outlined:"",class:"filename-input",rules:[e=>!!e||"El nombre es requerido"]},{prepend:(0,o.k6)((()=>[(0,o.bF)(M,{name:"edit"})])),_:1},8,["modelValue","rules"]),(0,o.bF)(I,{modelValue:E.metadata.media_type,"onUpdate:modelValue":a[6]||(a[6]=e=>E.metadata.media_type=e),options:E.mediaTypeOptions,label:"Tipo de contenido",outlined:"","emit-value":"","map-options":"",rules:[e=>!!e||"Selecciona el tipo"]},{prepend:(0,o.k6)((()=>[(0,o.bF)(M,{name:"category"})])),_:1},8,["modelValue","options","rules"]),(0,o.bF)(T,{modelValue:E.metadata.duration,"onUpdate:modelValue":a[7]||(a[7]=e=>E.metadata.duration=e),modelModifiers:{number:!0},label:"Duración (segundos)",type:"number",outlined:"",hint:"image"===E.metadata.media_type?"Para imágenes: tiempo de visualización":"Se detectará automáticamente para videos"},{prepend:(0,o.k6)((()=>[(0,o.bF)(M,{name:"schedule"})])),_:1},8,["modelValue","hint"])])]),(0,o.Lk)("div",C,[(0,o.bF)($,{label:"Cancelar",color:"grey-7",flat:"",onClick:E.resetForm,disable:E.isUploading,class:"cancel-btn"},null,8,["onClick","disable"]),(0,o.bF)($,{label:"Subir archivo",color:"primary",unelevated:"",onClick:E.uploadFile,loading:E.isUploading,disable:!E.isFormValid,class:"upload-btn"},{loading:(0,o.k6)((()=>a[16]||(a[16]=[(0,o.eW)(" Subiendo... ")]))),_:1},8,["onClick","loading","disable"])])])):(0,o.Q3)("",!0),E.uploadSuccess?((0,o.uX)(),(0,o.CE)("div",w,[(0,o.bF)(M,{name:"check_circle",size:"2rem",color:"positive"}),a[17]||(a[17]=(0,o.Lk)("h4",null,"¡Archivo subido correctamente!",-1)),(0,o.Lk)("p",null,(0,l.v_)(E.uploadedFileName)+" está listo para usar",1)])):(0,o.Q3)("",!0)])}var P=t(953),S=t(246),M=t(889),A={name:"MediaUploader",emits:["upload-complete","upload-error","uploaded"],setup(e,{emit:a}){const t=(0,S.dj)(),l=(0,P.KR)(null),n=(0,P.KR)(null),s=(0,P.KR)(!1),i=(0,P.KR)(!1),r=(0,P.KR)(null),c=(0,P.KR)(!1),d=(0,P.KR)(""),u=(0,P.Kh)({filename:"",media_type:"",duration:5}),m=(0,P.Kh)({show:!1,percent:0,message:""}),p=[{label:"Imagen",value:"image"},{label:"Video",value:"video"}],g=(0,o.EW)((()=>n.value&&u.filename.trim()&&u.media_type&&u.duration>0)),v=()=>{s.value||l.value?.click()},h=e=>{const a=e.target.files?.[0]||e;a&&a instanceof File&&k(a)},k=e=>{e.size>104857600?t.error("El archivo es demasiado grande. Máximo 100MB."):e.type.startsWith("image/")||e.type.startsWith("video/")?(n.value=e,u.filename=e.name.replace(/\.[^/.]+$/,""),e.type.startsWith("image/")?(u.media_type="image",u.duration=5,f(e)):e.type.startsWith("video/")&&(u.media_type="video",u.duration=30,r.value=null),c.value=!1):t.error("Tipo de archivo no soportado. Solo imágenes y videos.")},f=e=>{const a=new FileReader;a.onload=e=>{r.value=e.target.result},a.readAsDataURL(e)},y=e=>{e.preventDefault(),i.value=!0},b=e=>{e.preventDefault(),i.value=!1},L=e=>{e.preventDefault(),i.value=!1;const a=e.dataTransfer.files;a.length>0&&k(a[0])},_=e=>e?e.startsWith("image/")?"image":e.startsWith("video/")?"videocam":"description":"description",F=e=>{switch(e){case"image":return"orange";case"video":return"purple";default:return"grey"}},C=e=>{if(0===e)return"0 Bytes";const a=1024,t=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,o)).toFixed(2))+" "+t[o]},w=async()=>{if(g.value){s.value=!0,m.show=!0,m.percent=0,m.message="Preparando subida...";try{const e=setInterval((()=>{m.percent<85&&(m.percent+=15*Math.random(),m.percent<30?m.message="Analizando archivo...":m.percent<60?m.message="Subiendo archivo...":m.message="Procesando multimedia...")}),300),o={file:n.value,filename:u.filename,media_type:u.media_type,duration:u.duration},l=await M.DX.upload(o);clearInterval(e),m.percent=100,m.message="¡Completado!",d.value=u.filename,c.value=!0,t.success(`✅ ${u.filename} subido correctamente`),a("upload-complete",l.data),a("uploaded",l.data),setTimeout((()=>{E()}),3e3)}catch(e){console.error("Error subiendo archivo:",e),(0,M.vH)(e,t),a("upload-error",e),m.message="Error en la subida"}finally{s.value=!1,setTimeout((()=>{m.show=!1}),2e3)}}else t.warning("Completa todos los campos requeridos")},E=()=>{n.value=null,u.filename="",u.media_type="",u.duration=5,r.value=null,m.show=!1,m.percent=0,c.value=!1,d.value="",i.value=!1,l.value&&(l.value.value="")};return{fileInput:l,selectedFile:n,metadata:u,isUploading:s,isDragOver:i,previewUrl:r,uploadProgress:m,uploadSuccess:c,uploadedFileName:d,isFormValid:g,mediaTypeOptions:p,triggerFileSelect:v,handleFileSelect:h,handleDragOver:y,handleDragLeave:b,handleDrop:L,getFileIcon:_,getTypeColor:F,formatFileSize:C,uploadFile:w,resetForm:E}}},$=t(262);const D=(0,$.A)(A,[["render",E],["__scopeId","data-v-65b3c1cc"]]);var T=D},680:function(e,a,t){function o(){const e=window.location.origin,a=window.location.pathname.startsWith("/")&&!window.location.hostname.includes("localhost:8080");return console.log("🔍 Detectando contexto del frontend..."),console.log(`   📍 Origin: ${e}`),console.log(`   🌐 Hostname: ${window.location.hostname}`),console.log(`   📂 Pathname: ${window.location.pathname}`),console.log(`   🔗 Servido desde backend: ${a}`),a?(console.log("✅ Frontend servido desde backend, usando mismo origen"),{baseUrl:e,port:parseInt(window.location.port)||("https:"===window.location.protocol?443:80),isProduction:!0}):(console.log("🔧 Modo desarrollo detectado, usando auto-detección"),null)}t.d(a,{w:function(){return o}})},697:function(e,a,t){t.d(a,{A:function(){return d}});var o=t(641),l=t(33);function n(e,a,t,n,s,i){const r=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.Wv)(r,{icon:n.isDarkMode?"wb_sunny":"nights_stay",onClick:n.toggleTheme,class:(0,l.C4)(n.themeToggleClass),flat:"",square:"",size:"md"},null,8,["icon","onClick","class"])}var s=t(725),i={name:"ThemeToggle",setup(){const{isDarkMode:e,toggleTheme:a}=(0,s.D)(),t=(0,o.EW)((()=>({"theme-toggle":!0,"theme-toggle--dark":e.value,"theme-toggle--light":!e.value})));return{isDarkMode:e,toggleTheme:a,themeToggleClass:t}}},r=t(262);const c=(0,r.A)(i,[["render",n],["__scopeId","data-v-410b47f5"]]);var d=c},714:function(e,a,t){t.d(a,{A:function(){return r}});var o=t(641),l=t(33);const n={class:"text-h6"};var s={__name:"EditMediaDialog",props:{modelValue:Boolean,media:Object,form:Object,loading:Boolean,isDark:Boolean},emits:["update:modelValue","save","close"],setup(e){return(a,t)=>{const s=(0,o.g2)("q-card-section"),i=(0,o.g2)("q-input"),r=(0,o.g2)("q-btn"),c=(0,o.g2)("q-card-actions"),d=(0,o.g2)("q-card"),u=(0,o.g2)("q-dialog");return(0,o.uX)(),(0,o.Wv)(u,{"model-value":e.modelValue,"onUpdate:modelValue":t[4]||(t[4]=e=>a.$emit("update:modelValue",e)),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(d,{style:{"min-width":"800px","max-width":"1000px"},class:(0,l.C4)({"bg-dark text-white":e.isDark})},{default:(0,o.k6)((()=>[(0,o.bF)(s,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",n,"Gestionar Medio - "+(0,l.v_)(e.media?.filename),1)])),_:1}),(0,o.bF)(s,{class:"q-pt-none"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:e.form.filename,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.filename=a),label:"Nombre del archivo",outlined:"",class:"q-mb-md"},null,8,["modelValue"]),(0,o.bF)(i,{modelValue:e.form.description,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.description=a),label:"Descripción",type:"textarea",outlined:"",rows:"3"},null,8,["modelValue"])])),_:1}),(0,o.bF)(c,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{flat:"",label:"Cancelar",onClick:t[2]||(t[2]=e=>a.$emit("close"))}),(0,o.bF)(r,{color:"primary",label:"Guardar",loading:e.loading,onClick:t[3]||(t[3]=e=>a.$emit("save"))},null,8,["loading"])])),_:1})])),_:1},8,["class"])])),_:1},8,["model-value"])}}};const i=s;var r=i},725:function(e,a,t){t.d(a,{D:function(){return m}});var o=t(953),l=t(641);const n=(0,o.KR)(!1),s=localStorage.getItem("signance-theme");n.value=s?"dark"===s:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;const i=e=>{const a=document.documentElement;e?(a.style.setProperty("--primary","#FFAA93"),a.style.setProperty("--primary-dark","#CC7A66"),a.style.setProperty("--primary-light","#FFCCB3"),a.style.setProperty("--secondary","#5A9DCB"),a.style.setProperty("--accent","#D1B05F"),a.style.setProperty("--background","#121212"),a.style.setProperty("--surface","#1E1E1E"),a.style.setProperty("--on-primary","#000000"),a.style.setProperty("--on-secondary","#FFFFFF"),a.style.setProperty("--text-primary","#E0E0E0"),a.style.setProperty("--text-secondary","#B0B0B0"),a.style.setProperty("--border","#2C2C2C"),a.style.setProperty("--error","#FF6F6F"),a.style.setProperty("--success","#66BB6A"),a.style.setProperty("--warning","#FFA726"),a.style.setProperty("--info","#42A5F5")):(a.style.setProperty("--primary","#F0907B"),a.style.setProperty("--primary-dark","#D66E58"),a.style.setProperty("--primary-light","#FAC3B8"),a.style.setProperty("--secondary","#7BC5F0"),a.style.setProperty("--accent","#F0D27B"),a.style.setProperty("--background","#FFFFFF"),a.style.setProperty("--surface","#F5F5F5"),a.style.setProperty("--on-primary","#FFFFFF"),a.style.setProperty("--on-secondary","#FFFFFF"),a.style.setProperty("--text-primary","#212121"),a.style.setProperty("--text-secondary","#424242"),a.style.setProperty("--border","#E0E0E0"),a.style.setProperty("--error","#E53935"),a.style.setProperty("--success","#43A047"),a.style.setProperty("--warning","#FB8C00"),a.style.setProperty("--info","#1E88E5"))},r=e=>{i(e),e?(document.documentElement.setAttribute("data-theme","dark"),document.body.style.backgroundColor="#121212",document.body.style.color="#E0E0E0",document.body.classList.add("dark-mode"),document.body.classList.remove("light-mode")):(document.documentElement.removeAttribute("data-theme"),document.body.style.backgroundColor="#FFFFFF",document.body.style.color="#212121",document.body.classList.add("light-mode"),document.body.classList.remove("dark-mode"))};r(n.value),(0,l.wB)(n,(e=>{localStorage.setItem("signance-theme",e?"dark":"light"),r(e)}));const c=(0,l.EW)((()=>({primaryColor:n.value?"#FFAA93":"#F0907B",primaryDark:n.value?"#CC7A66":"#D66E58",primaryLight:n.value?"#FFCCB3":"#FAC3B8",secondaryColor:n.value?"#5A9DCB":"#7BC5F0",accentColor:n.value?"#D1B05F":"#F0D27B",errorColor:n.value?"#FF6F6F":"#E53935",successColor:n.value?"#66BB6A":"#43A047",warningColor:n.value?"#FFA726":"#FB8C00",infoColor:n.value?"#42A5F5":"#1E88E5",backgroundColor:n.value?"#121212":"#FFFFFF",surfaceColor:n.value?"#1E1E1E":"#F5F5F5",cardColor:n.value?"#1E1E1E":"#FFFFFF",textPrimary:n.value?"#E0E0E0":"#212121",textSecondary:n.value?"#B0B0B0":"#424242",onPrimary:n.value?"#000000":"#FFFFFF",onSecondary:(n.value,"#FFFFFF"),borderColor:n.value?"#2C2C2C":"#E0E0E0",gradientPrimary:n.value?"linear-gradient(135deg, #FFAA93 0%, #CC7A66 100%)":"linear-gradient(135deg, #F0907B 0%, #D66E58 100%)",gradientSecondary:n.value?"linear-gradient(135deg, #5A9DCB 0%, #42A5F5 100%)":"linear-gradient(135deg, #7BC5F0 0%, #1E88E5 100%)",gradientAccent:n.value?"linear-gradient(135deg, #D1B05F 0%, #FFA726 100%)":"linear-gradient(135deg, #F0D27B 0%, #FB8C00 100%)",shadowSm:n.value?"0 1px 3px 0 rgba(0, 0, 0, 0.5)":"0 1px 3px 0 rgba(0, 0, 0, 0.1)",shadowMd:n.value?"0 4px 6px -1px rgba(0, 0, 0, 0.4)":"0 4px 6px -1px rgba(0, 0, 0, 0.1)",shadowLg:n.value?"0 10px 15px -3px rgba(0, 0, 0, 0.4)":"0 10px 15px -3px rgba(0, 0, 0, 0.1)",shadowXl:n.value?"0 20px 25px -5px rgba(0, 0, 0, 0.5)":"0 20px 25px -5px rgba(0, 0, 0, 0.1)",hoverColor:n.value?"#2C2C2C":"#F5F5F5",hoverPrimary:n.value?"rgba(255, 170, 147, 0.1)":"rgba(240, 144, 123, 0.1)",hoverSecondary:n.value?"rgba(90, 157, 203, 0.1)":"rgba(123, 197, 240, 0.1)"}))),d=()=>{n.value=!n.value},u=()=>{r(n.value)};function m(){return{isDarkMode:n,toggleTheme:d,loadTheme:u,themeVars:c}}},889:function(e,a,t){t.d(a,{DX:function(){return v},R2:function(){return g},X3:function(){return d},ZK:function(){return h},fP:function(){return f},gr:function(){return k},vH:function(){return y}});var o=t(335),l=t(246),n=t(349),s=t(680);let i=o.A.create({baseURL:"",timeout:15e3,headers:{"Content-Type":"application/json"}}),r=!1,c=null;const d=async()=>r?i:c||(c=(async()=>{try{console.log("🚀 Inicializando API con detección mejorada...");const a=(0,s.w)();if(a)return console.log("🎯 Modo producción detectado, usando mismo origen"),i.defaults.baseURL=`${a.baseUrl}/api`,console.log("🧪 Probando conectividad en modo producción..."),await i.get("/health",{timeout:5e3}),r=!0,console.log(`✅ API inicializada en modo producción: ${a.baseUrl}`),i;console.log("🔧 Modo desarrollo detectado, usando auto-detección...");const t=n.A.getCachedBackend();if(t){console.log(`📦 Usando backend desde caché: ${t.baseUrl}`),i.defaults.baseURL=`${t.baseUrl}/api`;try{const e=await n.A.testPort(t.port);if(e)return r=!0,console.log("✅ API inicializada correctamente con backend desde caché"),i;console.log("❌ Backend cached no responde, detectando nuevamente..."),n.A.clearCache()}catch(e){console.log("❌ Error probando backend cached:",e.message),n.A.clearCache()}}console.log("🔍 Detectando backend automáticamente...");const{baseUrl:o}=await n.A.detectBackend();return i.defaults.baseURL=`${o}/api`,console.log("🧪 Probando conectividad con el backend..."),await i.get("/health",{timeout:5e3}),r=!0,console.log(`✅ API inicializada correctamente con backend: ${o}`),n.A.startHealthCheck((()=>{console.log("⚠️ Conexión con backend perdida, reintentando..."),r=!1,c=null})),i}catch(e){console.error("❌ Error inicializando API:",e),console.log("🔄 Intentando fallback con localhost:8000..."),i.defaults.baseURL="http://127.0.0.1:8000/api";try{return await i.get("/health",{timeout:3e3}),console.log("✅ API inicializada con fallback localhost:8000"),r=!0,i}catch(a){throw console.error("❌ Fallback también falló:",a),new Error("No se pudo conectar con el backend. Verifica que el servidor esté ejecutándose.")}}})(),c),u=async()=>(r||await d(),i);i.interceptors.request.use((e=>{const a=localStorage.getItem("signance_token");return a&&(e.headers.Authorization=`Bearer ${a}`),e}),(e=>Promise.reject(e))),i.interceptors.response.use((e=>e),(e=>{const a=(0,l.dj)();if(e.response){const t=e.response.status,o=e.response.data?.detail||"Error del servidor";switch(t){case 401:localStorage.removeItem("signance_token"),a.error("Sesión expirada. Por favor inicia sesión nuevamente."),window.location.href="/login";break;case 403:a.error("No tienes permisos para realizar esta acción");break;case 404:a.error("Recurso no encontrado");break;case 500:a.error("Error interno del servidor");break;default:a.error(o)}}else e.request?a.error("No se puede conectar con el servidor"):a.error("Error en la solicitud");return Promise.reject(e)}));const m=e=>async(...a)=>{const t=await u();return t[e](...a)},p={get:m("get"),post:m("post"),put:m("put"),delete:m("delete"),patch:m("patch")},g={checkSetup:()=>p.get("/auth/check-setup"),setupAdmin:e=>p.post("/auth/setup-admin",e),login:async e=>{const a=new FormData;a.append("username",e.username),a.append("password",e.password);const t=await u();return t.post("/auth/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},logout:()=>p.post("/auth/logout"),getCurrentUser:()=>p.get("/auth/me"),testProtected:()=>p.get("/auth/protected")},v={list:(e=0,a=100)=>p.get(`/media/?skip=${e}&limit=${a}`),get:e=>p.get(`/media/${e}`),upload:async e=>{const a=new FormData;a.append("file",e.file),a.append("filename",e.filename),a.append("media_type",e.media_type),a.append("duration",e.duration);const t=await u();return t.post("/media/",a,{headers:{"Content-Type":"multipart/form-data"}})},update:(e,a)=>p.put(`/media/${e}`,a),delete:e=>p.delete(`/media/${e}`),getPlaylists:e=>p.get(`/media/${e}/playlists`)},h={get:()=>p.get("/business/"),checkSetup:()=>p.get("/business/check-setup"),create:async e=>{const a=new FormData;a.append("name",e.name),e.logo&&a.append("logo",e.logo);const t=await u();return t.post("/business/",a,{headers:{"Content-Type":"multipart/form-data"}})},update:async e=>{const a=new FormData;e.name&&a.append("name",e.name),e.logo&&a.append("logo",e.logo);const t=await u();return t.put("/business/",a,{headers:{"Content-Type":"multipart/form-data"}})},getLogo:()=>p.get("/business/logo"),delete:()=>p.delete("/business/")},k={list:(e=0,a=100)=>p.get(`/schedules/?skip=${e}&limit=${a}`),get:e=>p.get(`/schedules/${e}`),getByMedia:e=>p.get(`/schedules/media/${e}`),getActive:(e=null)=>{const a=e?`/schedules/schedules/active?schedule_type=${e}`:"/schedules/schedules/active";return p.get(a)},create:e=>p.post("/schedules/",e),update:(e,a)=>p.put(`/schedules/${e}`,a),delete:e=>p.delete(`/schedules/${e}`)},f={list:(e=0,a=100)=>p.get(`/playlists/?skip=${e}&limit=${a}`),get:e=>p.get(`/playlists/${e}`),getStats:()=>p.get("/playlists/stats"),create:e=>p.post("/playlists/",e),update:(e,a)=>p.put(`/playlists/${e}`,a),delete:e=>p.delete(`/playlists/${e}`),addMedia:(e,a)=>p.post(`/playlists/${e}/media`,{media_ids:a}),addSingleMedia:(e,a)=>p.post(`/playlists/${e}/media`,a),removeMedia:(e,a)=>p.delete(`/playlists/${e}/media/${a}`),updateMedia:(e,a,t)=>p.put(`/playlists/${e}/media/${a}`,t),reorder:(e,a)=>p.put(`/playlists/${e}/reorder`,{media_orders:a}),getMedia:e=>p.get(`/playlists/${e}`)},y=(e,a)=>{413===e.response?.status?a.error("El archivo es demasiado grande"):415===e.response?.status?a.error("Tipo de archivo no soportado"):a.error("Error al procesar el archivo")}},891:function(e,a,t){t.d(a,{f:function(){return n}});var o=t(953),l=t(349);function n(){const e=(0,o.KR)(""),a=async()=>{try{const{baseUrl:a}=await l.A.detectBackend();e.value=a}catch(a){console.error("Error detectando backend:",a),e.value="http://127.0.0.1:8000"}},t=a=>{if(!a||!e.value)return"";let t=a.filepath||a.file_path||"";if(!t){if(!a.id)return console.error("No se puede construir filepath sin ID"),"";t=`/uploads/${a.id}`}return t&&!t.startsWith("/")&&(t="/"+t),t&&!t.includes("/uploads/")&&(t.startsWith("/")&&(t=t.substring(1)),t=`/uploads/${t}`),`${e.value}${t}`};return a(),{backendBaseUrl:e,buildMediaUrl:t,detectBackend:a}}}},a={};function t(o){var l=a[o];if(void 0!==l)return l.exports;var n=a[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(a,o,l,n){if(!o){var s=1/0;for(d=0;d<e.length;d++){o=e[d][0],l=e[d][1],n=e[d][2];for(var i=!0,r=0;r<o.length;r++)(!1&n||s>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[r])}))?o.splice(r--,1):(i=!1,n<s&&(s=n));if(i){e.splice(d--,1);var c=l();void 0!==c&&(a=c)}}return a}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,l,n]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})}}(),function(){t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce((function(a,o){return t.f[o](e,a),a}),[]))}}(),function(){t.u=function(e){return"js/"+e+".08a85daf.js"}}(),function(){t.miniCssF=function(e){return"css/"+e+".3a0e73e2.css"}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){var e={},a="signance-frontend:";t.l=function(o,l,n,s){if(e[o])e[o].push(l);else{var i,r;if(void 0!==n)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==a+n){i=u;break}}i||(r=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,t.nc&&i.setAttribute("nonce",t.nc),i.setAttribute("data-webpack",a+n),i.src=o),e[o]=[l];var m=function(a,t){i.onerror=i.onload=null,clearTimeout(p);var l=e[o];if(delete e[o],i.parentNode&&i.parentNode.removeChild(i),l&&l.forEach((function(e){return e(t)})),a)return a(t)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),r&&document.head.appendChild(i)}}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,a,o,l,n){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",t.nc&&(s.nonce=t.nc);var i=function(t){if(s.onerror=s.onload=null,"load"===t.type)l();else{var o=t&&t.type,i=t&&t.target&&t.target.href||a,r=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+i+")");r.name="ChunkLoadError",r.code="CSS_CHUNK_LOAD_FAILED",r.type=o,r.request=i,s.parentNode&&s.parentNode.removeChild(s),n(r)}};return s.onerror=s.onload=i,s.href=a,o?o.parentNode.insertBefore(s,o.nextSibling):document.head.appendChild(s),s},a=function(e,a){for(var t=document.getElementsByTagName("link"),o=0;o<t.length;o++){var l=t[o],n=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(n===e||n===a))return l}var s=document.getElementsByTagName("style");for(o=0;o<s.length;o++){l=s[o],n=l.getAttribute("data-href");if(n===e||n===a)return l}},o=function(o){return new Promise((function(l,n){var s=t.miniCssF(o),i=t.p+s;if(a(s,i))return l();e(o,i,null,l,n)}))},l={524:0};t.f.miniCss=function(e,a){var t={403:1};l[e]?a.push(l[e]):0!==l[e]&&t[e]&&a.push(l[e]=o(e).then((function(){l[e]=0}),(function(a){throw delete l[e],a})))}}}(),function(){var e={524:0};t.f.j=function(a,o){var l=t.o(e,a)?e[a]:void 0;if(0!==l)if(l)o.push(l[2]);else{var n=new Promise((function(t,o){l=e[a]=[t,o]}));o.push(l[2]=n);var s=t.p+t.u(a),i=new Error,r=function(o){if(t.o(e,a)&&(l=e[a],0!==l&&(e[a]=void 0),l)){var n=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;i.message="Loading chunk "+a+" failed.\n("+n+": "+s+")",i.name="ChunkLoadError",i.type=n,i.request=s,l[1](i)}};t.l(s,r,"chunk-"+a,a)}},t.O.j=function(a){return 0===e[a]};var a=function(a,o){var l,n,s=o[0],i=o[1],r=o[2],c=0;if(s.some((function(a){return 0!==e[a]}))){for(l in i)t.o(i,l)&&(t.m[l]=i[l]);if(r)var d=r(t)}for(a&&a(o);c<s.length;c++)n=s[c],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(d)},o=self["webpackChunksignance_frontend"]=self["webpackChunksignance_frontend"]||[];o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(301)}));o=t.O(o)})();
//# sourceMappingURL=app.f1d3e5c0.js.map